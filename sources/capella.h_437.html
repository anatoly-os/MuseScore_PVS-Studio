
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>capella.h</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">//=============================================================================</a>
<a name="ln2">//  MuseScore</a>
<a name="ln3">//  Linux Music Score Editor</a>
<a name="ln4">//</a>
<a name="ln5">//  Copyright (C) 2009-2013 Werner Schweer and others</a>
<a name="ln6">//</a>
<a name="ln7">//  This program is free software; you can redistribute it and/or modify</a>
<a name="ln8">//  it under the terms of the GNU General Public License version 2.</a>
<a name="ln9">//</a>
<a name="ln10">//  This program is distributed in the hope that it will be useful,</a>
<a name="ln11">//  but WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln12">//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</a>
<a name="ln13">//  GNU General Public License for more details.</a>
<a name="ln14">//</a>
<a name="ln15">//  You should have received a copy of the GNU General Public License</a>
<a name="ln16">//  along with this program; if not, write to the Free Software</a>
<a name="ln17">//  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</a>
<a name="ln18">//=============================================================================</a>
<a name="ln19"> </a>
<a name="ln20">#ifndef __CAPELLA_H__</a>
<a name="ln21">#define __CAPELLA_H__</a>
<a name="ln22"> </a>
<a name="ln23">#include &quot;globals.h&quot;</a>
<a name="ln24">#include &quot;libmscore/xml.h&quot;</a>
<a name="ln25"> </a>
<a name="ln26">namespace Ms {</a>
<a name="ln27"> </a>
<a name="ln28">enum class TIMESTEP : char { D1, D2, D4, D8, D16, D32, D64, D128, D256, D_BREVE };</a>
<a name="ln29"> </a>
<a name="ln30">#if 0</a>
<a name="ln31">static const char* timeNames[] = { &quot;1/1&quot;, &quot;1/2&quot;, &quot;1/4&quot;, &quot;1/8&quot;, &quot;1/16&quot;, &quot;1/32&quot;, &quot;1/64&quot;,</a>
<a name="ln32">      &quot;1/128&quot;, &quot;1/256&quot;, &quot;breve&quot; };</a>
<a name="ln33">#endif</a>
<a name="ln34"> </a>
<a name="ln35">class Capella;</a>
<a name="ln36">enum class ClefType : signed char;</a>
<a name="ln37"> </a>
<a name="ln38">enum class CapellaNoteObjectType : char {</a>
<a name="ln39">      REST, CHORD, CLEF, KEY, METER, EXPL_BARLINE, IMPL_BARLINE,</a>
<a name="ln40">      PAGE_BKGR</a>
<a name="ln41">      };</a>
<a name="ln42"> </a>
<a name="ln43">enum class BeamMode : unsigned char { AUTO, FORCE, SPLIT };</a>
<a name="ln44"> </a>
<a name="ln45">//---------------------------------------------------------</a>
<a name="ln46">//   CapellaObj</a>
<a name="ln47">//---------------------------------------------------------</a>
<a name="ln48"> </a>
<a name="ln49">class CapellaObj {</a>
<a name="ln50">   protected:</a>
<a name="ln51">      Capella* cap;</a>
<a name="ln52"> </a>
<a name="ln53">   public:</a>
<a name="ln54">      CapellaObj(Capella* c) { cap = c; }</a>
<a name="ln55">      };</a>
<a name="ln56"> </a>
<a name="ln57">//---------------------------------------------------------</a>
<a name="ln58">//   NoteObj</a>
<a name="ln59">//---------------------------------------------------------</a>
<a name="ln60"> </a>
<a name="ln61">class NoteObj {</a>
<a name="ln62">      CapellaNoteObjectType _type;</a>
<a name="ln63"> </a>
<a name="ln64">   public:</a>
<a name="ln65">      NoteObj(CapellaNoteObjectType t) { _type = t; }</a>
<a name="ln66">      CapellaNoteObjectType type() const  { return _type; }</a>
<a name="ln67">      };</a>
<a name="ln68"> </a>
<a name="ln69">enum class Form : char {</a>
<a name="ln70">      G, C, F, PERCUSSION,</a>
<a name="ln71">      FORM_NULL, CLEF_UNCHANGED</a>
<a name="ln72">      };</a>
<a name="ln73"> </a>
<a name="ln74">enum class ClefLine : char {</a>
<a name="ln75">      L5, L4, L3, L2, L1</a>
<a name="ln76">      };</a>
<a name="ln77"> </a>
<a name="ln78">enum class Oct : char {</a>
<a name="ln79">      OCT_ALTA, OCT_NULL, OCT_BASSA</a>
<a name="ln80">      };</a>
<a name="ln81"> </a>
<a name="ln82">//---------------------------------------------------------</a>
<a name="ln83">//   CapClef</a>
<a name="ln84">//---------------------------------------------------------</a>
<a name="ln85"> </a>
<a name="ln86">class CapClef : public NoteObj, public CapellaObj {</a>
<a name="ln87">      Form form;</a>
<a name="ln88"> </a>
<a name="ln89">   public:</a>
<a name="ln90">      CapClef(Capella* c) : NoteObj(CapellaNoteObjectType::CLEF), CapellaObj(c) {}</a>
<a name="ln91">      void read();</a>
<a name="ln92">      void readCapx(XmlReader&amp; e);</a>
<a name="ln93">      const char* name() {</a>
<a name="ln94">            static const char* formName[] = { &quot;G&quot;, &quot;C&quot;, &quot;F&quot;, &quot;=&quot;, &quot; &quot;, &quot;*&quot; };</a>
<a name="ln95">            return formName[int(form)];</a>
<a name="ln96">            }</a>
<a name="ln97">      ClefType clef() const;</a>
<a name="ln98"> </a>
<a name="ln99">      ClefLine line;</a>
<a name="ln100">      Oct  oct;</a>
<a name="ln101">      static ClefType clefType(Form, ClefLine, Oct);</a>
<a name="ln102">      };</a>
<a name="ln103"> </a>
<a name="ln104">//---------------------------------------------------------</a>
<a name="ln105">//   CapKey</a>
<a name="ln106">//---------------------------------------------------------</a>
<a name="ln107"> </a>
<a name="ln108">class CapKey : public NoteObj, public CapellaObj {</a>
<a name="ln109"> </a>
<a name="ln110">   public:</a>
<a name="ln111">      CapKey(Capella* c) : NoteObj(CapellaNoteObjectType::KEY), CapellaObj(c) {}</a>
<a name="ln112">      void read();</a>
<a name="ln113">      void readCapx(XmlReader&amp; e);</a>
<a name="ln114">      int signature;    // -7 - +7</a>
<a name="ln115">      };</a>
<a name="ln116"> </a>
<a name="ln117">//---------------------------------------------------------</a>
<a name="ln118">//   CapMeter</a>
<a name="ln119">//---------------------------------------------------------</a>
<a name="ln120"> </a>
<a name="ln121">class CapMeter : public NoteObj, public CapellaObj {</a>
<a name="ln122">   public:</a>
<a name="ln123">      unsigned char numerator;</a>
<a name="ln124">      int log2Denom;</a>
<a name="ln125">      bool allaBreve;</a>
<a name="ln126"> </a>
<a name="ln127">      CapMeter(Capella* c) : NoteObj(CapellaNoteObjectType::METER), CapellaObj(c) {}</a>
<a name="ln128">      void read();</a>
<a name="ln129">      void readCapx(XmlReader&amp; e);</a>
<a name="ln130">      };</a>
<a name="ln131"> </a>
<a name="ln132">//---------------------------------------------------------</a>
<a name="ln133">//   CapExplicitBarline</a>
<a name="ln134">//---------------------------------------------------------</a>
<a name="ln135"> </a>
<a name="ln136">class CapExplicitBarline : public NoteObj, public CapellaObj {</a>
<a name="ln137">      BarLineType _type;</a>
<a name="ln138">      int _barMode;      // 0 = auto, 1 = nur Zeilen, 2 = durchgezogen</a>
<a name="ln139"> </a>
<a name="ln140">   public:</a>
<a name="ln141">      CapExplicitBarline(Capella* c) : NoteObj(CapellaNoteObjectType::EXPL_BARLINE), CapellaObj(c) {}</a>
<a name="ln142">      void read();</a>
<a name="ln143">      void readCapx(XmlReader&amp; e);</a>
<a name="ln144">      BarLineType type() const { return _type; }</a>
<a name="ln145">      int barMode() const      { return _barMode; }</a>
<a name="ln146"> </a>
<a name="ln147">      };</a>
<a name="ln148"> </a>
<a name="ln149">//---------------------------------------------------------</a>
<a name="ln150">//   CapVoice</a>
<a name="ln151">//---------------------------------------------------------</a>
<a name="ln152"> </a>
<a name="ln153">struct CapVoice {</a>
<a name="ln154">      uchar y0Lyrics;</a>
<a name="ln155">      uchar dyLyrics;</a>
<a name="ln156">      QFont lyricsFont;</a>
<a name="ln157">      unsigned char stemDir;</a>
<a name="ln158">      QList&lt;NoteObj*&gt; objects;</a>
<a name="ln159">      int voiceNo;</a>
<a name="ln160">      };</a>
<a name="ln161"> </a>
<a name="ln162">//---------------------------------------------------------</a>
<a name="ln163">//   CapStaff</a>
<a name="ln164">//---------------------------------------------------------</a>
<a name="ln165"> </a>
<a name="ln166">struct CapStaff {</a>
<a name="ln167">      uchar numerator;      // default time signature</a>
<a name="ln168">      int log2Denom;</a>
<a name="ln169">      bool allaBreve;</a>
<a name="ln170"> </a>
<a name="ln171">      uchar iLayout;</a>
<a name="ln172">      int topDistX;</a>
<a name="ln173">      int btmDistX;</a>
<a name="ln174">      QColor color;</a>
<a name="ln175">      QList&lt;CapVoice*&gt; voices;</a>
<a name="ln176">      };</a>
<a name="ln177"> </a>
<a name="ln178">//---------------------------------------------------------</a>
<a name="ln179">//   struct CapStaffLayout</a>
<a name="ln180">//---------------------------------------------------------</a>
<a name="ln181"> </a>
<a name="ln182">struct CapStaffLayout {</a>
<a name="ln183">      uchar barlineMode;</a>
<a name="ln184">      uchar noteLines;</a>
<a name="ln185">      bool bSmall;</a>
<a name="ln186">      int topDist;</a>
<a name="ln187">      int btmDist;</a>
<a name="ln188">      int groupDist;</a>
<a name="ln189">      uchar barlineFrom;</a>
<a name="ln190">      uchar barlineTo;</a>
<a name="ln191"> </a>
<a name="ln192">      Form form;</a>
<a name="ln193">      ClefLine line;</a>
<a name="ln194">      Oct oct;                // clef</a>
<a name="ln195"> </a>
<a name="ln196">      // Schlagzeuginformation</a>
<a name="ln197">      bool bPercussion;             // use drum channel</a>
<a name="ln198">      bool bSoundMapIn;</a>
<a name="ln199">      bool bSoundMapOut;</a>
<a name="ln200">      char soundMapIn[128];         // Tabelle für MIDI-Töne iMin...iMin+n-1</a>
<a name="ln201">      char soundMapOut[128];        // Tabelle für MIDI-Töne iMin...iMin+n-1</a>
<a name="ln202"> </a>
<a name="ln203">      int sound, volume, transp;</a>
<a name="ln204"> </a>
<a name="ln205">      QString descr;</a>
<a name="ln206">      QString name;</a>
<a name="ln207">      QString abbrev;</a>
<a name="ln208">      QString intermediateName;</a>
<a name="ln209">      QString intermediateAbbrev;</a>
<a name="ln210">      };</a>
<a name="ln211"> </a>
<a name="ln212">//---------------------------------------------------------</a>
<a name="ln213">//   CapSystem</a>
<a name="ln214">//---------------------------------------------------------</a>
<a name="ln215"> </a>
<a name="ln216">struct CapSystem {</a>
<a name="ln217">      int nAddBarCount;</a>
<a name="ln218">      bool bBarCountReset;</a>
<a name="ln219">      unsigned char explLeftIndent;      // &lt; 0 --&gt; Einrückung gemäß Stimmenbezeichnungen</a>
<a name="ln220">                                         // &gt;=  --&gt; explizite Einrückung</a>
<a name="ln221">      BeamMode beamMode;</a>
<a name="ln222">      unsigned tempo;</a>
<a name="ln223">      QColor color;                 // fuer Systemklammern</a>
<a name="ln224">      bool bJustified;              // Randausgleich (Blocksatz)</a>
<a name="ln225">      bool bPageBreak;              // nach dem System neue Seite anfangen</a>
<a name="ln226">      int instrNotation;            // 0 = keine Instrumentenbezeichnung</a>
<a name="ln227">                                    // 1 = abgekürzt, 2 = vollständig</a>
<a name="ln228">      QList&lt;CapStaff*&gt; staves;</a>
<a name="ln229">      };</a>
<a name="ln230"> </a>
<a name="ln231">//---------------------------------------------------------</a>
<a name="ln232">//   BasicDrawObj</a>
<a name="ln233">//---------------------------------------------------------</a>
<a name="ln234"> </a>
<a name="ln235">enum class CapellaType : unsigned char { GROUP, TRANSPOSABLE, METAFILE, SIMPLE_TEXT, TEXT, RECT_ELLIPSE,</a>
<a name="ln236">      LINE, POLYGON, WAVY_LINE, SLUR, NOTE_LINES, WEDGE, VOLTA,</a>
<a name="ln237">      BRACKET, GUITAR, TRILL</a>
<a name="ln238">      };</a>
<a name="ln239"> </a>
<a name="ln240">class BasicDrawObj : public CapellaObj {</a>
<a name="ln241">   public:</a>
<a name="ln242">      unsigned char modeX, modeY, distY, flags;</a>
<a name="ln243">      int nRefNote;</a>
<a name="ln244">      int nNotes;</a>
<a name="ln245">      bool background;</a>
<a name="ln246">      int pageRange;</a>
<a name="ln247">      CapellaType type;</a>
<a name="ln248"> </a>
<a name="ln249">      BasicDrawObj(CapellaType t, Capella* c)</a>
<a name="ln250">         : CapellaObj(c), modeX(0), modeY(0), distY(0), flags(0),</a>
<a name="ln251">           nRefNote(0), nNotes(0), background(0), pageRange(0), type(t) {}</a>
<a name="ln252">      void read();</a>
<a name="ln253">      void readCapx(XmlReader&amp; e);</a>
<a name="ln254">      };</a>
<a name="ln255"> </a>
<a name="ln256">//---------------------------------------------------------</a>
<a name="ln257">//   BasicRectObj</a>
<a name="ln258">//---------------------------------------------------------</a>
<a name="ln259"> </a>
<a name="ln260">class BasicRectObj : public BasicDrawObj {</a>
<a name="ln261">   public:</a>
<a name="ln262">      BasicRectObj(CapellaType t, Capella* c) : BasicDrawObj(t, c) {}</a>
<a name="ln263">      void read();</a>
<a name="ln264"> </a>
<a name="ln265">      QPointF relPos;</a>
<a name="ln266">      int width;</a>
<a name="ln267">      int yxRatio;</a>
<a name="ln268">      int height;</a>
<a name="ln269">      };</a>
<a name="ln270"> </a>
<a name="ln271">//---------------------------------------------------------</a>
<a name="ln272">//   GroupObj</a>
<a name="ln273">//---------------------------------------------------------</a>
<a name="ln274"> </a>
<a name="ln275">class GroupObj : public BasicDrawObj {</a>
<a name="ln276">   public:</a>
<a name="ln277">      GroupObj(Capella* c) : BasicDrawObj(CapellaType::GROUP, c) {}</a>
<a name="ln278">      void read();</a>
<a name="ln279"> </a>
<a name="ln280">      QPointF relPos;</a>
<a name="ln281">      QList&lt;BasicDrawObj*&gt; objects;</a>
<a name="ln282">      };</a>
<a name="ln283"> </a>
<a name="ln284">//---------------------------------------------------------</a>
<a name="ln285">//   TransposableObj</a>
<a name="ln286">//---------------------------------------------------------</a>
<a name="ln287"> </a>
<a name="ln288">class TransposableObj : public BasicDrawObj {</a>
<a name="ln289">   public:</a>
<a name="ln290">      TransposableObj(Capella* c) : BasicDrawObj(CapellaType::TRANSPOSABLE, c) {}</a>
<a name="ln291">      void read();</a>
<a name="ln292"> </a>
<a name="ln293">      QPointF relPos;</a>
<a name="ln294">      char b;</a>
<a name="ln295">      QList&lt;BasicDrawObj*&gt; variants;</a>
<a name="ln296">      };</a>
<a name="ln297"> </a>
<a name="ln298">//---------------------------------------------------------</a>
<a name="ln299">//   MetafileObj</a>
<a name="ln300">//---------------------------------------------------------</a>
<a name="ln301"> </a>
<a name="ln302">class MetafileObj : public BasicRectObj {</a>
<a name="ln303">   public:</a>
<a name="ln304">      MetafileObj(Capella* c) : BasicRectObj(CapellaType::METAFILE, c) {}</a>
<a name="ln305">      void read();</a>
<a name="ln306">      };</a>
<a name="ln307"> </a>
<a name="ln308">//---------------------------------------------------------</a>
<a name="ln309">//   LineObj</a>
<a name="ln310">//---------------------------------------------------------</a>
<a name="ln311"> </a>
<a name="ln312">class LineObj : public BasicDrawObj {</a>
<a name="ln313"> </a>
<a name="ln314">   public:</a>
<a name="ln315">      LineObj(Capella* c) : BasicDrawObj(CapellaType::LINE, c) {}</a>
<a name="ln316">      LineObj(CapellaType t, Capella* c) : BasicDrawObj(t, c) {}</a>
<a name="ln317">      void read();</a>
<a name="ln318"> </a>
<a name="ln319">      QPointF pt1, pt2;</a>
<a name="ln320">      QColor color;</a>
<a name="ln321">      char lineWidth;</a>
<a name="ln322">      };</a>
<a name="ln323"> </a>
<a name="ln324">//---------------------------------------------------------</a>
<a name="ln325">//   RectEllipseObj</a>
<a name="ln326">//---------------------------------------------------------</a>
<a name="ln327"> </a>
<a name="ln328">class RectEllipseObj : public LineObj {    // special</a>
<a name="ln329">   public:</a>
<a name="ln330">      RectEllipseObj(Capella* c) : LineObj(CapellaType::RECT_ELLIPSE, c) {}</a>
<a name="ln331">      void read();</a>
<a name="ln332"> </a>
<a name="ln333">      int radius;</a>
<a name="ln334">      bool bFilled;</a>
<a name="ln335">      QColor clrFill;</a>
<a name="ln336">      };</a>
<a name="ln337"> </a>
<a name="ln338">//---------------------------------------------------------</a>
<a name="ln339">//   PolygonObj</a>
<a name="ln340">//---------------------------------------------------------</a>
<a name="ln341"> </a>
<a name="ln342">class PolygonObj : public BasicDrawObj {</a>
<a name="ln343">   public:</a>
<a name="ln344">      PolygonObj(Capella* c) : BasicDrawObj(CapellaType::POLYGON, c) {}</a>
<a name="ln345">      void read();</a>
<a name="ln346"> </a>
<a name="ln347">      bool bFilled;</a>
<a name="ln348">      unsigned lineWidth;</a>
<a name="ln349">      QColor clrFill;</a>
<a name="ln350">      QColor clrLine;</a>
<a name="ln351">      };</a>
<a name="ln352"> </a>
<a name="ln353">//---------------------------------------------------------</a>
<a name="ln354">//   WavyLineObj</a>
<a name="ln355">//---------------------------------------------------------</a>
<a name="ln356"> </a>
<a name="ln357">class WavyLineObj : public LineObj {</a>
<a name="ln358">   public:</a>
<a name="ln359">      WavyLineObj(Capella* c) : LineObj(CapellaType::WAVY_LINE, c) {}</a>
<a name="ln360">      void read();</a>
<a name="ln361"> </a>
<a name="ln362">      unsigned waveLen;</a>
<a name="ln363">      bool adapt;</a>
<a name="ln364">      };</a>
<a name="ln365"> </a>
<a name="ln366">//---------------------------------------------------------</a>
<a name="ln367">//   NotelinesObj</a>
<a name="ln368">//---------------------------------------------------------</a>
<a name="ln369"> </a>
<a name="ln370">class NotelinesObj : public BasicDrawObj {</a>
<a name="ln371">   public:</a>
<a name="ln372">      NotelinesObj(Capella* c) : BasicDrawObj(CapellaType::NOTE_LINES, c) {}</a>
<a name="ln373">      void read();</a>
<a name="ln374"> </a>
<a name="ln375">      int x0, x1, y;</a>
<a name="ln376">      QColor color;</a>
<a name="ln377">      };</a>
<a name="ln378"> </a>
<a name="ln379">//---------------------------------------------------------</a>
<a name="ln380">//   VoltaObj</a>
<a name="ln381">//---------------------------------------------------------</a>
<a name="ln382"> </a>
<a name="ln383">class VoltaObj : public BasicDrawObj {</a>
<a name="ln384">   public:</a>
<a name="ln385">      VoltaObj(Capella* c)</a>
<a name="ln386">         : BasicDrawObj(CapellaType::VOLTA, c), x0(0), x1(0), y(0),</a>
<a name="ln387">           bLeft(false), bRight(false), bDotted(false),</a>
<a name="ln388">           allNumbers(false), from(0), to(0) {}</a>
<a name="ln389">      void read();</a>
<a name="ln390">      void readCapx(XmlReader&amp; e);</a>
<a name="ln391"> </a>
<a name="ln392">      int x0, x1, y;</a>
<a name="ln393">      QColor color;</a>
<a name="ln394"> </a>
<a name="ln395">      bool bLeft;</a>
<a name="ln396">      bool bRight;</a>
<a name="ln397">      bool bDotted;</a>
<a name="ln398">      bool allNumbers;</a>
<a name="ln399"> </a>
<a name="ln400">      int from, to;</a>
<a name="ln401">      };</a>
<a name="ln402"> </a>
<a name="ln403">//---------------------------------------------------------</a>
<a name="ln404">//   GuitarObj</a>
<a name="ln405">//---------------------------------------------------------</a>
<a name="ln406"> </a>
<a name="ln407">class GuitarObj : public BasicDrawObj {</a>
<a name="ln408">   public:</a>
<a name="ln409">      GuitarObj(Capella* c) : BasicDrawObj(CapellaType::GUITAR, c) {}</a>
<a name="ln410">      void read();</a>
<a name="ln411"> </a>
<a name="ln412">      QPointF relPos;</a>
<a name="ln413">      QColor color;</a>
<a name="ln414">      short flags;</a>
<a name="ln415">      int strings;      // 8 Saiten in 8 Halbbytes</a>
<a name="ln416">      };</a>
<a name="ln417"> </a>
<a name="ln418">//---------------------------------------------------------</a>
<a name="ln419">//   TrillObj</a>
<a name="ln420">//---------------------------------------------------------</a>
<a name="ln421"> </a>
<a name="ln422">class TrillObj : public BasicDrawObj {</a>
<a name="ln423">   public:</a>
<a name="ln424">      TrillObj(Capella* c) : BasicDrawObj(CapellaType::TRILL, c), x0(0),</a>
<a name="ln425">           x1(0), y(0), trillSign(true) {}</a>
<a name="ln426">      void read();</a>
<a name="ln427">      void readCapx(XmlReader&amp; e);</a>
<a name="ln428"> </a>
<a name="ln429">      int x0, x1, y;</a>
<a name="ln430">      QColor color;</a>
<a name="ln431">      bool trillSign;</a>
<a name="ln432">      };</a>
<a name="ln433"> </a>
<a name="ln434">//---------------------------------------------------------</a>
<a name="ln435">//   SlurObj</a>
<a name="ln436">//---------------------------------------------------------</a>
<a name="ln437"> </a>
<a name="ln438">class SlurObj : public BasicDrawObj {</a>
<a name="ln439">      QPointF bezierPoint[4]; // note default constructor inits to (0, 0)</a>
<a name="ln440">      QColor color;           // note default constructor inits to invalid</a>
<a name="ln441"> </a>
<a name="ln442">   public:</a>
<a name="ln443">      SlurObj(Capella* c)</a>
<a name="ln444">         : BasicDrawObj(CapellaType::SLUR, c), color(Qt::black), nEnd(0), nMid(0), nDotDist(0), nDotWidth(0) {}</a>
<a name="ln445">      void read();</a>
<a name="ln446">      void readCapx(XmlReader&amp; e);</a>
<a name="ln447">      unsigned char nEnd, nMid, nDotDist, nDotWidth;</a>
<a name="ln448">      };</a>
<a name="ln449"> </a>
<a name="ln450">//---------------------------------------------------------</a>
<a name="ln451">//   TextObj</a>
<a name="ln452">//---------------------------------------------------------</a>
<a name="ln453"> </a>
<a name="ln454">class TextObj : public BasicRectObj {</a>
<a name="ln455"> </a>
<a name="ln456">   public:</a>
<a name="ln457">      TextObj(Capella* c) : BasicRectObj(CapellaType::TEXT, c) {}</a>
<a name="ln458">      ~TextObj() {}</a>
<a name="ln459">      void read();</a>
<a name="ln460"> </a>
<a name="ln461">      QString text;</a>
<a name="ln462">      };</a>
<a name="ln463"> </a>
<a name="ln464">//---------------------------------------------------------</a>
<a name="ln465">//   SimpleTextObj</a>
<a name="ln466">//---------------------------------------------------------</a>
<a name="ln467"> </a>
<a name="ln468">class SimpleTextObj : public BasicDrawObj {</a>
<a name="ln469">      QString _text;</a>
<a name="ln470">      QPointF relPos;</a>
<a name="ln471">      unsigned char align;</a>
<a name="ln472">      QFont _font;</a>
<a name="ln473"> </a>
<a name="ln474">   public:</a>
<a name="ln475">      SimpleTextObj(Capella* c)</a>
<a name="ln476">         : BasicDrawObj(CapellaType::SIMPLE_TEXT, c), relPos(0, 0), align(0) {}</a>
<a name="ln477">      void read();</a>
<a name="ln478">      void readCapx(XmlReader&amp; e);</a>
<a name="ln479">      QString text() const { return _text; }</a>
<a name="ln480">      QFont font() const { return _font; }</a>
<a name="ln481">      QPointF pos() const { return relPos; }</a>
<a name="ln482">      unsigned char textalign() const { return align; }</a>
<a name="ln483">      };</a>
<a name="ln484"> </a>
<a name="ln485">//---------------------------------------------------------</a>
<a name="ln486">//   BracketObj</a>
<a name="ln487">//---------------------------------------------------------</a>
<a name="ln488"> </a>
<a name="ln489">class BracketObj : public LineObj {</a>
<a name="ln490"> </a>
<a name="ln491">   public:</a>
<a name="ln492">      BracketObj(Capella* c) : LineObj(CapellaType::BRACKET, c) {}</a>
<a name="ln493">      void read();</a>
<a name="ln494"> </a>
<a name="ln495">      char orientation, number;</a>
<a name="ln496">      };</a>
<a name="ln497"> </a>
<a name="ln498">//---------------------------------------------------------</a>
<a name="ln499">//   WedgeObj</a>
<a name="ln500">//---------------------------------------------------------</a>
<a name="ln501"> </a>
<a name="ln502">class WedgeObj : public LineObj {</a>
<a name="ln503"> </a>
<a name="ln504">   public:</a>
<a name="ln505">      WedgeObj(Capella* c) : LineObj(CapellaType::WEDGE, c), height(32),</a>
<a name="ln506">           decresc(false) {}</a>
<a name="ln507">      void read();</a>
<a name="ln508">      void readCapx(XmlReader&amp; e);</a>
<a name="ln509"> </a>
<a name="ln510">      int height;</a>
<a name="ln511">      bool decresc;</a>
<a name="ln512">      };</a>
<a name="ln513"> </a>
<a name="ln514">//---------------------------------------------------------</a>
<a name="ln515">//   BasicDurationalObj</a>
<a name="ln516">//---------------------------------------------------------</a>
<a name="ln517"> </a>
<a name="ln518">class BasicDurationalObj : public CapellaObj {</a>
<a name="ln519">   public:</a>
<a name="ln520">      int nDots;</a>
<a name="ln521">      bool noDuration;</a>
<a name="ln522">      bool postGrace;</a>
<a name="ln523">      bool bSmall;</a>
<a name="ln524">      bool notBlack;</a>
<a name="ln525">      QColor color;</a>
<a name="ln526">      TIMESTEP t;</a>
<a name="ln527">      int horizontalShift;</a>
<a name="ln528">      int count;              // tuplet</a>
<a name="ln529">      bool tripartite;</a>
<a name="ln530">      bool isProlonging;</a>
<a name="ln531"> </a>
<a name="ln532">   public:</a>
<a name="ln533">      BasicDurationalObj(Capella* c) : CapellaObj(c) {}</a>
<a name="ln534">      void read();</a>
<a name="ln535">      void readCapx(XmlReader&amp; e, unsigned int&amp; fullm);</a>
<a name="ln536">      void readCapxDisplay(XmlReader&amp; e);</a>
<a name="ln537">      void readCapxObjectArray(XmlReader&amp; e);</a>
<a name="ln538">      Fraction ticks() const;</a>
<a name="ln539">      bool invisible;</a>
<a name="ln540">      QList&lt;BasicDrawObj*&gt; objects;</a>
<a name="ln541">      };</a>
<a name="ln542"> </a>
<a name="ln543">//---------------------------------------------------------</a>
<a name="ln544">//   Verse</a>
<a name="ln545">//---------------------------------------------------------</a>
<a name="ln546"> </a>
<a name="ln547">struct Verse {</a>
<a name="ln548">      bool leftAlign;</a>
<a name="ln549">      bool extender;</a>
<a name="ln550">      bool hyphen;</a>
<a name="ln551">      int num;</a>
<a name="ln552">      QString verseNumber;</a>
<a name="ln553">      QString text;</a>
<a name="ln554">      };</a>
<a name="ln555"> </a>
<a name="ln556">struct CNote {</a>
<a name="ln557">      signed char pitch;</a>
<a name="ln558">      int explAlteration;     // 1 force, 2 suppress</a>
<a name="ln559">      int headType;</a>
<a name="ln560">      int alteration;</a>
<a name="ln561">      int silent;</a>
<a name="ln562">      };</a>
<a name="ln563"> </a>
<a name="ln564">//---------------------------------------------------------</a>
<a name="ln565">//   ChordObj</a>
<a name="ln566">//---------------------------------------------------------</a>
<a name="ln567"> </a>
<a name="ln568">class ChordObj : public BasicDurationalObj, public NoteObj {</a>
<a name="ln569">   public:</a>
<a name="ln570">      enum class StemDir : signed char { DOWN = -1, AUTO = 0, UP = 1, NONE = 3 };</a>
<a name="ln571">      BeamMode beamMode;</a>
<a name="ln572">      signed char notationStave;</a>
<a name="ln573">      char dStemLength;</a>
<a name="ln574">      unsigned char nTremoloBars;</a>
<a name="ln575">      unsigned articulation;</a>
<a name="ln576">      bool leftTie;</a>
<a name="ln577">      bool rightTie;</a>
<a name="ln578">      char beamShift;</a>
<a name="ln579">      char beamSlope;</a>
<a name="ln580"> </a>
<a name="ln581">   public:</a>
<a name="ln582">      ChordObj(Capella*);</a>
<a name="ln583">      void read();</a>
<a name="ln584">      void readCapx(XmlReader&amp; e);</a>
<a name="ln585">      void readCapxLyrics(XmlReader&amp; e);</a>
<a name="ln586">      void readCapxNotes(XmlReader&amp; e);</a>
<a name="ln587">      void readCapxStem(XmlReader&amp; e);</a>
<a name="ln588">      void readCapxArticulation(XmlReader&amp; e);</a>
<a name="ln589">      QList&lt;Verse&gt; verse;</a>
<a name="ln590">      QList&lt;CNote&gt; notes;</a>
<a name="ln591">      StemDir stemDir;</a>
<a name="ln592">      };</a>
<a name="ln593"> </a>
<a name="ln594">//---------------------------------------------------------</a>
<a name="ln595">//   RestObj</a>
<a name="ln596">//---------------------------------------------------------</a>
<a name="ln597"> </a>
<a name="ln598">class RestObj : public BasicDurationalObj, public NoteObj {</a>
<a name="ln599">      bool bVerticalCentered;</a>
<a name="ln600">      int vertShift;</a>
<a name="ln601"> </a>
<a name="ln602">   public:</a>
<a name="ln603">      RestObj(Capella*);</a>
<a name="ln604">      void read();</a>
<a name="ln605">      void readCapx(XmlReader&amp; e);</a>
<a name="ln606">      unsigned fullMeasures;  // &gt;0, multi measure rest (counting measures)</a>
<a name="ln607">      };</a>
<a name="ln608"> </a>
<a name="ln609">//---------------------------------------------------------</a>
<a name="ln610">//   CapFont</a>
<a name="ln611">//---------------------------------------------------------</a>
<a name="ln612"> </a>
<a name="ln613">struct CapFont {</a>
<a name="ln614">      QString face;</a>
<a name="ln615">      };</a>
<a name="ln616"> </a>
<a name="ln617">//---------------------------------------------------------</a>
<a name="ln618">//   CapBracket</a>
<a name="ln619">//---------------------------------------------------------</a>
<a name="ln620"> </a>
<a name="ln621">struct CapBracket {</a>
<a name="ln622">      int from, to;</a>
<a name="ln623">      bool curly;</a>
<a name="ln624">      };</a>
<a name="ln625"> </a>
<a name="ln626">//---------------------------------------------------------</a>
<a name="ln627">//   Capella</a>
<a name="ln628">//---------------------------------------------------------</a>
<a name="ln629"> </a>
<a name="ln630">class Capella {</a>
<a name="ln631">      static const char* errmsg[];</a>
<a name="ln632">      int curPos;</a>
<a name="ln633"> </a>
<a name="ln634">      QFile* f;</a>
<a name="ln635">      char* author;</a>
<a name="ln636">      char* keywords;</a>
<a name="ln637">      char* comment;</a>
<a name="ln638"> </a>
<a name="ln639">      unsigned char beamRelMin0;</a>
<a name="ln640">      unsigned char beamRelMin1;</a>
<a name="ln641">      unsigned char beamRelMax0;</a>
<a name="ln642">      unsigned char beamRelMax1;</a>
<a name="ln643">      unsigned nRel;                // presentation parameter</a>
<a name="ln644">      unsigned nAbs;</a>
<a name="ln645">      bool bUseRealSize;</a>
<a name="ln646">      bool bAllowCompression;</a>
<a name="ln647">      bool bPrintLandscape;</a>
<a name="ln648"> </a>
<a name="ln649">      bool bShowBarCount;           // Taktnumerierung zeigen</a>
<a name="ln650">      unsigned char barNumberFrame; // 0=kein, 1=Rechteck, 2=Ellipse</a>
<a name="ln651">      unsigned char nBarDistX;</a>
<a name="ln652">      unsigned char nBarDistY;</a>
<a name="ln653">      // LogFont       barNumFont;</a>
<a name="ln654"> </a>
<a name="ln655">      unsigned nFirstPage;          // Versatz fuer Seitenzaehlung</a>
<a name="ln656"> </a>
<a name="ln657">      unsigned leftPageMargins;     // Seitenraender</a>
<a name="ln658">      unsigned topPageMargins;</a>
<a name="ln659">      unsigned rightPageMargins;</a>
<a name="ln660">      unsigned btmPageMargins;</a>
<a name="ln661"> </a>
<a name="ln662">      QList&lt;QFont&gt; fonts;</a>
<a name="ln663">      QList&lt;CapStaffLayout*&gt; _staffLayouts;      // staff layout</a>
<a name="ln664"> </a>
<a name="ln665">      int interDist;</a>
<a name="ln666">      unsigned char txtAlign;       // Stimmenbezeichnungen 0=links, 1=zentriert, 2=rechts</a>
<a name="ln667">      unsigned char adjustVert;     // 0=nein, 1=außer letzte Seite, 3=alle Seiten</a>
<a name="ln668">      bool redundantKeys;</a>
<a name="ln669">      bool modernDoubleNote;</a>
<a name="ln670">      bool bSystemSeparators;</a>
<a name="ln671">      int nUnnamed;</a>
<a name="ln672">      QFont namesFont;</a>
<a name="ln673"> </a>
<a name="ln674">      void readVoice(CapStaff*, int);</a>
<a name="ln675">      void readStaff(CapSystem*);</a>
<a name="ln676">      void readSystem();</a>
<a name="ln677"> </a>
<a name="ln678">   protected:</a>
<a name="ln679">      void readStaveLayout(CapStaffLayout*, int);</a>
<a name="ln680">      void readLayout();</a>
<a name="ln681"> </a>
<a name="ln682">   public:</a>
<a name="ln683">      enum class Error : char { CAP_NO_ERROR, BAD_SIG, CAP_EOF, BAD_VOICE_SIG,</a>
<a name="ln684">            BAD_STAFF_SIG, BAD_SYSTEM_SIG</a>
<a name="ln685">            };</a>
<a name="ln686"> </a>
<a name="ln687">      Capella();</a>
<a name="ln688">      ~Capella();</a>
<a name="ln689">      void read(QFile*);</a>
<a name="ln690">      QString error(Error n) const { return QString(errmsg[int(n)]); }</a>
<a name="ln691"> </a>
<a name="ln692">      unsigned char readByte();</a>
<a name="ln693">      char readChar();</a>
<a name="ln694">      QColor readColor();</a>
<a name="ln695">      int readInt();</a>
<a name="ln696">      int readLong();</a>
<a name="ln697">      short readWord();</a>
<a name="ln698">      int readDWord();</a>
<a name="ln699">      unsigned readUnsigned();</a>
<a name="ln700">      char* readString();</a>
<a name="ln701">      QString readQString();</a>
<a name="ln702">      void readExtra();</a>
<a name="ln703">      QList&lt;BasicDrawObj*&gt; readDrawObjectArray();</a>
<a name="ln704">      bool read(void* p, qint64 len);</a>
<a name="ln705">      QFont readFont();</a>
<a name="ln706">      QPointF readPoint();</a>
<a name="ln707"> </a>
<a name="ln708">      QList&lt;CapSystem*&gt; systems;</a>
<a name="ln709">      QList&lt;CapBracket&gt; brackets;</a>
<a name="ln710">      ChordObj* backgroundChord;</a>
<a name="ln711">      CapStaffLayout* staffLayout(int idx)               { return _staffLayouts[idx]; }</a>
<a name="ln712">      const QList&lt;CapStaffLayout*&gt;&amp; staffLayouts() const { return _staffLayouts; }</a>
<a name="ln713"> </a>
<a name="ln714">      double smallLineDist;            // spatium unit in metric mm</a>
<a name="ln715">      double normalLineDist;</a>
<a name="ln716">      int topDist;</a>
<a name="ln717">// capx support</a>
<a name="ln718">   private:</a>
<a name="ln719">      void readCapxVoice(XmlReader&amp; e, CapStaff*, int);</a>
<a name="ln720">      void readCapxStaff(XmlReader&amp; e, CapSystem*);</a>
<a name="ln721">      void readCapxSystem(XmlReader&amp; e);</a>
<a name="ln722">      void capxSystems(XmlReader&amp; e);</a>
<a name="ln723">      void readCapxStaveLayout(XmlReader&amp; e, CapStaffLayout*, int);</a>
<a name="ln724">      void capxLayoutStaves(XmlReader&amp; e);</a>
<a name="ln725">      void capxLayout(XmlReader&amp; e);</a>
<a name="ln726">      void initCapxLayout();</a>
<a name="ln727">   public:</a>
<a name="ln728">      void readCapx(XmlReader&amp; e);</a>
<a name="ln729">      QList&lt;BasicDrawObj*&gt; readCapxDrawObjectArray(XmlReader&amp; e);</a>
<a name="ln730">      };</a>
<a name="ln731"> </a>
<a name="ln732"> </a>
<a name="ln733">} // namespace Ms</a>
<a name="ln734">#endif</a>
<a name="ln735"> </a>

</code></pre>
<div class="balloon" rel="262"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: width, yxRatio, height.</p></div>
<div class="balloon" rel="290"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: b.</p></div>
<div class="balloon" rel="315"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: lineWidth.</p></div>
<div class="balloon" rel="316"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: lineWidth.</p></div>
<div class="balloon" rel="330"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: radius, bFilled.</p></div>
<div class="balloon" rel="344"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: bFilled, lineWidth.</p></div>
<div class="balloon" rel="359"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: waveLen, adapt.</p></div>
<div class="balloon" rel="372"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: x0, x1, y.</p></div>
<div class="balloon" rel="409"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: flags, strings.</p></div>
<div class="balloon" rel="492"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: orientation, number.</p></div>
<div class="balloon" rel="90"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: form, line, oct.</p></div>
<div class="balloon" rel="111"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: signature.</p></div>
<div class="balloon" rel="127"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: numerator, log2Denom, allaBreve.</p></div>
<div class="balloon" rel="141"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: _type, _barMode.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
