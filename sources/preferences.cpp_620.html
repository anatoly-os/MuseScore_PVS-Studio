
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>preferences.cpp</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">//=============================================================================</a>
<a name="ln2">//  MuseScore</a>
<a name="ln3">//  Linux Music Score Editor</a>
<a name="ln4">//</a>
<a name="ln5">//  Copyright (C) 2002-2016 Werner Schweer and others</a>
<a name="ln6">//</a>
<a name="ln7">//  This program is free software; you can redistribute it and/or modify</a>
<a name="ln8">//  it under the terms of the GNU General Public License version 2.</a>
<a name="ln9">//</a>
<a name="ln10">//  This program is distributed in the hope that it will be useful,</a>
<a name="ln11">//  but WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln12">//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</a>
<a name="ln13">//  GNU General Public License for more details.</a>
<a name="ln14">//</a>
<a name="ln15">//  You should have received a copy of the GNU General Public License</a>
<a name="ln16">//  along with this program; if not, write to the Free Software</a>
<a name="ln17">//  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</a>
<a name="ln18">//=============================================================================</a>
<a name="ln19"> </a>
<a name="ln20">#include &quot;libmscore/style.h&quot;</a>
<a name="ln21">#include &quot;libmscore/mscore.h&quot;</a>
<a name="ln22">#include &quot;preferences.h&quot;</a>
<a name="ln23"> </a>
<a name="ln24">#ifdef Q_OS_MAC</a>
<a name="ln25">#include &quot;macos/cocoabridge.h&quot;</a>
<a name="ln26">#endif</a>
<a name="ln27"> </a>
<a name="ln28">namespace Ms {</a>
<a name="ln29"> </a>
<a name="ln30">Preferences preferences;</a>
<a name="ln31"> </a>
<a name="ln32"> </a>
<a name="ln33">void Preferences::init(bool storeInMemoryOnly)</a>
<a name="ln34">      {</a>
<a name="ln35">      if (!storeInMemoryOnly) {</a>
<a name="ln36">            if (_settings)</a>
<a name="ln37">                  delete _settings;</a>
<a name="ln38">            _settings = new QSettings();</a>
<a name="ln39">            }</a>
<a name="ln40"> </a>
<a name="ln41">      _storeInMemoryOnly = storeInMemoryOnly;</a>
<a name="ln42"> </a>
<a name="ln43">#if defined(Q_OS_MAC) || (defined(Q_OS_WIN) &amp;&amp; !defined(FOR_WINSTORE))</a>
<a name="ln44">      bool checkUpdateStartup = true;</a>
<a name="ln45">      bool checkExtensionsUpdateStartup = true;</a>
<a name="ln46">#else</a>
<a name="ln47">      bool checkUpdateStartup = false;</a>
<a name="ln48">      bool checkExtensionsUpdateStartup = false;</a>
<a name="ln49">#endif</a>
<a name="ln50"> </a>
<a name="ln51">      bool defaultUsePortAudio = false;</a>
<a name="ln52">      bool defaultUsePulseAudio = false;</a>
<a name="ln53">      bool defaultUseJackAudio = false;</a>
<a name="ln54">      bool defaultUseAlsaAudio = false;</a>
<a name="ln55"> </a>
<a name="ln56">#if defined(Q_OS_MAC) || defined(Q_OS_WIN)</a>
<a name="ln57">      defaultUsePortAudio  = true;</a>
<a name="ln58">      // Linux</a>
<a name="ln59">#elif defined(USE_PULSEAUDIO)</a>
<a name="ln60">      defaultUsePulseAudio  = true;</a>
<a name="ln61">#elif defined(USE_ALSA)</a>
<a name="ln62">      defaultUseAlsaAudio = true;</a>
<a name="ln63">#elif defined(USE_PORTAUDIO)</a>
<a name="ln64">      defaultUsePortAudio = true;</a>
<a name="ln65">#endif</a>
<a name="ln66"> </a>
<a name="ln67">#if defined(Q_OS_MAC) &amp;&amp; !defined(TESTROOT)</a>
<a name="ln68">      const MuseScoreStyleType defaultAppGlobalStyle = CocoaBridge::isSystemDarkTheme() ? MuseScoreStyleType::DARK_FUSION : MuseScoreStyleType::LIGHT_FUSION;</a>
<a name="ln69">#else</a>
<a name="ln70">      const MuseScoreStyleType defaultAppGlobalStyle = MuseScoreStyleType::LIGHT_FUSION;</a>
<a name="ln71">#endif</a>
<a name="ln72"> </a>
<a name="ln73">      QString wd = QString(&quot;%1/%2&quot;).arg(QStandardPaths::writableLocation(QStandardPaths::DocumentsLocation)).arg(QCoreApplication::applicationName());</a>
<a name="ln74"> </a>
<a name="ln75">      _allPreferences = prefs_map_t(</a>
<a name="ln76">      {</a>
<a name="ln77">            {PREF_APP_AUTOSAVE_AUTOSAVETIME,                       new IntPreference(2 /* minutes */, false)},</a>
<a name="ln78">            {PREF_APP_AUTOSAVE_USEAUTOSAVE,                        new BoolPreference(true, false)},</a>
<a name="ln79">            {PREF_APP_KEYBOARDLAYOUT,                              new StringPreference(&quot;US - International&quot;)},</a>
<a name="ln80">            {PREF_APP_PATHS_INSTRUMENTLIST1,                       new StringPreference(&quot;:/data/instruments.xml&quot;, false)},</a>
<a name="ln81">            {PREF_APP_PATHS_INSTRUMENTLIST2,                       new StringPreference(&quot;&quot;, false)},</a>
<a name="ln82">            {PREF_APP_PATHS_MYIMAGES,                              new StringPreference(QFileInfo(QString(&quot;%1/%2&quot;).arg(wd).arg(QCoreApplication::translate(&quot;images_directory&quot;, &quot;Images&quot;))).absoluteFilePath(), false)},</a>
<a name="ln83">            {PREF_APP_PATHS_MYPLUGINS,                             new StringPreference(QFileInfo(QString(&quot;%1/%2&quot;).arg(wd).arg(QCoreApplication::translate(&quot;plugins_directory&quot;, &quot;Plugins&quot;))).absoluteFilePath(), false)},</a>
<a name="ln84">            {PREF_APP_PATHS_MYSCORES,                              new StringPreference(QFileInfo(QString(&quot;%1/%2&quot;).arg(wd).arg(QCoreApplication::translate(&quot;scores_directory&quot;, &quot;Scores&quot;))).absoluteFilePath(), false)},</a>
<a name="ln85">            {PREF_APP_PATHS_MYSOUNDFONTS,                          new StringPreference(QFileInfo(QString(&quot;%1/%2&quot;).arg(wd).arg(QCoreApplication::translate(&quot;soundfonts_directory&quot;, &quot;SoundFonts&quot;))).absoluteFilePath(), false)},</a>
<a name="ln86">            {PREF_APP_PATHS_MYSHORTCUTS,                           new StringPreference(QFileInfo(QString(&quot;%1/%2&quot;).arg(wd).arg(QCoreApplication::translate(&quot;shortcuts_directory&quot;, &quot;Shortcuts&quot;))).absoluteFilePath(), false)},</a>
<a name="ln87">            {PREF_APP_PATHS_MYSTYLES,                              new StringPreference(QFileInfo(QString(&quot;%1/%2&quot;).arg(wd).arg(QCoreApplication::translate(&quot;styles_directory&quot;, &quot;Styles&quot;))).absoluteFilePath(), false)},</a>
<a name="ln88">            {PREF_APP_PATHS_MYTEMPLATES,                           new StringPreference(QFileInfo(QString(&quot;%1/%2&quot;).arg(wd).arg(QCoreApplication::translate(&quot;templates_directory&quot;, &quot;Templates&quot;))).absoluteFilePath(), false)},</a>
<a name="ln89">            {PREF_APP_PATHS_MYEXTENSIONS,                          new StringPreference(QFileInfo(QString(&quot;%1/%2&quot;).arg(wd).arg(QCoreApplication::translate(&quot;extensions_directory&quot;, &quot;Extensions&quot;))).absoluteFilePath(), false)},</a>
<a name="ln90">            {PREF_APP_PLAYBACK_FOLLOWSONG,                         new BoolPreference(true)},</a>
<a name="ln91">            {PREF_APP_PLAYBACK_PANPLAYBACK,                        new BoolPreference(true)},</a>
<a name="ln92">            {PREF_APP_PLAYBACK_PLAYREPEATS,                        new BoolPreference(true)},</a>
<a name="ln93">            {PREF_APP_PLAYBACK_LOOPTOSELECTIONONPLAY,              new BoolPreference(true)},</a>
<a name="ln94">            {PREF_APP_USESINGLEPALETTE,                            new BoolPreference(false)},</a>
<a name="ln95">            {PREF_APP_PALETTESCALE,                                new DoublePreference(1.0)},</a>
<a name="ln96">            {PREF_APP_STARTUP_FIRSTSTART,                          new BoolPreference(true)},</a>
<a name="ln97">            {PREF_APP_STARTUP_SESSIONSTART,                        new EnumPreference(QVariant::fromValue(SessionStart::SCORE), false)},</a>
<a name="ln98">            {PREF_APP_STARTUP_STARTSCORE,                          new StringPreference(&quot;:/data/My_First_Score.mscx&quot;, false)},</a>
<a name="ln99">            {PREF_UI_APP_STARTUP_SHOWTOURS,                        new BoolPreference(true)},</a>
<a name="ln100">            {PREF_APP_WORKSPACE,                                   new StringPreference(&quot;Basic&quot;, false)},</a>
<a name="ln101">            {PREF_APP_TELEMETRY_ALLOWED,                           new BoolPreference(false, false)},</a>
<a name="ln102">            {PREF_APP_STARTUP_TELEMETRY_ACCESS_REQUESTED,          new StringPreference(&quot;&quot;, false)},</a>
<a name="ln103">            {PREF_EXPORT_AUDIO_NORMALIZE,                          new BoolPreference(true)},</a>
<a name="ln104">            {PREF_EXPORT_AUDIO_SAMPLERATE,                         new IntPreference(44100, false)},</a>
<a name="ln105">            {PREF_EXPORT_AUDIO_PCMRATE,                            new IntPreference(16)},</a>
<a name="ln106">            {PREF_EXPORT_MP3_BITRATE,                              new IntPreference(128, false)},</a>
<a name="ln107">            {PREF_EXPORT_MUSICXML_EXPORTBREAKS,                    new EnumPreference(QVariant::fromValue(MusicxmlExportBreaks::ALL), false)},</a>
<a name="ln108">            {PREF_EXPORT_MUSICXML_EXPORTLAYOUT,                    new BoolPreference(true, false)},</a>
<a name="ln109">            {PREF_EXPORT_PDF_DPI,                                  new IntPreference(300, false)},</a>
<a name="ln110">            {PREF_EXPORT_PNG_RESOLUTION,                           new DoublePreference(DPI, false)},</a>
<a name="ln111">            {PREF_EXPORT_PNG_USETRANSPARENCY,                      new BoolPreference(true, false)},</a>
<a name="ln112">            {PREF_IMPORT_GUITARPRO_CHARSET,                        new StringPreference(&quot;UTF-8&quot;, false)},</a>
<a name="ln113">            {PREF_IMPORT_MUSICXML_IMPORTBREAKS,                    new BoolPreference(true, false)},</a>
<a name="ln114">            {PREF_IMPORT_MUSICXML_IMPORTLAYOUT,                    new BoolPreference(true, false)},</a>
<a name="ln115">            {PREF_IMPORT_OVERTURE_CHARSET,                         new StringPreference(&quot;GBK&quot;, false)},</a>
<a name="ln116">            {PREF_IMPORT_STYLE_STYLEFILE,                          new StringPreference(&quot;&quot;, false)},</a>
<a name="ln117">            {PREF_IMPORT_COMPATIBILITY_RESET_ELEMENT_POSITIONS,    new StringPreference(&quot;&quot;, false)},</a>
<a name="ln118">            {PREF_IO_ALSA_DEVICE,                                  new StringPreference(&quot;default&quot;, false)},</a>
<a name="ln119">            {PREF_IO_ALSA_FRAGMENTS,                               new IntPreference(3, false)},</a>
<a name="ln120">            {PREF_IO_ALSA_PERIODSIZE,                              new IntPreference(1024, false)},</a>
<a name="ln121">            {PREF_IO_ALSA_SAMPLERATE,                              new IntPreference(48000, false)},</a>
<a name="ln122">            {PREF_IO_ALSA_USEALSAAUDIO,                            new BoolPreference(defaultUseAlsaAudio, false)},</a>
<a name="ln123">            {PREF_IO_JACK_REMEMBERLASTCONNECTIONS,                 new BoolPreference(true, false)},</a>
<a name="ln124">            {PREF_IO_JACK_TIMEBASEMASTER,                          new BoolPreference(false, false)},</a>
<a name="ln125">            {PREF_IO_JACK_USEJACKAUDIO,                            new BoolPreference(defaultUseJackAudio, false)},</a>
<a name="ln126">            {PREF_IO_JACK_USEJACKMIDI,                             new BoolPreference(false, false)},</a>
<a name="ln127">            {PREF_IO_JACK_USEJACKTRANSPORT,                        new BoolPreference(false, false)},</a>
<a name="ln128">            {PREF_IO_MIDI_ADVANCEONRELEASE,                        new BoolPreference(true, false)},</a>
<a name="ln129">            {PREF_IO_MIDI_ENABLEINPUT,                             new BoolPreference(true, false)},</a>
<a name="ln130">            {PREF_IO_MIDI_EXPANDREPEATS,                           new BoolPreference(true, false)},</a>
<a name="ln131">            {PREF_IO_MIDI_EXPORTRPNS,                              new BoolPreference(false, false)},</a>
<a name="ln132">            {PREF_IO_MIDI_REALTIMEDELAY,                           new IntPreference(750 /* ms */, false)},</a>
<a name="ln133">            {PREF_IO_MIDI_SHORTESTNOTE,                            new IntPreference(MScore::division/4, false)},</a>
<a name="ln134">            {PREF_IO_MIDI_SHOWCONTROLSINMIXER,                     new BoolPreference(false, false)},</a>
<a name="ln135">            {PREF_IO_MIDI_USEREMOTECONTROL,                        new BoolPreference(false, false)},</a>
<a name="ln136">            {PREF_IO_OSC_PORTNUMBER,                               new IntPreference(5282, false)},</a>
<a name="ln137">            {PREF_IO_OSC_USEREMOTECONTROL,                         new BoolPreference(false, false)},</a>
<a name="ln138">            {PREF_IO_PORTAUDIO_DEVICE,                             new IntPreference(-1, false)},</a>
<a name="ln139">            {PREF_IO_PORTAUDIO_USEPORTAUDIO,                       new BoolPreference(defaultUsePortAudio, false)},</a>
<a name="ln140">            {PREF_IO_PORTMIDI_INPUTBUFFERCOUNT,                    new IntPreference(100)},</a>
<a name="ln141">            {PREF_IO_PORTMIDI_INPUTDEVICE,                         new StringPreference(&quot;&quot;)},</a>
<a name="ln142">            {PREF_IO_PORTMIDI_OUTPUTBUFFERCOUNT,                   new IntPreference(65536)},</a>
<a name="ln143">            {PREF_IO_PORTMIDI_OUTPUTDEVICE,                        new StringPreference(&quot;&quot;)},</a>
<a name="ln144">            {PREF_IO_PORTMIDI_OUTPUTLATENCYMILLISECONDS,           new IntPreference(0)},</a>
<a name="ln145">            {PREF_IO_PULSEAUDIO_USEPULSEAUDIO,                     new BoolPreference(defaultUsePulseAudio, false)},</a>
<a name="ln146">            {PREF_SCORE_CHORD_PLAYONADDNOTE,                       new BoolPreference(true, false)},</a>
<a name="ln147">            {PREF_SCORE_MAGNIFICATION,                             new DoublePreference(1.0, false)},</a>
<a name="ln148">            {PREF_SCORE_NOTE_PLAYONCLICK,                          new BoolPreference(true, false)},</a>
<a name="ln149">            {PREF_SCORE_NOTE_DEFAULTPLAYDURATION,                  new IntPreference(300 /* ms */, false)},</a>
<a name="ln150">            {PREF_SCORE_NOTE_WARNPITCHRANGE,                       new BoolPreference(true, false)},</a>
<a name="ln151">            {PREF_SCORE_STYLE_DEFAULTSTYLEFILE,                    new StringPreference(&quot;&quot;, false)},</a>
<a name="ln152">            {PREF_SCORE_STYLE_PARTSTYLEFILE,                       new StringPreference(&quot;&quot;, false)},</a>
<a name="ln153">            {PREF_UI_CANVAS_BG_USECOLOR,                           new BoolPreference(true, false)},</a>
<a name="ln154">            {PREF_UI_CANVAS_FG_USECOLOR,                           new BoolPreference(true, false)},</a>
<a name="ln155">            {PREF_UI_CANVAS_FG_USECOLOR_IN_PALETTES,               new BoolPreference(false, false)},</a>
<a name="ln156">            {PREF_UI_CANVAS_BG_COLOR,                              new ColorPreference(QColor(&quot;#142433&quot;), false)},</a>
<a name="ln157">            {PREF_UI_CANVAS_FG_COLOR,                              new ColorPreference(QColor(&quot;#f9f9f9&quot;), false)},</a>
<a name="ln158">            {PREF_UI_CANVAS_BG_WALLPAPER,                          new StringPreference(QFileInfo(QString(&quot;%1%2&quot;).arg(mscoreGlobalShare).arg(&quot;wallpaper/background1.png&quot;)).absoluteFilePath(), false)},</a>
<a name="ln159">            {PREF_UI_CANVAS_FG_WALLPAPER,                          new StringPreference(QFileInfo(QString(&quot;%1%2&quot;).arg(mscoreGlobalShare).arg(&quot;wallpaper/paper5.png&quot;)).absoluteFilePath(), false)},</a>
<a name="ln160">            {PREF_UI_CANVAS_MISC_ANTIALIASEDDRAWING,               new BoolPreference(true, false)},</a>
<a name="ln161">            {PREF_UI_CANVAS_MISC_SELECTIONPROXIMITY,               new IntPreference(6, false)},</a>
<a name="ln162">            {PREF_UI_CANVAS_SCROLL_LIMITSCROLLAREA,                new BoolPreference(false, false)},</a>
<a name="ln163">            {PREF_UI_CANVAS_SCROLL_VERTICALORIENTATION,            new BoolPreference(false, false)},</a>
<a name="ln164">            {PREF_UI_APP_STARTUP_CHECKUPDATE,                      new BoolPreference(checkUpdateStartup, false)},</a>
<a name="ln165">            {PREF_UI_APP_STARTUP_CHECK_EXTENSIONS_UPDATE,          new BoolPreference(checkExtensionsUpdateStartup, false)},</a>
<a name="ln166">            {PREF_UI_APP_STARTUP_SHOWNAVIGATOR,                    new BoolPreference(false, false)},</a>
<a name="ln167">            {PREF_UI_APP_STARTUP_SHOWPLAYPANEL,                    new BoolPreference(false, false)},</a>
<a name="ln168">            {PREF_UI_APP_STARTUP_SHOWSPLASHSCREEN,                 new BoolPreference(true, false)},</a>
<a name="ln169">            {PREF_UI_APP_STARTUP_SHOWSTARTCENTER,                  new BoolPreference(true, false)},</a>
<a name="ln170">            {PREF_UI_APP_GLOBALSTYLE,                              new EnumPreference(QVariant::fromValue(defaultAppGlobalStyle), false)},</a>
<a name="ln171">            {PREF_UI_APP_LANGUAGE,                                 new StringPreference(&quot;system&quot;, false)},</a>
<a name="ln172">            {PREF_UI_APP_RASTER_HORIZONTAL,                        new IntPreference(2)},</a>
<a name="ln173">            {PREF_UI_APP_RASTER_VERTICAL,                          new IntPreference(2)},</a>
<a name="ln174">            {PREF_UI_APP_SHOWSTATUSBAR,                            new BoolPreference(true)},</a>
<a name="ln175">            {PREF_UI_APP_USENATIVEDIALOGS,                         new BoolPreference(true)},</a>
<a name="ln176">            {PREF_UI_PIANO_HIGHLIGHTCOLOR,                         new ColorPreference(QColor(&quot;#0065BF&quot;))},</a>
<a name="ln177">            {PREF_UI_SCORE_NOTE_DROPCOLOR,                         new ColorPreference(QColor(&quot;#0065BF&quot;))},</a>
<a name="ln178">            {PREF_UI_SCORE_DEFAULTCOLOR,                           new ColorPreference(QColor(&quot;#000000&quot;))},</a>
<a name="ln179">            {PREF_UI_SCORE_FRAMEMARGINCOLOR,                       new ColorPreference(QColor(&quot;#A0A0A4&quot;))},</a>
<a name="ln180">            {PREF_UI_SCORE_LAYOUTBREAKCOLOR,                       new ColorPreference(QColor(&quot;#A0A0A4&quot;))},</a>
<a name="ln181">            {PREF_UI_SCORE_VOICE1_COLOR,                           new ColorPreference(QColor(&quot;#0065BF&quot;))},</a>
<a name="ln182">            {PREF_UI_SCORE_VOICE2_COLOR,                           new ColorPreference(QColor(&quot;#007F00&quot;))},</a>
<a name="ln183">            {PREF_UI_SCORE_VOICE3_COLOR,                           new ColorPreference(QColor(&quot;#C53F00&quot;))},</a>
<a name="ln184">            {PREF_UI_SCORE_VOICE4_COLOR,                           new ColorPreference(QColor(&quot;#C31989&quot;))},</a>
<a name="ln185">            {PREF_UI_THEME_ICONWIDTH,                              new IntPreference(28, false)},</a>
<a name="ln186">            {PREF_UI_THEME_ICONHEIGHT,                             new IntPreference(24, false)},</a>
<a name="ln187">            {PREF_UI_THEME_FONTFAMILY,                             new StringPreference(QApplication::font().family(), false) },</a>
<a name="ln188">            {PREF_UI_THEME_FONTSIZE,                               new IntPreference(QApplication::font().pointSize(), false) },</a>
<a name="ln189">            {PREF_UI_PIANOROLL_DARK_SELECTION_BOX_COLOR,           new ColorPreference(QColor(&quot;#0cebff&quot;))},</a>
<a name="ln190">            {PREF_UI_PIANOROLL_DARK_NOTE_UNSEL_COLOR,              new ColorPreference(QColor(&quot;#1dcca0&quot;))},</a>
<a name="ln191">            {PREF_UI_PIANOROLL_DARK_NOTE_SEL_COLOR,                new ColorPreference(QColor(&quot;#ffff00&quot;))},</a>
<a name="ln192">            {PREF_UI_PIANOROLL_DARK_BG_BASE_COLOR,                 new ColorPreference(QColor(&quot;#3a3a3a&quot;))},</a>
<a name="ln193">            {PREF_UI_PIANOROLL_DARK_BG_KEY_WHITE_COLOR,            new ColorPreference(QColor(&quot;#3a3a3a&quot;))},</a>
<a name="ln194">            {PREF_UI_PIANOROLL_DARK_BG_KEY_BLACK_COLOR,            new ColorPreference(QColor(&quot;#262626&quot;))},</a>
<a name="ln195">            {PREF_UI_PIANOROLL_DARK_BG_GRIDLINE_COLOR,             new ColorPreference(QColor(&quot;#111111&quot;))},</a>
<a name="ln196">            {PREF_UI_PIANOROLL_DARK_BG_TEXT_COLOR,                 new ColorPreference(QColor(&quot;#999999&quot;))},</a>
<a name="ln197">            {PREF_UI_PIANOROLL_LIGHT_SELECTION_BOX_COLOR,          new ColorPreference(QColor(&quot;#2085c3&quot;))},</a>
<a name="ln198">            {PREF_UI_PIANOROLL_LIGHT_NOTE_UNSEL_COLOR,             new ColorPreference(QColor(&quot;#1dcca0&quot;))},</a>
<a name="ln199">            {PREF_UI_PIANOROLL_LIGHT_NOTE_SEL_COLOR,               new ColorPreference(QColor(&quot;#ffff00&quot;))},</a>
<a name="ln200">            {PREF_UI_PIANOROLL_LIGHT_BG_BASE_COLOR,                new ColorPreference(QColor(&quot;#e0e0e7&quot;))},</a>
<a name="ln201">            {PREF_UI_PIANOROLL_LIGHT_BG_KEY_WHITE_COLOR,           new ColorPreference(QColor(&quot;#ffffff&quot;))},</a>
<a name="ln202">            {PREF_UI_PIANOROLL_LIGHT_BG_KEY_BLACK_COLOR,           new ColorPreference(QColor(&quot;#e6e6e6&quot;))},</a>
<a name="ln203">            {PREF_UI_PIANOROLL_LIGHT_BG_GRIDLINE_COLOR,            new ColorPreference(QColor(&quot;#a2a2a6&quot;))},</a>
<a name="ln204">            {PREF_UI_PIANOROLL_LIGHT_BG_TEXT_COLOR,                new ColorPreference(QColor(&quot;#111111&quot;))},</a>
<a name="ln205">            {PREF_UI_BUTTON_HIGHLIGHT_COLOR_DISABLED_DARK_ON,      new ColorPreference(QColor(&quot;#7F7F7F&quot;))},</a>
<a name="ln206">            {PREF_UI_BUTTON_HIGHLIGHT_COLOR_DISABLED_DARK_OFF,     new ColorPreference(QColor(&quot;#a0a0a0&quot;))},</a>
<a name="ln207">            {PREF_UI_BUTTON_HIGHLIGHT_COLOR_DISABLED_LIGHT_ON,     new ColorPreference(QColor(&quot;#7F7F7F&quot;))},</a>
<a name="ln208">            {PREF_UI_BUTTON_HIGHLIGHT_COLOR_DISABLED_LIGHT_OFF,    new ColorPreference(QColor(&quot;#a0a0a0&quot;))},</a>
<a name="ln209">            {PREF_UI_BUTTON_HIGHLIGHT_COLOR_ENABLED_DARK_ON,       new ColorPreference(QColor(&quot;#36B2FF&quot;))},</a>
<a name="ln210">            {PREF_UI_BUTTON_HIGHLIGHT_COLOR_ENABLED_DARK_OFF,      new ColorPreference(QColor(&quot;#eff0f1&quot;))},</a>
<a name="ln211">            {PREF_UI_BUTTON_HIGHLIGHT_COLOR_ENABLED_LIGHT_ON,      new ColorPreference(QColor(&quot;#0065BF&quot;))},</a>
<a name="ln212">            {PREF_UI_BUTTON_HIGHLIGHT_COLOR_ENABLED_LIGHT_OFF,     new ColorPreference(QColor(&quot;#3b3f45&quot;))},</a>
<a name="ln213">            {PREF_UI_INSPECTOR_STYLED_TEXT_COLOR_LIGHT,            new ColorPreference(QColor(&quot;#0066BF&quot;))},</a>
<a name="ln214">            {PREF_UI_INSPECTOR_STYLED_TEXT_COLOR_DARK,             new ColorPreference(QColor(&quot;#36B2FF&quot;))}</a>
<a name="ln215">      });</a>
<a name="ln216"> </a>
<a name="ln217">      _initialized = true;</a>
<a name="ln218">      updateLocalPreferences();</a>
<a name="ln219">      }</a>
<a name="ln220"> </a>
<a name="ln221">void Preferences::save()</a>
<a name="ln222">      {</a>
<a name="ln223">      settings()-&gt;sync();</a>
<a name="ln224">      }</a>
<a name="ln225"> </a>
<a name="ln226">QVariant Preferences::defaultValue(const QString key) const</a>
<a name="ln227">      {</a>
<a name="ln228">      checkIfKeyExists(key);</a>
<a name="ln229">      Preference* pref = _allPreferences.value(key);</a>
<a name="ln230">      return pref ? pref-&gt;defaultValue() : QVariant();</a>
<a name="ln231">      }</a>
<a name="ln232"> </a>
<a name="ln233">QSettings* Preferences::settings() const</a>
<a name="ln234">      {</a>
<a name="ln235">      if (!_initialized) {</a>
<a name="ln236">            qWarning(&quot;Preferences is not initialized. Call init() to initialize.&quot;);</a>
<a name="ln237">            Q_ASSERT(_initialized);</a>
<a name="ln238">            }</a>
<a name="ln239"> </a>
<a name="ln240">      return _settings;</a>
<a name="ln241">      }</a>
<a name="ln242"> </a>
<a name="ln243">QVariant Preferences::get(const QString key) const</a>
<a name="ln244">      {</a>
<a name="ln245">      QVariant pref = _inMemorySettings.value(key);</a>
<a name="ln246"> </a>
<a name="ln247">      if (_storeInMemoryOnly)</a>
<a name="ln248">            return (_inMemorySettings.contains(key)) ? pref : QVariant(); // invalid QVariant returned when not found</a>
<a name="ln249">      else if (_inMemorySettings.contains(key)) // if there exists a temporary value stored &quot;in memory&quot; return this value</a>
<a name="ln250">            return pref;</a>
<a name="ln251">      else if (useLocalPrefs &amp;&amp; localPreferences.contains(key))</a>
<a name="ln252">            return localPreferences.value(key);</a>
<a name="ln253">      else</a>
<a name="ln254">            return settings()-&gt;value(key);</a>
<a name="ln255">      }</a>
<a name="ln256"> </a>
<a name="ln257">void Preferences::set(const QString key, QVariant value, bool temporary)</a>
<a name="ln258">      {</a>
<a name="ln259">      if (_storeInMemoryOnly || temporary)</a>
<a name="ln260">            _inMemorySettings[key] = value;</a>
<a name="ln261">      else if (useLocalPrefs &amp;&amp; localPreferences.contains(key))</a>
<a name="ln262">            localPreferences[key] = value;</a>
<a name="ln263">      else</a>
<a name="ln264">            settings()-&gt;setValue(key, value);</a>
<a name="ln265">      }</a>
<a name="ln266"> </a>
<a name="ln267">void Preferences::remove(const QString key)</a>
<a name="ln268">      {</a>
<a name="ln269">      // remove both preference stored &quot;in memory&quot; and in QSettings</a>
<a name="ln270">      _inMemorySettings.remove(key);</a>
<a name="ln271">      settings()-&gt;remove(key);</a>
<a name="ln272">      }</a>
<a name="ln273"> </a>
<a name="ln274">bool Preferences::has(const QString key) const</a>
<a name="ln275">      {</a>
<a name="ln276">      return _inMemorySettings.contains(key) || settings()-&gt;contains(key);</a>
<a name="ln277">      }</a>
<a name="ln278"> </a>
<a name="ln279">QVariant Preferences::preference(const QString key) const</a>
<a name="ln280">      {</a>
<a name="ln281">      checkIfKeyExists(key);</a>
<a name="ln282">      QVariant pref = get(key);</a>
<a name="ln283"> </a>
<a name="ln284">      // pref is invalid both if setting is not found or pref is an invalid QVariant object</a>
<a name="ln285">      if (!pref.isValid() || pref.isNull() || _returnDefaultValues)</a>
<a name="ln286">            return defaultValue(key);</a>
<a name="ln287">      else</a>
<a name="ln288">            return pref;</a>
<a name="ln289">      }</a>
<a name="ln290"> </a>
<a name="ln291">bool Preferences::checkIfKeyExists(const QString key) const</a>
<a name="ln292">      {</a>
<a name="ln293">      bool exists = _allPreferences.contains(key);</a>
<a name="ln294">      if (!exists) {</a>
<a name="ln295">            qWarning(&quot;Preference not found: %s&quot;, key.toUtf8().constData());</a>
<a name="ln296">            Q_ASSERT(exists);</a>
<a name="ln297">            }</a>
<a name="ln298">      return exists;</a>
<a name="ln299">      }</a>
<a name="ln300"> </a>
<a name="ln301">QMetaType::Type Preferences::type(const QString key) const</a>
<a name="ln302">      {</a>
<a name="ln303">      if (_allPreferences.contains(key))</a>
<a name="ln304">            return _allPreferences.value(key)-&gt;type();</a>
<a name="ln305">      else {</a>
<a name="ln306">            return QMetaType::UnknownType;</a>
<a name="ln307">            }</a>
<a name="ln308">      }</a>
<a name="ln309"> </a>
<a name="ln310">bool Preferences::checkType(const QString key, QMetaType::Type t) const</a>
<a name="ln311">      {</a>
<a name="ln312">      if (type(key) != t) {</a>
<a name="ln313">            qWarning(&quot;Preference is not of correct type: %s&quot;, key.toUtf8().constData());</a>
<a name="ln314">            Q_ASSERT(type(key) == QMetaType::Bool);</a>
<a name="ln315">            }</a>
<a name="ln316">      return type(key) == t;</a>
<a name="ln317">      }</a>
<a name="ln318"> </a>
<a name="ln319">Preferences::Preferences()</a>
<a name="ln320">      : _settings(0)</a>
<a name="ln321">      {}</a>
<a name="ln322"> </a>
<a name="ln323">Preferences::~Preferences()</a>
<a name="ln324">      {</a>
<a name="ln325">      // clean up _allPreferences</a>
<a name="ln326">      for (Preference* pref : _allPreferences.values())</a>
<a name="ln327">            delete pref;</a>
<a name="ln328"> </a>
<a name="ln329">      if (_settings) {</a>
<a name="ln330">            delete _settings;</a>
<a name="ln331">            }</a>
<a name="ln332">      }</a>
<a name="ln333"> </a>
<a name="ln334">bool Preferences::getBool(const QString key) const</a>
<a name="ln335">      {</a>
<a name="ln336">      checkType(key, QMetaType::Bool);</a>
<a name="ln337">      return preference(key).toBool();</a>
<a name="ln338">      }</a>
<a name="ln339"> </a>
<a name="ln340">QColor Preferences::getColor(const QString key) const</a>
<a name="ln341">      {</a>
<a name="ln342">      checkType(key, QMetaType::QColor);</a>
<a name="ln343">      QVariant v = preference(key);</a>
<a name="ln344">      if (v.type() == QVariant::Color)</a>
<a name="ln345">            return v.value&lt;QColor&gt;();</a>
<a name="ln346">      else {</a>
<a name="ln347">            // in case the color is expressed in settings file as a textual color representation</a>
<a name="ln348">            QColor c(v.toString());</a>
<a name="ln349">            return c.isValid() ? c : defaultValue(key).value&lt;QColor&gt;();</a>
<a name="ln350">            }</a>
<a name="ln351">      }</a>
<a name="ln352"> </a>
<a name="ln353">QString Preferences::getString(const QString key) const</a>
<a name="ln354">      {</a>
<a name="ln355">      checkType(key, QMetaType::QString);</a>
<a name="ln356">      return preference(key).toString();</a>
<a name="ln357">      }</a>
<a name="ln358"> </a>
<a name="ln359">int Preferences::getInt(const QString key) const</a>
<a name="ln360">      {</a>
<a name="ln361">      checkType(key, QMetaType::Int);</a>
<a name="ln362">      QVariant v = preference(key);</a>
<a name="ln363">      bool ok;</a>
<a name="ln364">      int pref = v.toInt(&amp;ok);</a>
<a name="ln365">      if (!ok) {</a>
<a name="ln366">            qWarning(&quot;Can not convert preference %s to int. Returning default value.&quot;, key.toUtf8().constData());</a>
<a name="ln367">            return defaultValue(key).toInt();</a>
<a name="ln368">            }</a>
<a name="ln369">      return pref;</a>
<a name="ln370">}</a>
<a name="ln371"> </a>
<a name="ln372">double Preferences::getDouble(const QString key) const</a>
<a name="ln373">      {</a>
<a name="ln374">      checkType(key, QMetaType::Double);</a>
<a name="ln375">      QVariant v = preference(key);</a>
<a name="ln376">      bool ok;</a>
<a name="ln377">      double pref = v.toDouble(&amp;ok);</a>
<a name="ln378">      if (!ok) {</a>
<a name="ln379">            qWarning(&quot;Can not convert preference %s to double. Returning default value.&quot;, key.toUtf8().constData());</a>
<a name="ln380">            return defaultValue(key).toDouble();</a>
<a name="ln381">            }</a>
<a name="ln382">      return pref;</a>
<a name="ln383">      }</a>
<a name="ln384"> </a>
<a name="ln385">SessionStart Preferences::sessionStart() const</a>
<a name="ln386">      {</a>
<a name="ln387">      return preference(PREF_APP_STARTUP_SESSIONSTART).value&lt;SessionStart&gt;();</a>
<a name="ln388">      }</a>
<a name="ln389"> </a>
<a name="ln390">MusicxmlExportBreaks Preferences::musicxmlExportBreaks() const</a>
<a name="ln391">      {</a>
<a name="ln392">      return preference(PREF_EXPORT_MUSICXML_EXPORTBREAKS).value&lt;MusicxmlExportBreaks&gt;();</a>
<a name="ln393">      }</a>
<a name="ln394"> </a>
<a name="ln395">MuseScoreStyleType Preferences::globalStyle() const</a>
<a name="ln396">      {</a>
<a name="ln397">      return preference(PREF_UI_APP_GLOBALSTYLE).value&lt;MuseScoreStyleType&gt;();</a>
<a name="ln398">      }</a>
<a name="ln399"> </a>
<a name="ln400">bool Preferences::isThemeDark() const</a>
<a name="ln401">      {</a>
<a name="ln402">      return globalStyle() == MuseScoreStyleType::DARK_FUSION;</a>
<a name="ln403">      }</a>
<a name="ln404"> </a>
<a name="ln405">void Preferences::setToDefaultValue(const QString key)</a>
<a name="ln406">      {</a>
<a name="ln407">      set(key, defaultValue(key));</a>
<a name="ln408">      }</a>
<a name="ln409"> </a>
<a name="ln410"> </a>
<a name="ln411">void Preferences::setPreference(const QString key, QVariant value)</a>
<a name="ln412">      {</a>
<a name="ln413">      checkIfKeyExists(key);</a>
<a name="ln414">      set(key, value);</a>
<a name="ln415">      }</a>
<a name="ln416"> </a>
<a name="ln417">void Preferences::setTemporaryPreference(const QString key, QVariant value)</a>
<a name="ln418">      {</a>
<a name="ln419">      // note: this function should not call checkIfKeyExists() because it may be</a>
<a name="ln420">      // called before init() which is ok since the preference is only stored &quot;in memory&quot;</a>
<a name="ln421">      set(key, value, true);</a>
<a name="ln422">      }</a>
<a name="ln423"> </a>
<a name="ln424">MidiRemote Preferences::midiRemote(int recordId) const</a>
<a name="ln425">      {</a>
<a name="ln426">      MidiRemote remote;</a>
<a name="ln427">      QString baseKey = QString(PREF_IO_MIDI_REMOTE) + QString(&quot;%1%2%3&quot;).arg(&quot;/&quot;).arg(recordId).arg(&quot;/&quot;);</a>
<a name="ln428"> </a>
<a name="ln429">      if (has(baseKey + &quot;type&quot;)) {</a>
<a name="ln430">            remote.type = MidiRemoteType(get(baseKey + &quot;type&quot;).toInt());</a>
<a name="ln431">            remote.data = get(baseKey + &quot;data&quot;).toInt();</a>
<a name="ln432">            }</a>
<a name="ln433">      else {</a>
<a name="ln434">            remote.type = MIDI_REMOTE_TYPE_INACTIVE;</a>
<a name="ln435">            }</a>
<a name="ln436"> </a>
<a name="ln437">      return remote;</a>
<a name="ln438">      }</a>
<a name="ln439"> </a>
<a name="ln440">void Preferences::updateMidiRemote(int recordId, MidiRemoteType type, int data)</a>
<a name="ln441">      {</a>
<a name="ln442">      QString baseKey = QString(PREF_IO_MIDI_REMOTE) + QString(&quot;%1%2%3&quot;).arg(&quot;/&quot;).arg(recordId).arg(&quot;/&quot;);</a>
<a name="ln443">      set(baseKey + &quot;type&quot;, static_cast&lt;int&gt;(type));</a>
<a name="ln444">      set(baseKey + &quot;data&quot;, data);</a>
<a name="ln445">      }</a>
<a name="ln446"> </a>
<a name="ln447">void Preferences::clearMidiRemote(int recordId)</a>
<a name="ln448">      {</a>
<a name="ln449">      QString baseKey = QString(PREF_IO_MIDI_REMOTE) + QString(&quot;%1%2&quot;).arg(&quot;/&quot;).arg(recordId);</a>
<a name="ln450">      remove(baseKey);</a>
<a name="ln451">      }</a>
<a name="ln452"> </a>
<a name="ln453">QMap&lt;QString, QVariant&gt; Preferences::getDefaultLocalPreferences() {</a>
<a name="ln454">      bool tmp = useLocalPrefs;</a>
<a name="ln455">      useLocalPrefs = false;</a>
<a name="ln456">      QMap&lt;QString, QVariant&gt; defaultLocalPreferences;</a>
<a name="ln457">      for (QString s : {PREF_UI_CANVAS_BG_USECOLOR,</a>
<a name="ln458">                        PREF_UI_CANVAS_FG_USECOLOR,</a>
<a name="ln459">                        PREF_UI_CANVAS_FG_USECOLOR_IN_PALETTES,</a>
<a name="ln460">                        PREF_UI_CANVAS_BG_COLOR,</a>
<a name="ln461">                        PREF_UI_CANVAS_FG_COLOR,</a>
<a name="ln462">                        PREF_UI_CANVAS_BG_WALLPAPER,</a>
<a name="ln463">                        PREF_UI_CANVAS_FG_WALLPAPER,</a>
<a name="ln464">                        PREF_UI_CANVAS_MISC_ANTIALIASEDDRAWING,</a>
<a name="ln465">                        PREF_UI_CANVAS_MISC_SELECTIONPROXIMITY,</a>
<a name="ln466">                        PREF_UI_CANVAS_SCROLL_LIMITSCROLLAREA,</a>
<a name="ln467">                        PREF_UI_CANVAS_SCROLL_VERTICALORIENTATION,</a>
<a name="ln468">                        PREF_UI_APP_SHOWSTATUSBAR,</a>
<a name="ln469">                        PREF_UI_APP_USENATIVEDIALOGS,</a>
<a name="ln470">                        PREF_UI_PIANO_HIGHLIGHTCOLOR,</a>
<a name="ln471">                        PREF_UI_SCORE_NOTE_DROPCOLOR,</a>
<a name="ln472">                        PREF_UI_SCORE_DEFAULTCOLOR,</a>
<a name="ln473">                        PREF_UI_SCORE_FRAMEMARGINCOLOR,</a>
<a name="ln474">                        PREF_UI_SCORE_LAYOUTBREAKCOLOR,</a>
<a name="ln475">                        PREF_UI_SCORE_VOICE1_COLOR,</a>
<a name="ln476">                        PREF_UI_SCORE_VOICE2_COLOR,</a>
<a name="ln477">                        PREF_UI_SCORE_VOICE3_COLOR,</a>
<a name="ln478">                        PREF_UI_SCORE_VOICE4_COLOR,</a>
<a name="ln479">                        PREF_UI_THEME_ICONWIDTH,</a>
<a name="ln480">                        PREF_UI_THEME_ICONHEIGHT,</a>
<a name="ln481">                        PREF_UI_THEME_FONTFAMILY,</a>
<a name="ln482">                        PREF_UI_THEME_FONTSIZE}) {</a>
<a name="ln483">            QVariant value = get(s);</a>
<a name="ln484">            if (!value.isValid())</a>
<a name="ln485">                  value = _allPreferences.value(s)-&gt;defaultValue();</a>
<a name="ln486">            defaultLocalPreferences.insert(s, value);</a>
<a name="ln487">            }</a>
<a name="ln488">      useLocalPrefs = tmp;</a>
<a name="ln489">      return defaultLocalPreferences;</a>
<a name="ln490">      }</a>
<a name="ln491"> </a>
<a name="ln492">void Preferences::setLocalPreference(QString key, QVariant value)</a>
<a name="ln493">      {</a>
<a name="ln494">      if (localPreferences.contains(key))</a>
<a name="ln495">            localPreferences[key] = value;</a>
<a name="ln496">      }</a>
<a name="ln497"> </a>
<a name="ln498">Preference::Preference(QVariant defaultValue, QMetaType::Type type, bool showInAdvancedList)</a>
<a name="ln499">      : _defaultValue(defaultValue),</a>
<a name="ln500">        _showInAdvancedList(showInAdvancedList),</a>
<a name="ln501">        _type(type)</a>
<a name="ln502">      {}</a>
<a name="ln503"> </a>
<a name="ln504">IntPreference::IntPreference(int defaultValue, bool showInAdvancedList)</a>
<a name="ln505">      : Preference(defaultValue, QMetaType::Int, showInAdvancedList)</a>
<a name="ln506">      {}</a>
<a name="ln507"> </a>
<a name="ln508">void IntPreference::accept(QString key, PreferenceVisitor&amp; v)</a>
<a name="ln509">      {</a>
<a name="ln510">      v.visit(key, this);</a>
<a name="ln511">      }</a>
<a name="ln512"> </a>
<a name="ln513">DoublePreference::DoublePreference(double defaultValue, bool showInAdvancedList)</a>
<a name="ln514">      : Preference(defaultValue, QMetaType::Double, showInAdvancedList)</a>
<a name="ln515">      {}</a>
<a name="ln516"> </a>
<a name="ln517">void DoublePreference::accept(QString key, PreferenceVisitor&amp; v)</a>
<a name="ln518">      {</a>
<a name="ln519">      v.visit(key, this);</a>
<a name="ln520">      }</a>
<a name="ln521"> </a>
<a name="ln522">BoolPreference::BoolPreference(bool defaultValue, bool showInAdvancedList)</a>
<a name="ln523">      : Preference(defaultValue, QMetaType::Bool, showInAdvancedList)</a>
<a name="ln524">      {}</a>
<a name="ln525"> </a>
<a name="ln526">void BoolPreference::accept(QString key, PreferenceVisitor&amp; v)</a>
<a name="ln527">      {</a>
<a name="ln528">      v.visit(key, this);</a>
<a name="ln529">      }</a>
<a name="ln530"> </a>
<a name="ln531">StringPreference::StringPreference(QString defaultValue, bool showInAdvancedList)</a>
<a name="ln532">      : Preference(defaultValue, QMetaType::QString, showInAdvancedList)</a>
<a name="ln533">      {}</a>
<a name="ln534"> </a>
<a name="ln535">void StringPreference::accept(QString key, PreferenceVisitor&amp; v)</a>
<a name="ln536">      {</a>
<a name="ln537">      v.visit(key, this);</a>
<a name="ln538">      }</a>
<a name="ln539"> </a>
<a name="ln540">ColorPreference::ColorPreference(QColor defaultValue, bool showInAdvancedList)</a>
<a name="ln541">      : Preference(defaultValue, QMetaType::QColor, showInAdvancedList)</a>
<a name="ln542">      {}</a>
<a name="ln543"> </a>
<a name="ln544">void ColorPreference::accept(QString key, PreferenceVisitor&amp; v)</a>
<a name="ln545">      {</a>
<a name="ln546">      v.visit(key, this);</a>
<a name="ln547">      }</a>
<a name="ln548"> </a>
<a name="ln549">EnumPreference::EnumPreference(QVariant defaultValue, bool showInAdvancedList)</a>
<a name="ln550">      : Preference(defaultValue, QMetaType::User, showInAdvancedList)</a>
<a name="ln551">      {}</a>
<a name="ln552"> </a>
<a name="ln553">void EnumPreference::accept(QString, PreferenceVisitor&amp;)</a>
<a name="ln554">      {</a>
<a name="ln555">      }</a>
<a name="ln556"> </a>
<a name="ln557"> </a>
<a name="ln558"> </a>
<a name="ln559">} // namespace Ms</a>

</code></pre>
<div class="balloon" rel="295"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v618/" target="_blank">V618</a> It's dangerous to call the 'warning' function in such a manner, as the line being passed could contain format specification. The example of the safe code: printf("%s", str);</p></div>
<div class="balloon" rel="313"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v618/" target="_blank">V618</a> It's dangerous to call the 'warning' function in such a manner, as the line being passed could contain format specification. The example of the safe code: printf("%s", str);</p></div>
<div class="balloon" rel="366"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v618/" target="_blank">V618</a> It's dangerous to call the 'warning' function in such a manner, as the line being passed could contain format specification. The example of the safe code: printf("%s", str);</p></div>
<div class="balloon" rel="379"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v618/" target="_blank">V618</a> It's dangerous to call the 'warning' function in such a manner, as the line being passed could contain format specification. The example of the safe code: printf("%s", str);</p></div>
<div class="balloon" rel="8"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
