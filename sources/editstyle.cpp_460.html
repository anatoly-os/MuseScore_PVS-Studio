
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>editstyle.cpp</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">//=============================================================================</a>
<a name="ln2">//  MuseScore</a>
<a name="ln3">//  Music Composition &amp; Notation</a>
<a name="ln4">//</a>
<a name="ln5">//  Copyright (C) 2002-2016 Werner Schweer and others</a>
<a name="ln6">//</a>
<a name="ln7">//  This program is free software; you can redistribute it and/or modify</a>
<a name="ln8">//  it under the terms of the GNU General Public License version 2</a>
<a name="ln9">//  as published by the Free Software Foundation and appearing in</a>
<a name="ln10">//  the file LICENCE.GPL</a>
<a name="ln11">//=============================================================================</a>
<a name="ln12"> </a>
<a name="ln13">#include &quot;libmscore/score.h&quot;</a>
<a name="ln14">#include &quot;scoreview.h&quot;</a>
<a name="ln15">#include &quot;libmscore/style.h&quot;</a>
<a name="ln16">#include &quot;editstyle.h&quot;</a>
<a name="ln17">#include &quot;libmscore/articulation.h&quot;</a>
<a name="ln18">#include &quot;libmscore/sym.h&quot;</a>
<a name="ln19">#include &quot;icons.h&quot;</a>
<a name="ln20">#include &quot;musescore.h&quot;</a>
<a name="ln21">#include &quot;libmscore/undo.h&quot;</a>
<a name="ln22">#include &quot;icons.h&quot;</a>
<a name="ln23">#include &quot;libmscore/harmony.h&quot;</a>
<a name="ln24">#include &quot;libmscore/chordlist.h&quot;</a>
<a name="ln25">#include &quot;libmscore/figuredbass.h&quot;</a>
<a name="ln26">#include &quot;libmscore/clef.h&quot;</a>
<a name="ln27">#include &quot;libmscore/excerpt.h&quot;</a>
<a name="ln28">#include &quot;libmscore/tuplet.h&quot;</a>
<a name="ln29">#include &quot;libmscore/layout.h&quot;</a>
<a name="ln30">#include &quot;inspector/alignSelect.h&quot;</a>
<a name="ln31">#include &quot;inspector/offsetSelect.h&quot;</a>
<a name="ln32">#include &quot;inspector/fontStyleSelect.h&quot;</a>
<a name="ln33"> </a>
<a name="ln34">namespace Ms {</a>
<a name="ln35"> </a>
<a name="ln36">//---------------------------------------------------------</a>
<a name="ln37">//   EditStyle</a>
<a name="ln38">//---------------------------------------------------------</a>
<a name="ln39"> </a>
<a name="ln40">EditStyle::EditStyle(Score* s, QWidget* parent)</a>
<a name="ln41">   : QDialog(parent), cs(s)</a>
<a name="ln42">      {</a>
<a name="ln43">      setObjectName(&quot;EditStyle&quot;);</a>
<a name="ln44">      setupUi(this);</a>
<a name="ln45">      setWindowFlags(this-&gt;windowFlags() &amp; ~Qt::WindowContextHelpButtonHint);</a>
<a name="ln46">      buttonApplyToAllParts = buttonBox-&gt;addButton(tr(&quot;Apply to all Parts&quot;), QDialogButtonBox::ApplyRole);</a>
<a name="ln47">      //buttonApplyToAllParts-&gt;setEnabled(!cs-&gt;isMaster()); // set in showEvent() now</a>
<a name="ln48">      buttonTogglePagelist-&gt;setIcon(QIcon(*icons[int(Icons::goNext_ICON)]));</a>
<a name="ln49">      setModal(true);</a>
<a name="ln50"> </a>
<a name="ln51">      // create button groups for every set of radio button widgets</a>
<a name="ln52">      // use this group widgets in list styleWidgets</a>
<a name="ln53">      // This works for groups which represent an int enumeration.</a>
<a name="ln54"> </a>
<a name="ln55">      QButtonGroup* fretNumGroup = new QButtonGroup(this);</a>
<a name="ln56">      fretNumGroup-&gt;addButton(radioFretNumLeft, 0);</a>
<a name="ln57">      fretNumGroup-&gt;addButton(radioFretNumRight, 1);</a>
<a name="ln58"> </a>
<a name="ln59">      QButtonGroup* ksng = new QButtonGroup(this);</a>
<a name="ln60">      ksng-&gt;addButton(radioKeySigNatNone, int(KeySigNatural::NONE));</a>
<a name="ln61">      ksng-&gt;addButton(radioKeySigNatBefore, int(KeySigNatural::BEFORE));</a>
<a name="ln62">      ksng-&gt;addButton(radioKeySigNatAfter, int(KeySigNatural::AFTER));</a>
<a name="ln63"> </a>
<a name="ln64">      QButtonGroup* ctg = new QButtonGroup(this);</a>
<a name="ln65">      ctg-&gt;addButton(clefTab1, int(ClefType::TAB));</a>
<a name="ln66">      ctg-&gt;addButton(clefTab2, int(ClefType::TAB_SERIF));</a>
<a name="ln67"> </a>
<a name="ln68">      QButtonGroup* fbAlign = new QButtonGroup(this);</a>
<a name="ln69">      fbAlign-&gt;addButton(radioFBTop, 0);</a>
<a name="ln70">      fbAlign-&gt;addButton(radioFBBottom, 1);</a>
<a name="ln71"> </a>
<a name="ln72">      QButtonGroup* fbStyle = new QButtonGroup(this);</a>
<a name="ln73">      fbStyle-&gt;addButton(radioFBModern, 0);</a>
<a name="ln74">      fbStyle-&gt;addButton(radioFBHistoric, 1);</a>
<a name="ln75"> </a>
<a name="ln76"> </a>
<a name="ln77">      const char* styles[] = {</a>
<a name="ln78">            QT_TRANSLATE_NOOP(&quot;EditStyleBase&quot;, &quot;Continuous&quot;),</a>
<a name="ln79">            QT_TRANSLATE_NOOP(&quot;EditStyleBase&quot;, &quot;Dashed&quot;),</a>
<a name="ln80">            QT_TRANSLATE_NOOP(&quot;EditStyleBase&quot;, &quot;Dotted&quot;),</a>
<a name="ln81">            QT_TRANSLATE_NOOP(&quot;EditStyleBase&quot;, &quot;Dash-dotted&quot;),</a>
<a name="ln82">            QT_TRANSLATE_NOOP(&quot;EditStyleBase&quot;, &quot;Dash-dot-dotted&quot;)</a>
<a name="ln83">            };</a>
<a name="ln84">      int dta = 1;</a>
<a name="ln85">      voltaLineStyle-&gt;clear();</a>
<a name="ln86">      ottavaLineStyle-&gt;clear();</a>
<a name="ln87">      pedalLineStyle-&gt;clear();</a>
<a name="ln88">      for (const char* p : styles) {</a>
<a name="ln89">            QString trs = qApp-&gt;translate(&quot;EditStyleBase&quot;, p);</a>
<a name="ln90">            voltaLineStyle-&gt;addItem(trs, dta);</a>
<a name="ln91">            ottavaLineStyle-&gt;addItem(trs, dta);</a>
<a name="ln92">            pedalLineStyle-&gt;addItem(trs, dta);</a>
<a name="ln93">            ++dta;</a>
<a name="ln94">            }</a>
<a name="ln95"> </a>
<a name="ln96">      styleWidgets = {</a>
<a name="ln97">      //   idx                --- showPercent      --- widget          --- resetButton</a>
<a name="ln98">      { Sid::figuredBassAlignment,    false, fbAlign,                 0                    },</a>
<a name="ln99">      { Sid::figuredBassStyle,        false, fbStyle,                 0                    },</a>
<a name="ln100">      { Sid::figuredBassFontSize,     false, doubleSpinFBSize,        0                    },</a>
<a name="ln101">      { Sid::figuredBassYOffset,      false, doubleSpinFBVertPos,     0                    },</a>
<a name="ln102">      { Sid::figuredBassLineHeight,   true,  spinFBLineHeight,        0                    },</a>
<a name="ln103">      { Sid::tabClef,                 false, ctg,                     0                    },</a>
<a name="ln104">      { Sid::keySigNaturals,          false, ksng,                    0                    },</a>
<a name="ln105">      { Sid::voltaLineStyle,          false, voltaLineStyle,          resetVoltaLineStyle  },</a>
<a name="ln106">      { Sid::ottavaLineStyle,         false, ottavaLineStyle,         resetOttavaLineStyle },</a>
<a name="ln107">      { Sid::pedalLineStyle,          false, pedalLineStyle,          resetPedalLineStyle  },</a>
<a name="ln108"> </a>
<a name="ln109">      { Sid::staffUpperBorder,        false, staffUpperBorder,        resetStaffUpperBorder  },</a>
<a name="ln110">      { Sid::staffLowerBorder,        false, staffLowerBorder,        resetStaffLowerBorder  },</a>
<a name="ln111">      { Sid::staffDistance,           false, staffDistance,           resetStaffDistance     },</a>
<a name="ln112">      { Sid::akkoladeDistance,        false, akkoladeDistance,        resetAkkoladeDistance  },</a>
<a name="ln113">      { Sid::minSystemDistance,       false, minSystemDistance,       resetMinSystemDistance },</a>
<a name="ln114">      { Sid::maxSystemDistance,       false, maxSystemDistance,       resetMaxSystemDistance },</a>
<a name="ln115"> </a>
<a name="ln116">      { Sid::lyricsPlacement,         false, lyricsPlacement,         resetLyricsPlacement         },</a>
<a name="ln117">      { Sid::lyricsPosAbove,          false, lyricsPosAbove,          resetLyricsPosAbove          },</a>
<a name="ln118">      { Sid::lyricsPosBelow,          false, lyricsPosBelow,          resetLyricsPosBelow          },</a>
<a name="ln119">      { Sid::lyricsMinTopDistance,    false, lyricsMinTopDistance,    resetLyricsMinTopDistance    },</a>
<a name="ln120">      { Sid::lyricsMinBottomDistance, false, lyricsMinBottomDistance, resetLyricsMinBottomDistance },</a>
<a name="ln121">      { Sid::lyricsMinDistance,       false, lyricsMinDistance,       resetLyricsMinDistance       },</a>
<a name="ln122">      { Sid::lyricsLineHeight,        true,  lyricsLineHeight,        resetLyricsLineHeight        },</a>
<a name="ln123">      { Sid::lyricsDashMinLength,     false, lyricsDashMinLength,     resetLyricsDashMinLength     },</a>
<a name="ln124">      { Sid::lyricsDashMaxLength,     false, lyricsDashMaxLength,     resetLyricsDashMaxLength     },</a>
<a name="ln125">      { Sid::lyricsDashMaxDistance,   false, lyricsDashMaxDistance,   resetLyricsDashMaxDistance   },</a>
<a name="ln126">      { Sid::lyricsDashForce,         false, lyricsDashForce,         resetLyricsDashForce         },</a>
<a name="ln127">      { Sid::lyricsAlignVerseNumber,  false, lyricsAlignVerseNumber,  resetLyricsAlignVerseNumber  },</a>
<a name="ln128">      { Sid::lyricsLineThickness,     false, lyricsLineThickness,     resetLyricsLineThickness     },</a>
<a name="ln129">      { Sid::lyricsMelismaPad,        false, lyricsMelismaPad,        resetLyricsMelismaPad        },</a>
<a name="ln130">      { Sid::lyricsMelismaAlign,      false, lyricsMelismaAlign,      resetLyricsMelismaAlign      },</a>
<a name="ln131">      { Sid::lyricsDashPad,           false, lyricsDashPad,           resetLyricsDashPad           },</a>
<a name="ln132">      { Sid::lyricsDashLineThickness, false, lyricsDashLineThickness, resetLyricsDashLineThickness },</a>
<a name="ln133">      { Sid::lyricsDashYposRatio,     false, lyricsDashYposRatio,     resetLyricsDashYposRatio     },</a>
<a name="ln134"> </a>
<a name="ln135">      { Sid::systemFrameDistance,     false, systemFrameDistance,     resetSystemFrameDistance },</a>
<a name="ln136">      { Sid::frameSystemDistance,     false, frameSystemDistance,     resetFrameSystemDistance },</a>
<a name="ln137">      { Sid::minMeasureWidth,         false, minMeasureWidth_2,       resetMinMeasureWidth },</a>
<a name="ln138">      { Sid::measureSpacing,          false, measureSpacing,          resetMeasureSpacing },</a>
<a name="ln139"> </a>
<a name="ln140">      { Sid::barWidth,                false, barWidth,                resetBarWidth },</a>
<a name="ln141">      { Sid::endBarWidth,             false, endBarWidth,             resetEndBarWidth },</a>
<a name="ln142">      { Sid::endBarDistance,          false, endBarDistance,          resetEndBarDistance },</a>
<a name="ln143">      { Sid::doubleBarWidth,          false, doubleBarWidth,          resetDoubleBarWidth },</a>
<a name="ln144">      { Sid::doubleBarDistance,       false, doubleBarDistance,       resetDoubleBarDistance },</a>
<a name="ln145">      { Sid::repeatBarlineDotSeparation, false, repeatBarlineDotSeparation, resetRepeatBarlineDotSeparation },</a>
<a name="ln146"> </a>
<a name="ln147">      { Sid::barGraceDistance,        false, barGraceDistance,        resetBarGraceDistance },</a>
<a name="ln148">      { Sid::chordExtensionMag,       false, extensionMag,            resetExtensionMag },</a>
<a name="ln149">      { Sid::chordExtensionAdjust,    false, extensionAdjust,         resetExtensionAdjust },</a>
<a name="ln150">      { Sid::chordModifierMag,        false, modifierMag,             resetModifierMag },</a>
<a name="ln151">      { Sid::chordModifierAdjust,     false, modifierAdjust,          resetModifierAdjust },</a>
<a name="ln152">      { Sid::useStandardNoteNames,    false, useStandardNoteNames,    0 },</a>
<a name="ln153">      { Sid::useGermanNoteNames,      false, useGermanNoteNames,      0 },</a>
<a name="ln154">      { Sid::useFullGermanNoteNames,  false, useFullGermanNoteNames,  0 },</a>
<a name="ln155">      { Sid::useSolfeggioNoteNames,   false, useSolfeggioNoteNames,   0 },</a>
<a name="ln156">      { Sid::useFrenchNoteNames,      false, useFrenchNoteNames,      0 },</a>
<a name="ln157">      { Sid::automaticCapitalization, false, automaticCapitalization, 0 },</a>
<a name="ln158"> </a>
<a name="ln159">      { Sid::lowerCaseMinorChords,    false, lowerCaseMinorChords,    0 },</a>
<a name="ln160"> </a>
<a name="ln161">      { Sid::lowerCaseBassNotes,      false, lowerCaseBassNotes,      0 },</a>
<a name="ln162">      { Sid::allCapsNoteNames,        false, allCapsNoteNames,        0 },</a>
<a name="ln163">      { Sid::concertPitch,            false, concertPitch,            0 },</a>
<a name="ln164">      { Sid::createMultiMeasureRests, false, multiMeasureRests,       0 },</a>
<a name="ln165">      { Sid::minEmptyMeasures,        false, minEmptyMeasures,        0 },</a>
<a name="ln166">      { Sid::minMMRestWidth,          false, minMeasureWidth,         resetMinMMRestWidth },</a>
<a name="ln167">      { Sid::hideEmptyStaves,         false, hideEmptyStaves,         0 },</a>
<a name="ln168">      { Sid::dontHideStavesInFirstSystem, false, dontHideStavesInFirstSystem,             0 },</a>
<a name="ln169">      { Sid::hideInstrumentNameIfOneInstrument, false, hideInstrumentNameIfOneInstrument, 0 },</a>
<a name="ln170">      { Sid::accidentalNoteDistance,  false, accidentalNoteDistance,  0 },</a>
<a name="ln171">      { Sid::accidentalDistance,      false, accidentalDistance,      0 },</a>
<a name="ln172"> </a>
<a name="ln173">      { Sid::minNoteDistance,         false, minNoteDistance,         resetMinNoteDistance },</a>
<a name="ln174">      { Sid::barNoteDistance,         false, barNoteDistance,         resetBarNoteDistance },</a>
<a name="ln175">      { Sid::barAccidentalDistance,   false, barAccidentalDistance,   resetBarAccidentalDistance },</a>
<a name="ln176">      { Sid::multiMeasureRestMargin,  false, multiMeasureRestMargin,  resetMultiMeasureRestMargin },</a>
<a name="ln177">      { Sid::noteBarDistance,         false, noteBarDistance,         resetNoteBarDistance },</a>
<a name="ln178">      { Sid::clefLeftMargin,          false, clefLeftMargin,          resetClefLeftMargin },</a>
<a name="ln179">      { Sid::keysigLeftMargin,        false, keysigLeftMargin,        resetKeysigLeftMargin },</a>
<a name="ln180">      { Sid::timesigLeftMargin,       false, timesigLeftMargin,       resetTimesigLeftMargin },</a>
<a name="ln181">      { Sid::midClefKeyRightMargin,   false, clefKeyRightMargin,      resetClefKeyRightMargin },</a>
<a name="ln182">      { Sid::clefKeyDistance,         false, clefKeyDistance,         resetClefKeyDistance },</a>
<a name="ln183">      { Sid::clefTimesigDistance,     false, clefTimesigDistance,     resetClefTimesigDistance },</a>
<a name="ln184">      { Sid::keyTimesigDistance,      false, keyTimesigDistance,      resetKeyTimesigDistance },</a>
<a name="ln185">      { Sid::keyBarlineDistance,      false, keyBarlineDistance,      resetKeyBarlineDistance },</a>
<a name="ln186">      { Sid::systemHeaderDistance,    false, systemHeaderDistance,    resetSystemHeaderDistance },</a>
<a name="ln187">      { Sid::systemHeaderTimeSigDistance,    false, systemHeaderTimeSigDistance,    resetSystemHeaderTimeSigDistance },</a>
<a name="ln188"> </a>
<a name="ln189">      { Sid::clefBarlineDistance,     false, clefBarlineDistance,     resetClefBarlineDistance },</a>
<a name="ln190">      { Sid::timesigBarlineDistance,  false, timesigBarlineDistance,  resetTimesigBarlineDistance },</a>
<a name="ln191">      { Sid::staffLineWidth,          false, staffLineWidth,          resetStaffLineWidth },</a>
<a name="ln192">      { Sid::beamWidth,               false, beamWidth,               0 },</a>
<a name="ln193">      { Sid::beamMinLen,              false, beamMinLen,              0 },</a>
<a name="ln194"> </a>
<a name="ln195">      { Sid::hairpinPlacement,        false, hairpinPlacement,        resetHairpinPlacement },</a>
<a name="ln196">      { Sid::hairpinPosAbove,         false, hairpinPosAbove,         resetHairpinPosAbove },</a>
<a name="ln197">      { Sid::hairpinPosBelow,         false, hairpinPosBelow,         resetHairpinPosBelow },</a>
<a name="ln198">      { Sid::hairpinLineWidth,        false, hairpinLineWidth,        resetHairpinLineWidth },</a>
<a name="ln199">      { Sid::hairpinHeight,           false, hairpinHeight,           resetHairpinHeight },</a>
<a name="ln200">      { Sid::hairpinContHeight,       false, hairpinContinueHeight,   resetHairpinContinueHeight },</a>
<a name="ln201"> </a>
<a name="ln202">      { Sid::dotNoteDistance,         false, noteDotDistance,         0 },</a>
<a name="ln203">      { Sid::dotDotDistance,          false, dotDotDistance,          0 },</a>
<a name="ln204">      { Sid::stemWidth,               false, stemWidth,               0 },</a>
<a name="ln205">      { Sid::ledgerLineWidth,         false, ledgerLineWidth,         0 },</a>
<a name="ln206">      { Sid::ledgerLineLength,        false, ledgerLineLength,        0 },</a>
<a name="ln207">      { Sid::shortStemProgression,    false, shortStemProgression,    0 },</a>
<a name="ln208">      { Sid::shortestStem,            false, shortestStem,            0 },</a>
<a name="ln209">      { Sid::ArpeggioNoteDistance,    false, arpeggioNoteDistance,    0 },</a>
<a name="ln210">      { Sid::ArpeggioLineWidth,       false, arpeggioLineWidth,       0 },</a>
<a name="ln211">      { Sid::ArpeggioHookLen,         false, arpeggioHookLen,         0 },</a>
<a name="ln212">      { Sid::ArpeggioHiddenInStdIfTab,false, arpeggioHiddenInStdIfTab,0 },</a>
<a name="ln213">      { Sid::SlurEndWidth,            false, slurEndLineWidth,        resetSlurEndLineWidth    },</a>
<a name="ln214">      { Sid::SlurMidWidth,            false, slurMidLineWidth,        resetSlurMidLineWidth    },</a>
<a name="ln215">      { Sid::SlurDottedWidth,         false, slurDottedLineWidth,     resetSlurDottedLineWidth },</a>
<a name="ln216">      { Sid::SlurMinDistance,         false, slurMinDistance,         resetSlurMinDistance     },</a>
<a name="ln217">      { Sid::MinTieLength,            false, minTieLength,            resetMinTieLength        },</a>
<a name="ln218">      { Sid::bracketWidth,            false, bracketWidth,            0 },</a>
<a name="ln219">      { Sid::bracketDistance,         false, bracketDistance,         0 },</a>
<a name="ln220">      { Sid::akkoladeWidth,           false, akkoladeWidth,           0 },</a>
<a name="ln221">      { Sid::akkoladeBarDistance,     false, akkoladeBarDistance,     0 },</a>
<a name="ln222">      { Sid::dividerLeft,             false, dividerLeft,             0 },</a>
<a name="ln223">      { Sid::dividerLeftX,            false, dividerLeftX,            0 },</a>
<a name="ln224">      { Sid::dividerLeftY,            false, dividerLeftY,            0 },</a>
<a name="ln225">      { Sid::dividerRight,            false, dividerRight,            0 },</a>
<a name="ln226">      { Sid::dividerRightX,           false, dividerRightX,           0 },</a>
<a name="ln227">      { Sid::dividerRightY,           false, dividerRightY,           0 },</a>
<a name="ln228">      { Sid::propertyDistanceHead,    false, propertyDistanceHead,    resetPropertyDistanceHead },</a>
<a name="ln229">      { Sid::propertyDistanceStem,    false, propertyDistanceStem,    resetPropertyDistanceStem },</a>
<a name="ln230">      { Sid::propertyDistance,        false, propertyDistance,        resetPropertyDistance },</a>
<a name="ln231">      { Sid::voltaPosAbove,           false, voltaPosAbove,           resetVoltaPosAbove },</a>
<a name="ln232">      { Sid::voltaHook,               false, voltaHook,               resetVoltaHook },</a>
<a name="ln233">      { Sid::voltaLineWidth,          false, voltaLineWidth,          resetVoltaLineWidth  },</a>
<a name="ln234"> </a>
<a name="ln235">      { Sid::ottavaPosAbove,          false, ottavaPosAbove,          resetOttavaPosAbove  },</a>
<a name="ln236">      { Sid::ottavaPosBelow,          false, ottavaPosBelow,          resetOttavaPosBelow  },</a>
<a name="ln237">      { Sid::ottavaHookAbove,         false, ottavaHookAbove,         resetOttavaHookAbove },</a>
<a name="ln238">      { Sid::ottavaHookBelow,         false, ottavaHookBelow,         resetOttavaHookBelow },</a>
<a name="ln239">      { Sid::ottavaLineWidth,         false, ottavaLineWidth,         resetOttavaLineWidth },</a>
<a name="ln240"> </a>
<a name="ln241">      { Sid::pedalPlacement,          false, pedalLinePlacement,      resetPedalLinePlacement  },</a>
<a name="ln242">      { Sid::pedalPosAbove,           false, pedalLinePosAbove,       resetPedalLinePosAbove   },</a>
<a name="ln243">      { Sid::pedalPosBelow,           false, pedalLinePosBelow,       resetPedalLinePosBelow   },</a>
<a name="ln244">      { Sid::pedalLineWidth,          false, pedalLineWidth,          resetPedalLineWidth  },</a>
<a name="ln245"> </a>
<a name="ln246">      { Sid::trillPlacement,          false, trillLinePlacement,      resetTrillLinePlacement  },</a>
<a name="ln247">      { Sid::trillPosAbove,           false, trillLinePosAbove,       resetTrillLinePosAbove   },</a>
<a name="ln248">      { Sid::trillPosBelow,           false, trillLinePosBelow,       resetTrillLinePosBelow   },</a>
<a name="ln249"> </a>
<a name="ln250">      { Sid::vibratoPlacement,        false, vibratoLinePlacement,      resetVibratoLinePlacement  },</a>
<a name="ln251">      { Sid::vibratoPosAbove,         false, vibratoLinePosAbove,       resetVibratoLinePosAbove   },</a>
<a name="ln252">      { Sid::vibratoPosBelow,         false, vibratoLinePosBelow,       resetVibratoLinePosBelow   },</a>
<a name="ln253"> </a>
<a name="ln254">      { Sid::harmonyFretDist,         false, harmonyFretDist,         0 },</a>
<a name="ln255">      { Sid::minHarmonyDistance,      false, minHarmonyDistance,      0 },</a>
<a name="ln256">      { Sid::maxHarmonyBarDistance,   false, maxHarmonyBarDistance,   0 },</a>
<a name="ln257"> </a>
<a name="ln258">      { Sid::tupletVHeadDistance,     false, tupletVHeadDistance,     resetTupletVHeadDistance      },</a>
<a name="ln259">      { Sid::tupletVStemDistance,     false, tupletVStemDistance,     resetTupletVStemDistance      },</a>
<a name="ln260">      { Sid::tupletStemLeftDistance,  false, tupletStemLeftDistance,  resetTupletStemLeftDistance   },</a>
<a name="ln261">      { Sid::tupletStemRightDistance, false, tupletStemRightDistance, resetTupletStemRightDistance  },</a>
<a name="ln262">      { Sid::tupletNoteLeftDistance,  false, tupletNoteLeftDistance,  resetTupletNoteLeftDistance   },</a>
<a name="ln263">      { Sid::tupletNoteRightDistance, false, tupletNoteRightDistance, resetTupletNoteRightDistance  },</a>
<a name="ln264">      { Sid::tupletBracketWidth,      false, tupletBracketWidth,      resetTupletBracketWidth       },</a>
<a name="ln265">      { Sid::tupletBracketHookHeight, false, tupletBracketHookHeight, resetTupletBracketHookHeight  },</a>
<a name="ln266">      { Sid::tupletDirection,         false, tupletDirection,         resetTupletDirection          },</a>
<a name="ln267">      { Sid::tupletNumberType,        false, tupletNumberType,        resetTupletNumberType         },</a>
<a name="ln268">      { Sid::tupletBracketType,       false, tupletBracketType,       resetTupletBracketType        },</a>
<a name="ln269">      { Sid::tupletMaxSlope,          false, tupletMaxSlope,          resetTupletMaxSlope           },</a>
<a name="ln270">      { Sid::tupletOufOfStaff,        false, tupletOutOfStaff,        0                             },</a>
<a name="ln271"> </a>
<a name="ln272">      { Sid::repeatBarTips,            false, showRepeatBarTips,            resetShowRepeatBarTips },</a>
<a name="ln273">      { Sid::startBarlineSingle,       false, showStartBarlineSingle,       resetShowStartBarlineSingle },</a>
<a name="ln274">      { Sid::startBarlineMultiple,     false, showStartBarlineMultiple,     resetShowStartBarlineMultiple },</a>
<a name="ln275">      { Sid::dividerLeftSym,           false, dividerLeftSym,               0 },</a>
<a name="ln276">      { Sid::dividerRightSym,          false, dividerRightSym,              0 },</a>
<a name="ln277"> </a>
<a name="ln278">      { Sid::showMeasureNumber,        false, showMeasureNumber,            0 },</a>
<a name="ln279">      { Sid::showMeasureNumberOne,     false, showFirstMeasureNumber,       0 },</a>
<a name="ln280">      { Sid::measureNumberInterval,    false, intervalMeasureNumber,        0 },</a>
<a name="ln281">      { Sid::measureNumberSystem,      false, showEverySystemMeasureNumber, 0 },</a>
<a name="ln282">      { Sid::measureNumberAllStaffs,   false, showAllStaffsMeasureNumber,   0 },</a>
<a name="ln283"> </a>
<a name="ln284">      { Sid::beamDistance,             true,  beamDistance,                 0 },</a>
<a name="ln285">      { Sid::beamNoSlope,              false, beamNoSlope,                  0 },</a>
<a name="ln286">      { Sid::graceNoteMag,             true,  graceNoteSize,                resetGraceNoteSize  },</a>
<a name="ln287">      { Sid::smallStaffMag,            true,  smallStaffSize,               resetSmallStaffSize },</a>
<a name="ln288">      { Sid::smallNoteMag,             true,  smallNoteSize,                resetSmallNoteSize  },</a>
<a name="ln289">      { Sid::smallClefMag,             true,  smallClefSize,                resetSmallClefSize  },</a>
<a name="ln290">      { Sid::lastSystemFillLimit,      true,  lastSystemFillThreshold,      resetLastSystemFillThreshold },</a>
<a name="ln291">      { Sid::genClef,                  false, genClef,                      0 },</a>
<a name="ln292">      { Sid::genKeysig,                false, genKeysig,                    0 },</a>
<a name="ln293">      { Sid::genCourtesyTimesig,       false, genCourtesyTimesig,           0 },</a>
<a name="ln294">      { Sid::genCourtesyKeysig,        false, genCourtesyKeysig,            0 },</a>
<a name="ln295">      { Sid::genCourtesyClef,          false, genCourtesyClef,              0 },</a>
<a name="ln296">      { Sid::swingRatio,               false, swingBox,                     0 },</a>
<a name="ln297">      { Sid::chordsXmlFile,            false, chordsXmlFile,                0 },</a>
<a name="ln298">      { Sid::dotMag,                   true,  dotMag,                       0 },</a>
<a name="ln299">      { Sid::articulationMag,          true,  articulationMag,              resetArticulationMag },</a>
<a name="ln300">      { Sid::shortenStem,              false, shortenStem,                  0 },</a>
<a name="ln301">      { Sid::showHeader,               false, showHeader,                   0 },</a>
<a name="ln302">      { Sid::headerFirstPage,          false, showHeaderFirstPage,          0 },</a>
<a name="ln303">      { Sid::headerOddEven,            false, headerOddEven,                0 },</a>
<a name="ln304">      { Sid::evenHeaderL,              false, evenHeaderL,                  0 },</a>
<a name="ln305">      { Sid::evenHeaderC,              false, evenHeaderC,                  0 },</a>
<a name="ln306">      { Sid::evenHeaderR,              false, evenHeaderR,                  0 },</a>
<a name="ln307">      { Sid::oddHeaderL,               false, oddHeaderL,                   0 },</a>
<a name="ln308">      { Sid::oddHeaderC,               false, oddHeaderC,                   0 },</a>
<a name="ln309">      { Sid::oddHeaderR,               false, oddHeaderR,                   0 },</a>
<a name="ln310">      { Sid::showFooter,               false, showFooter,                   0 },</a>
<a name="ln311">      { Sid::footerFirstPage,          false, showFooterFirstPage,          0 },</a>
<a name="ln312">      { Sid::footerOddEven,            false, footerOddEven,                0 },</a>
<a name="ln313">      { Sid::evenFooterL,              false, evenFooterL,                  0 },</a>
<a name="ln314">      { Sid::evenFooterC,              false, evenFooterC,                  0 },</a>
<a name="ln315">      { Sid::evenFooterR,              false, evenFooterR,                  0 },</a>
<a name="ln316">      { Sid::oddFooterL,               false, oddFooterL,                   0 },</a>
<a name="ln317">      { Sid::oddFooterC,               false, oddFooterC,                   0 },</a>
<a name="ln318">      { Sid::oddFooterR,               false, oddFooterR,                   0 },</a>
<a name="ln319"> </a>
<a name="ln320">      { Sid::ottavaNumbersOnly,        false, ottavaNumbersOnly,            resetOttavaNumbersOnly },</a>
<a name="ln321">      { Sid::capoPosition,             false, capoPosition,                 0 },</a>
<a name="ln322">      { Sid::fretNumMag,               true,  fretNumMag,                   0 },</a>
<a name="ln323">      { Sid::fretNumPos,               false, fretNumGroup,                 0 },</a>
<a name="ln324">      { Sid::fretY,                    false, fretY,                        0 },</a>
<a name="ln325">      { Sid::barreLineWidth,           false, barreLineWidth,               0 },</a>
<a name="ln326">      { Sid::fretMag,                  false, fretMag,                      0 },</a>
<a name="ln327">      { Sid::fretDotSize,              false, fretDotSize,                  0 },</a>
<a name="ln328">      { Sid::fretStringSpacing,        false, fretStringSpacing,            0 },</a>
<a name="ln329">      { Sid::fretFretSpacing,          false, fretFretSpacing,              0 },</a>
<a name="ln330">      { Sid::scaleBarlines,            false, scaleBarlines,                resetScaleBarlines},</a>
<a name="ln331">      { Sid::crossMeasureValues,       false, crossMeasureValues,           0 },</a>
<a name="ln332"> </a>
<a name="ln333">      { Sid::MusicalSymbolFont,        false, musicalSymbolFont,            0 },</a>
<a name="ln334">      { Sid::MusicalTextFont,          false, musicalTextFont,              0 },</a>
<a name="ln335">      { Sid::autoplaceHairpinDynamicsDistance, false, autoplaceHairpinDynamicsDistance, resetAutoplaceHairpinDynamicsDistance },</a>
<a name="ln336"> </a>
<a name="ln337">      { Sid::dynamicsPlacement,       false, dynamicsPlacement,          resetDynamicsPlacement },</a>
<a name="ln338">      { Sid::dynamicsPosAbove,        false, dynamicsPosAbove,           resetDynamicsPosAbove },</a>
<a name="ln339">      { Sid::dynamicsPosBelow,        false, dynamicsPosBelow,           resetDynamicsPosBelow },</a>
<a name="ln340">      { Sid::dynamicsMinDistance,     false, dynamicsMinDistance,        resetDynamicsMinDistance },</a>
<a name="ln341"> </a>
<a name="ln342">      { Sid::tempoPlacement,          false, tempoTextPlacement,          resetTempoTextPlacement },</a>
<a name="ln343">      { Sid::tempoPosAbove,           false, tempoTextPosAbove,           resetTempoTextPosAbove },</a>
<a name="ln344">      { Sid::tempoPosBelow,           false, tempoTextPosBelow,           resetTempoTextPosBelow },</a>
<a name="ln345">      { Sid::tempoMinDistance,        false, tempoTextMinDistance,        resetTempoTextMinDistance },</a>
<a name="ln346"> </a>
<a name="ln347">      { Sid::rehearsalMarkPlacement,   false, rehearsalMarkPlacement,     resetRehearsalMarkPlacement },</a>
<a name="ln348">      { Sid::rehearsalMarkPosAbove,    false, rehearsalMarkPosAbove,      resetRehearsalMarkPosAbove },</a>
<a name="ln349">      { Sid::rehearsalMarkPosBelow,    false, rehearsalMarkPosBelow,      resetRehearsalMarkPosBelow },</a>
<a name="ln350">      { Sid::rehearsalMarkMinDistance, false, rehearsalMarkMinDistance,   resetRehearsalMarkMinDistance },</a>
<a name="ln351"> </a>
<a name="ln352">      { Sid::autoplaceVerticalAlignRange, false, autoplaceVerticalAlignRange, resetAutoplaceVerticalAlignRange },</a>
<a name="ln353">      { Sid::minVerticalDistance,         false, minVerticalDistance,         resetMinVerticalDistance },</a>
<a name="ln354">      { Sid::textLinePlacement,           false, textLinePlacement,           resetTextLinePlacement },</a>
<a name="ln355">      { Sid::textLinePosAbove,            false, textLinePosAbove,            resetTextLinePosAbove },</a>
<a name="ln356">      { Sid::textLinePosBelow,            false, textLinePosBelow,            resetTextLinePosBelow },</a>
<a name="ln357"> </a>
<a name="ln358">      { Sid::fermataPosAbove,         false, fermataPosAbove,       resetFermataPosAbove    },</a>
<a name="ln359">      { Sid::fermataPosBelow,         false, fermataPosBelow,       resetFermataPosBelow    },</a>
<a name="ln360">      { Sid::fermataMinDistance,      false, fermataMinDistance,    resetFermataMinDistance },</a>
<a name="ln361"> </a>
<a name="ln362">      { Sid::staffTextPlacement,      false, staffTextPlacement,    resetStaffTextPlacement   },</a>
<a name="ln363">      { Sid::staffTextPosAbove,       false, staffTextPosAbove,     resetStaffTextPosAbove    },</a>
<a name="ln364">      { Sid::staffTextPosBelow,       false, staffTextPosBelow,     resetStaffTextPosBelow    },</a>
<a name="ln365">      { Sid::staffTextMinDistance,    false, staffTextMinDistance,  resetStaffTextMinDistance },</a>
<a name="ln366"> </a>
<a name="ln367">      { Sid::bendLineWidth,     false, bendLineWidth,     resetBendLineWidth     },</a>
<a name="ln368">      { Sid::bendArrowWidth,    false, bendArrowWidth,    resetBendArrowWidth    },</a>
<a name="ln369">      };</a>
<a name="ln370"> </a>
<a name="ln371">      for (QComboBox* cb : std::vector&lt;QComboBox*&gt; {</a>
<a name="ln372">            lyricsPlacement, textLinePlacement, hairpinPlacement, pedalLinePlacement,</a>
<a name="ln373">            trillLinePlacement, vibratoLinePlacement, dynamicsPlacement,</a>
<a name="ln374">            tempoTextPlacement, staffTextPlacement, rehearsalMarkPlacement</a>
<a name="ln375">            }) {</a>
<a name="ln376">            cb-&gt;clear();</a>
<a name="ln377">            cb-&gt;addItem(tr(&quot;Above&quot;), int(Placement::ABOVE));</a>
<a name="ln378">            cb-&gt;addItem(tr(&quot;Below&quot;), int(Placement::BELOW));</a>
<a name="ln379">            }</a>
<a name="ln380"> </a>
<a name="ln381">      autoplaceVerticalAlignRange-&gt;clear();</a>
<a name="ln382">      autoplaceVerticalAlignRange-&gt;addItem(tr(&quot;Segment&quot;), int(VerticalAlignRange::SEGMENT));</a>
<a name="ln383">      autoplaceVerticalAlignRange-&gt;addItem(tr(&quot;Measure&quot;), int(VerticalAlignRange::MEASURE));</a>
<a name="ln384">      autoplaceVerticalAlignRange-&gt;addItem(tr(&quot;System&quot;),  int(VerticalAlignRange::SYSTEM));</a>
<a name="ln385"> </a>
<a name="ln386">      tupletNumberType-&gt;clear();</a>
<a name="ln387">      tupletNumberType-&gt;addItem(tr(&quot;Number&quot;), int(TupletNumberType::SHOW_NUMBER));</a>
<a name="ln388">      tupletNumberType-&gt;addItem(tr(&quot;Ratio&quot;), int(TupletNumberType::SHOW_RELATION));</a>
<a name="ln389">      tupletNumberType-&gt;addItem(tr(&quot;None&quot;, &quot;no tuplet number type&quot;), int(TupletNumberType::NO_TEXT));</a>
<a name="ln390"> </a>
<a name="ln391">      tupletBracketType-&gt;clear();</a>
<a name="ln392">      tupletBracketType-&gt;addItem(tr(&quot;Automatic&quot;), int(TupletBracketType::AUTO_BRACKET));</a>
<a name="ln393">      tupletBracketType-&gt;addItem(tr(&quot;Bracket&quot;), int(TupletBracketType::SHOW_BRACKET));</a>
<a name="ln394">      tupletBracketType-&gt;addItem(tr(&quot;None&quot;, &quot;no tuplet bracket type&quot;), int(TupletBracketType::SHOW_NO_BRACKET));</a>
<a name="ln395"> </a>
<a name="ln396">      pageList-&gt;setCurrentRow(0);</a>
<a name="ln397">      accidentalsGroup-&gt;setVisible(false); // disable, not yet implemented</a>
<a name="ln398"> </a>
<a name="ln399">      musicalSymbolFont-&gt;clear();</a>
<a name="ln400">      int idx = 0;</a>
<a name="ln401">      for (auto i : ScoreFont::scoreFonts()) {</a>
<a name="ln402">            musicalSymbolFont-&gt;addItem(i.name(), i.name());</a>
<a name="ln403">            ++idx;</a>
<a name="ln404">            }</a>
<a name="ln405"> </a>
<a name="ln406">      static const SymId ids[] = {</a>
<a name="ln407">            SymId::systemDivider, SymId::systemDividerLong, SymId::systemDividerExtraLong</a>
<a name="ln408">            };</a>
<a name="ln409">      for (SymId id : ids) {</a>
<a name="ln410">            const QString&amp; un = Sym::id2userName(id);</a>
<a name="ln411">            const char* n  = Sym::id2name(id);</a>
<a name="ln412">            dividerLeftSym-&gt;addItem(un,  QVariant(QString(n)));</a>
<a name="ln413">            dividerRightSym-&gt;addItem(un, QVariant(QString(n)));</a>
<a name="ln414">            }</a>
<a name="ln415"> </a>
<a name="ln416">      // figured bass init</a>
<a name="ln417">      QList&lt;QString&gt; fbFontNames = FiguredBass::fontNames();</a>
<a name="ln418">      for (const QString&amp; family: fbFontNames)</a>
<a name="ln419">            comboFBFont-&gt;addItem(family);</a>
<a name="ln420">      comboFBFont-&gt;setCurrentIndex(0);</a>
<a name="ln421">      connect(comboFBFont, SIGNAL(currentIndexChanged(int)), SLOT(on_comboFBFont_currentIndexChanged(int)));</a>
<a name="ln422"> </a>
<a name="ln423">      // keep in sync with implementation in Page::replaceTextMacros (page.cpp)</a>
<a name="ln424">      // jumping thru hoops here to make the job of translators easier, yet have a nice display</a>
<a name="ln425">      QString toolTipHeaderFooter</a>
<a name="ln426">            = QString(&quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;&lt;b&gt;&quot;)</a>
<a name="ln427">            + tr(&quot;Special symbols in header/footer&quot;)</a>
<a name="ln428">            + QString(&quot;&lt;/b&gt;&lt;/p&gt;&quot;)</a>
<a name="ln429">            + QString(&quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;$p&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln430">            + tr(&quot;Page number, except on first page&quot;)</a>
<a name="ln431">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$N&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln432">            + tr(&quot;Page number, if there is more than one page&quot;)</a>
<a name="ln433">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$P&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln434">            + tr(&quot;Page number, on all pages&quot;)</a>
<a name="ln435">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$n&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln436">            + tr(&quot;Number of pages&quot;)</a>
<a name="ln437">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$f&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln438">            + tr(&quot;File name&quot;)</a>
<a name="ln439">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$F&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln440">            + tr(&quot;File path+name&quot;)</a>
<a name="ln441">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$i&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln442">            + tr(&quot;Part name, except on first page&quot;)</a>
<a name="ln443">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$I&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln444">            + tr(&quot;Part name, on all pages&quot;)</a>
<a name="ln445">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$d&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln446">            + tr(&quot;Current date&quot;)</a>
<a name="ln447">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$D&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln448">            + tr(&quot;Creation date&quot;)</a>
<a name="ln449">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$m&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln450">            + tr(&quot;Last modification time&quot;)</a>
<a name="ln451">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$M&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln452">            + tr(&quot;Last modification date&quot;)</a>
<a name="ln453">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$C&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln454">            + tr(&quot;Copyright, on first page only&quot;)</a>
<a name="ln455">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$c&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln456">            + tr(&quot;Copyright, on all pages&quot;)</a>
<a name="ln457">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$$&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln458">            + tr(&quot;The $ sign itself&quot;)</a>
<a name="ln459">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;$:tag:&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;&lt;i&gt;&quot;)</a>
<a name="ln460">            + tr(&quot;Metadata tag, see below&quot;)</a>
<a name="ln461">            + QString(&quot;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&quot;)</a>
<a name="ln462">            + tr(&quot;Available metadata tags and their current values&quot;)</a>
<a name="ln463">            + QString(&quot;&lt;br /&gt;&quot;)</a>
<a name="ln464">            + tr(&quot;(in File &gt; Score Properties…):&quot;)</a>
<a name="ln465">            + QString(&quot;&lt;/p&gt;&lt;table&gt;&quot;);</a>
<a name="ln466">      // show all tags for current score/part, see also Score::init()</a>
<a name="ln467">      if (!cs-&gt;isMaster()) {</a>
<a name="ln468">            QMapIterator&lt;QString, QString&gt; j(cs-&gt;masterScore()-&gt;metaTags());</a>
<a name="ln469">            while (j.hasNext()) {</a>
<a name="ln470">                  j.next();</a>
<a name="ln471">                  toolTipHeaderFooter += QString(&quot;&lt;tr&gt;&lt;td&gt;%1&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;%2&lt;/td&gt;&lt;/tr&gt;&quot;).arg(j.key()).arg(j.value());</a>
<a name="ln472">                  }</a>
<a name="ln473">            }</a>
<a name="ln474">      QMapIterator&lt;QString, QString&gt; i(cs-&gt;metaTags());</a>
<a name="ln475">      while (i.hasNext()) {</a>
<a name="ln476">            i.next();</a>
<a name="ln477">            toolTipHeaderFooter += QString(&quot;&lt;tr&gt;&lt;td&gt;%1&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;td&gt;%2&lt;/td&gt;&lt;/tr&gt;&quot;).arg(i.key()).arg(i.value());</a>
<a name="ln478">            }</a>
<a name="ln479">      toolTipHeaderFooter += QString(&quot;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;&quot;);</a>
<a name="ln480">      showHeader-&gt;setToolTip(toolTipHeaderFooter);</a>
<a name="ln481">      showFooter-&gt;setToolTip(toolTipHeaderFooter);</a>
<a name="ln482"> </a>
<a name="ln483">      connect(buttonBox,           SIGNAL(clicked(QAbstractButton*)), SLOT(buttonClicked(QAbstractButton*)));</a>
<a name="ln484">      connect(headerOddEven,       SIGNAL(toggled(bool)),             SLOT(toggleHeaderOddEven(bool)));</a>
<a name="ln485">      connect(footerOddEven,       SIGNAL(toggled(bool)),             SLOT(toggleFooterOddEven(bool)));</a>
<a name="ln486">      connect(chordDescriptionFileButton, SIGNAL(clicked()),          SLOT(selectChordDescriptionFile()));</a>
<a name="ln487">      connect(chordsStandard,      SIGNAL(toggled(bool)),             SLOT(setChordStyle(bool)));</a>
<a name="ln488">      connect(chordsJazz,          SIGNAL(toggled(bool)),             SLOT(setChordStyle(bool)));</a>
<a name="ln489">      connect(chordsCustom,        SIGNAL(toggled(bool)),             SLOT(setChordStyle(bool)));</a>
<a name="ln490">      connect(chordsXmlFile,       SIGNAL(toggled(bool)),             SLOT(setChordStyle(bool)));</a>
<a name="ln491">      connect(chordDescriptionFile,&amp;QLineEdit::editingFinished,       [=]() { setChordStyle(true); });</a>
<a name="ln492">      //chordDescriptionFile-&gt;setEnabled(false);</a>
<a name="ln493"> </a>
<a name="ln494">      chordDescriptionFileButton-&gt;setIcon(*icons[int(Icons::fileOpen_ICON)]);</a>
<a name="ln495"> </a>
<a name="ln496">      connect(swingOff,            SIGNAL(toggled(bool)),             SLOT(setSwingParams(bool)));</a>
<a name="ln497">      connect(swingEighth,         SIGNAL(toggled(bool)),             SLOT(setSwingParams(bool)));</a>
<a name="ln498">      connect(swingSixteenth,      SIGNAL(toggled(bool)),             SLOT(setSwingParams(bool)));</a>
<a name="ln499"> </a>
<a name="ln500">      connect(concertPitch,        SIGNAL(toggled(bool)),             SLOT(concertPitchToggled(bool)));</a>
<a name="ln501">      connect(hideEmptyStaves,     SIGNAL(clicked(bool)), dontHideStavesInFirstSystem, SLOT(setEnabled(bool)));</a>
<a name="ln502">      connect(lyricsDashMinLength, SIGNAL(valueChanged(double)),      SLOT(lyricsDashMinLengthValueChanged(double)));</a>
<a name="ln503">      connect(lyricsDashMaxLength, SIGNAL(valueChanged(double)),      SLOT(lyricsDashMaxLengthValueChanged(double)));</a>
<a name="ln504">      connect(minSystemDistance,   SIGNAL(valueChanged(double)),      SLOT(systemMinDistanceValueChanged(double)));</a>
<a name="ln505">      connect(maxSystemDistance,   SIGNAL(valueChanged(double)),      SLOT(systemMaxDistanceValueChanged(double)));</a>
<a name="ln506"> </a>
<a name="ln507">      QSignalMapper* mapper  = new QSignalMapper(this);     // reset style signals</a>
<a name="ln508">      QSignalMapper* mapper2 = new QSignalMapper(this);     // value change signals</a>
<a name="ln509"> </a>
<a name="ln510">      for (const StyleWidget&amp; sw : styleWidgets) {</a>
<a name="ln511">            const char* type = MStyle::valueType(sw.idx);</a>
<a name="ln512"> </a>
<a name="ln513">            if (!strcmp(&quot;Direction&quot;, type)) {</a>
<a name="ln514">                  QComboBox* cb = qobject_cast&lt;QComboBox*&gt;(sw.widget);</a>
<a name="ln515">                  fillComboBoxDirection(cb);</a>
<a name="ln516">                  }</a>
<a name="ln517">            if (sw.reset) {</a>
<a name="ln518">                  sw.reset-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln519">                  connect(sw.reset, SIGNAL(clicked()), mapper, SLOT(map()));</a>
<a name="ln520">                  mapper-&gt;setMapping(sw.reset, int(sw.idx));</a>
<a name="ln521">                  }</a>
<a name="ln522">            if (qobject_cast&lt;QSpinBox*&gt;(sw.widget))</a>
<a name="ln523">                  connect(qobject_cast&lt;QSpinBox*&gt;(sw.widget), SIGNAL(valueChanged(int)), mapper2, SLOT(map()));</a>
<a name="ln524">            else if (qobject_cast&lt;QDoubleSpinBox*&gt;(sw.widget))</a>
<a name="ln525">                  connect(qobject_cast&lt;QDoubleSpinBox*&gt;(sw.widget), SIGNAL(valueChanged(double)), mapper2, SLOT(map()));</a>
<a name="ln526">            else if (qobject_cast&lt;QFontComboBox*&gt;(sw.widget))</a>
<a name="ln527">                  connect(qobject_cast&lt;QFontComboBox*&gt;(sw.widget), SIGNAL(currentFontChanged(const QFont&amp;)), mapper2, SLOT(map()));</a>
<a name="ln528">            else if (qobject_cast&lt;QComboBox*&gt;(sw.widget))</a>
<a name="ln529">                  connect(qobject_cast&lt;QComboBox*&gt;(sw.widget), SIGNAL(currentIndexChanged(int)), mapper2, SLOT(map()));</a>
<a name="ln530">            else if (qobject_cast&lt;QRadioButton*&gt;(sw.widget))</a>
<a name="ln531">                  connect(qobject_cast&lt;QRadioButton*&gt;(sw.widget), SIGNAL(toggled(bool)), mapper2, SLOT(map()));</a>
<a name="ln532">            else if (qobject_cast&lt;QPushButton*&gt;(sw.widget))</a>
<a name="ln533">                  connect(qobject_cast&lt;QPushButton*&gt;(sw.widget), SIGNAL(toggled(bool)), mapper2, SLOT(map()));</a>
<a name="ln534">            else if (qobject_cast&lt;QToolButton*&gt;(sw.widget))</a>
<a name="ln535">                  connect(qobject_cast&lt;QToolButton*&gt;(sw.widget), SIGNAL(toggled(bool)), mapper2, SLOT(map()));</a>
<a name="ln536">            else if (qobject_cast&lt;QGroupBox*&gt;(sw.widget))</a>
<a name="ln537">                  connect(qobject_cast&lt;QGroupBox*&gt;(sw.widget), SIGNAL(toggled(bool)), mapper2, SLOT(map()));</a>
<a name="ln538">            else if (qobject_cast&lt;QCheckBox*&gt;(sw.widget))</a>
<a name="ln539">                  connect(qobject_cast&lt;QCheckBox*&gt;(sw.widget), SIGNAL(stateChanged(int)), mapper2, SLOT(map()));</a>
<a name="ln540">            else if (qobject_cast&lt;QTextEdit*&gt;(sw.widget))</a>
<a name="ln541">                  connect(qobject_cast&lt;QTextEdit*&gt;(sw.widget), SIGNAL(textChanged()), mapper2, SLOT(map()));</a>
<a name="ln542">            else if (qobject_cast&lt;QButtonGroup*&gt;(sw.widget))</a>
<a name="ln543">                  connect(qobject_cast&lt;QButtonGroup*&gt;(sw.widget), SIGNAL(buttonClicked(int)), mapper2, SLOT(map()));</a>
<a name="ln544">            else if (qobject_cast&lt;AlignSelect*&gt;(sw.widget))</a>
<a name="ln545">                  connect(qobject_cast&lt;AlignSelect*&gt;(sw.widget), SIGNAL(alignChanged(Align)), mapper2, SLOT(map()));</a>
<a name="ln546">            else if (qobject_cast&lt;OffsetSelect*&gt;(sw.widget))</a>
<a name="ln547">                  connect(qobject_cast&lt;OffsetSelect*&gt;(sw.widget), SIGNAL(offsetChanged(const QPointF&amp;)), mapper2, SLOT(map()));</a>
<a name="ln548">            else if (FontStyleSelect* fontStyle = qobject_cast&lt;FontStyleSelect*&gt;(sw.widget))</a>
<a name="ln549">                  connect(fontStyle, &amp;FontStyleSelect::fontStyleChanged, mapper2, QOverload&lt;&gt;::of(&amp;QSignalMapper::map));</a>
<a name="ln550">            else {</a>
<a name="ln551">                  qFatal(&quot;unhandled gui widget type %s valueType %s&quot;,</a>
<a name="ln552">                     sw.widget-&gt;metaObject()-&gt;className(),</a>
<a name="ln553">                     MStyle::valueName(sw.idx)</a>
<a name="ln554">                  );</a>
<a name="ln555">                  }</a>
<a name="ln556"> </a>
<a name="ln557">            mapper2-&gt;setMapping(sw.widget, int(sw.idx));</a>
<a name="ln558">            }</a>
<a name="ln559"> </a>
<a name="ln560">      connect(mapper,  SIGNAL(mapped(int)), SLOT(resetStyleValue(int)));</a>
<a name="ln561">      connect(mapper2, SIGNAL(mapped(int)), SLOT(valueChanged(int)));</a>
<a name="ln562">      textStyles-&gt;clear();</a>
<a name="ln563">      for (auto ss : allTextStyles()) {</a>
<a name="ln564">            QListWidgetItem* item = new QListWidgetItem(s-&gt;getTextStyleUserName(ss));</a>
<a name="ln565">            item-&gt;setData(Qt::UserRole, int(ss));</a>
<a name="ln566">            textStyles-&gt;addItem(item);</a>
<a name="ln567">            }</a>
<a name="ln568"> </a>
<a name="ln569">      textStyleFrameType-&gt;clear();</a>
<a name="ln570">      textStyleFrameType-&gt;addItem(tr(&quot;None&quot;, &quot;no frame for text&quot;), int(FrameType::NO_FRAME));</a>
<a name="ln571">      textStyleFrameType-&gt;addItem(tr(&quot;Rectangle&quot;), int(FrameType::SQUARE));</a>
<a name="ln572">      textStyleFrameType-&gt;addItem(tr(&quot;Circle&quot;), int(FrameType::CIRCLE));</a>
<a name="ln573"> </a>
<a name="ln574">      resetTextStyleName-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln575">      connect(resetTextStyleName, &amp;QToolButton::clicked, [=](){ resetUserStyleName(); });</a>
<a name="ln576">      connect(styleName, &amp;QLineEdit::textEdited, [=]() { editUserStyleName(); });</a>
<a name="ln577">      connect(styleName, &amp;QLineEdit::editingFinished, [=]() { endEditUserStyleName(); });</a>
<a name="ln578"> </a>
<a name="ln579">      // font face</a>
<a name="ln580">      resetTextStyleFontFace-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln581">      connect(resetTextStyleFontFace, &amp;QToolButton::clicked,</a>
<a name="ln582">         [=](){ resetTextStyle(Pid::FONT_FACE); }</a>
<a name="ln583">         );</a>
<a name="ln584">      connect(textStyleFontFace, &amp;QFontComboBox::currentFontChanged,</a>
<a name="ln585">         [=](){ textStyleValueChanged(Pid::FONT_FACE, QVariant(textStyleFontFace-&gt;currentFont().family())); }</a>
<a name="ln586">         );</a>
<a name="ln587"> </a>
<a name="ln588">      // font size</a>
<a name="ln589">      resetTextStyleFontSize-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln590">      connect(resetTextStyleFontSize, &amp;QToolButton::clicked,</a>
<a name="ln591">         [=](){ resetTextStyle(Pid::FONT_SIZE); }</a>
<a name="ln592">         );</a>
<a name="ln593">      connect(textStyleFontSize, QOverload&lt;double&gt;::of(&amp;QDoubleSpinBox::valueChanged),</a>
<a name="ln594">         [=](){ textStyleValueChanged(Pid::FONT_SIZE, QVariant(textStyleFontSize-&gt;value())); }</a>
<a name="ln595">         );</a>
<a name="ln596"> </a>
<a name="ln597">      // font style</a>
<a name="ln598">      resetTextStyleFontStyle-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln599">      connect(resetTextStyleFontStyle, &amp;QToolButton::clicked,</a>
<a name="ln600">         [=](){ resetTextStyle(Pid::FONT_STYLE); }</a>
<a name="ln601">         );</a>
<a name="ln602">      connect(textStyleFontStyle, &amp;FontStyleSelect::fontStyleChanged,</a>
<a name="ln603">         [=](){ textStyleValueChanged(Pid::FONT_STYLE, QVariant(int(textStyleFontStyle-&gt;fontStyle()))); }</a>
<a name="ln604">         );</a>
<a name="ln605"> </a>
<a name="ln606">      // align</a>
<a name="ln607">      resetTextStyleAlign-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln608">      connect(resetTextStyleAlign, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::ALIGN); });</a>
<a name="ln609">      connect(textStyleAlign, &amp;AlignSelect::alignChanged,</a>
<a name="ln610">         [=](){ textStyleValueChanged(Pid::ALIGN, QVariant::fromValue(textStyleAlign-&gt;align())); }</a>
<a name="ln611">         );</a>
<a name="ln612"> </a>
<a name="ln613">      // offset</a>
<a name="ln614">      resetTextStyleOffset-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln615">      connect(resetTextStyleOffset, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::OFFSET); });</a>
<a name="ln616">      connect(textStyleOffset, &amp;OffsetSelect::offsetChanged,</a>
<a name="ln617">         [=](){ textStyleValueChanged(Pid::OFFSET, QVariant(textStyleOffset-&gt;offset())); }</a>
<a name="ln618">         );</a>
<a name="ln619"> </a>
<a name="ln620">      // spatium dependent</a>
<a name="ln621">      resetTextStyleSpatiumDependent-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln622">      connect(resetTextStyleSpatiumDependent, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::SIZE_SPATIUM_DEPENDENT); });</a>
<a name="ln623">      connect(textStyleSpatiumDependent, &amp;QCheckBox::toggled,</a>
<a name="ln624">         [=](){ textStyleValueChanged(Pid::SIZE_SPATIUM_DEPENDENT, textStyleSpatiumDependent-&gt;isChecked()); }</a>
<a name="ln625">         );</a>
<a name="ln626"> </a>
<a name="ln627">      resetTextStyleFrameType-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln628">      connect(resetTextStyleFrameType, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::FRAME_TYPE); });</a>
<a name="ln629">      connect(textStyleFrameType, QOverload&lt;int&gt;::of(&amp;QComboBox::currentIndexChanged),</a>
<a name="ln630">         [=](){ textStyleValueChanged(Pid::FRAME_TYPE, textStyleFrameType-&gt;currentIndex()); }</a>
<a name="ln631">         );</a>
<a name="ln632"> </a>
<a name="ln633">      resetTextStyleFramePadding-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln634">      connect(resetTextStyleFramePadding, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::FRAME_PADDING); });</a>
<a name="ln635">      connect(textStyleFramePadding, QOverload&lt;double&gt;::of(&amp;QDoubleSpinBox::valueChanged),</a>
<a name="ln636">         [=](){ textStyleValueChanged(Pid::FRAME_PADDING, textStyleFramePadding-&gt;value()); }</a>
<a name="ln637">         );</a>
<a name="ln638"> </a>
<a name="ln639">      resetTextStyleFrameBorder-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln640">      connect(resetTextStyleFrameBorder, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::FRAME_WIDTH); });</a>
<a name="ln641">      connect(textStyleFrameBorder, QOverload&lt;double&gt;::of(&amp;QDoubleSpinBox::valueChanged),</a>
<a name="ln642">         [=](){ textStyleValueChanged(Pid::FRAME_WIDTH, textStyleFrameBorder-&gt;value()); }</a>
<a name="ln643">         );</a>
<a name="ln644"> </a>
<a name="ln645">      resetTextStyleFrameBorderRadius-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln646">      connect(resetTextStyleFrameBorderRadius, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::FRAME_ROUND); });</a>
<a name="ln647">      connect(textStyleFrameBorderRadius, QOverload&lt;double&gt;::of(&amp;QDoubleSpinBox::valueChanged),</a>
<a name="ln648">         [=](){ textStyleValueChanged(Pid::FRAME_ROUND, textStyleFrameBorderRadius-&gt;value()); }</a>
<a name="ln649">         );</a>
<a name="ln650"> </a>
<a name="ln651">      resetTextStyleFrameForeground-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln652">      connect(resetTextStyleFrameForeground, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::FRAME_FG_COLOR); });</a>
<a name="ln653">      connect(textStyleFrameForeground, &amp;Awl::ColorLabel::colorChanged,</a>
<a name="ln654">         [=](){ textStyleValueChanged(Pid::FRAME_FG_COLOR, textStyleFrameForeground-&gt;color()); }</a>
<a name="ln655">         );</a>
<a name="ln656"> </a>
<a name="ln657">      resetTextStyleFrameBackground-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln658">      connect(resetTextStyleFrameBackground, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::FRAME_BG_COLOR); });</a>
<a name="ln659">      connect(textStyleFrameBackground, &amp;Awl::ColorLabel::colorChanged,</a>
<a name="ln660">         [=](){ textStyleValueChanged(Pid::FRAME_BG_COLOR, textStyleFrameBackground-&gt;color()); }</a>
<a name="ln661">         );</a>
<a name="ln662"> </a>
<a name="ln663">      resetTextStyleColor-&gt;setIcon(*icons[int(Icons::reset_ICON)]);</a>
<a name="ln664">      connect(resetTextStyleColor, &amp;QToolButton::clicked, [=](){ resetTextStyle(Pid::COLOR); });</a>
<a name="ln665">      connect(textStyleColor, &amp;Awl::ColorLabel::colorChanged,</a>
<a name="ln666">         [=](){ textStyleValueChanged(Pid::COLOR, textStyleColor-&gt;color()); }</a>
<a name="ln667">         );</a>
<a name="ln668"> </a>
<a name="ln669">      connect(textStyles, SIGNAL(currentRowChanged(int)), SLOT(textStyleChanged(int)));</a>
<a name="ln670">      textStyles-&gt;setCurrentRow(0);</a>
<a name="ln671"> </a>
<a name="ln672">      QRect scr = QGuiApplication::primaryScreen()-&gt;availableGeometry();</a>
<a name="ln673">      QRect dlg = this-&gt;frameGeometry();</a>
<a name="ln674">      isTooBig  = dlg.width() &gt; scr.width() || dlg.height() &gt; scr.height();</a>
<a name="ln675">      if (isTooBig)</a>
<a name="ln676">            this-&gt;setMinimumSize(scr.width() / 2, scr.height() / 2);</a>
<a name="ln677">      hasShown = false;</a>
<a name="ln678">      MuseScore::restoreGeometry(this);</a>
<a name="ln679">      }</a>
<a name="ln680"> </a>
<a name="ln681">//---------------------------------------------------------</a>
<a name="ln682">//   PAGES</a>
<a name="ln683">///   This is a map of element type to pages, to allow the creation of a 'Style...'</a>
<a name="ln684">///   menu for every possible element on the score.</a>
<a name="ln685">//---------------------------------------------------------</a>
<a name="ln686"> </a>
<a name="ln687">const std::map&lt;ElementType, EditStylePage&gt; EditStyle::PAGES = {</a>
<a name="ln688">      { ElementType::SCORE,               &amp;EditStyle::PageScore    },</a>
<a name="ln689">      { ElementType::PAGE,                &amp;EditStyle::PagePage     },</a>
<a name="ln690">      { ElementType::MEASURE_NUMBER,      &amp;EditStyle::PageSizes    },</a>
<a name="ln691">      { ElementType::BRACKET,             &amp;EditStyle::PageSystem   },</a>
<a name="ln692">      { ElementType::BRACKET_ITEM,        &amp;EditStyle::PageSystem   },</a>
<a name="ln693">      { ElementType::CLEF,                &amp;EditStyle::PageClefs    },</a>
<a name="ln694">      { ElementType::KEYSIG,              &amp;EditStyle::PageAccidentals },</a>
<a name="ln695">      { ElementType::MEASURE,             &amp;EditStyle::PageMeasure  },</a>
<a name="ln696">      { ElementType::REST,                &amp;EditStyle::PageMeasure  },</a>
<a name="ln697">      { ElementType::BAR_LINE,            &amp;EditStyle::PageBarlines },</a>
<a name="ln698">      { ElementType::NOTE,                &amp;EditStyle::PageNotes    },</a>
<a name="ln699">      { ElementType::CHORD,               &amp;EditStyle::PageNotes    },</a>
<a name="ln700">      { ElementType::ACCIDENTAL,          &amp;EditStyle::PageNotes    },</a>
<a name="ln701">      { ElementType::STEM,                &amp;EditStyle::PageNotes    },</a>
<a name="ln702">      { ElementType::STEM_SLASH,          &amp;EditStyle::PageNotes    },</a>
<a name="ln703">      { ElementType::LEDGER_LINE,         &amp;EditStyle::PageNotes    },</a>
<a name="ln704">      { ElementType::BEAM,                &amp;EditStyle::PageBeams    },</a>
<a name="ln705">      { ElementType::TUPLET,              &amp;EditStyle::PageTuplets  },</a>
<a name="ln706">      { ElementType::ARPEGGIO,            &amp;EditStyle::PageArpeggios },</a>
<a name="ln707">      { ElementType::SLUR,                &amp;EditStyle::PageSlursTies },</a>
<a name="ln708">      { ElementType::SLUR_SEGMENT,        &amp;EditStyle::PageSlursTies },</a>
<a name="ln709">      { ElementType::TIE,                 &amp;EditStyle::PageSlursTies },</a>
<a name="ln710">      { ElementType::TIE_SEGMENT,         &amp;EditStyle::PageSlursTies },</a>
<a name="ln711">      { ElementType::HAIRPIN,             &amp;EditStyle::PageHairpins },</a>
<a name="ln712">      { ElementType::HAIRPIN_SEGMENT,     &amp;EditStyle::PageHairpins },</a>
<a name="ln713">      { ElementType::VOLTA,               &amp;EditStyle::PageVolta    },</a>
<a name="ln714">      { ElementType::VOLTA_SEGMENT,       &amp;EditStyle::PageVolta    },</a>
<a name="ln715">      { ElementType::OTTAVA,              &amp;EditStyle::PageOttava   },</a>
<a name="ln716">      { ElementType::OTTAVA_SEGMENT,      &amp;EditStyle::PageOttava   },</a>
<a name="ln717">      { ElementType::PEDAL,               &amp;EditStyle::PagePedal    },</a>
<a name="ln718">      { ElementType::PEDAL_SEGMENT,       &amp;EditStyle::PagePedal    },</a>
<a name="ln719">      { ElementType::TRILL,               &amp;EditStyle::PageTrill    },</a>
<a name="ln720">      { ElementType::TRILL_SEGMENT,       &amp;EditStyle::PageTrill    },</a>
<a name="ln721">      { ElementType::VIBRATO,             &amp;EditStyle::PageVibrato  },</a>
<a name="ln722">      { ElementType::VIBRATO_SEGMENT,     &amp;EditStyle::PageVibrato  },</a>
<a name="ln723">      { ElementType::BEND,                &amp;EditStyle::PageBend     },</a>
<a name="ln724">      { ElementType::TEXTLINE,            &amp;EditStyle::PageTextLine },</a>
<a name="ln725">      { ElementType::TEXTLINE_SEGMENT,    &amp;EditStyle::PageTextLine },</a>
<a name="ln726">      { ElementType::ARTICULATION,        &amp;EditStyle::PageArticulationsOrnaments },</a>
<a name="ln727">      { ElementType::FERMATA,             &amp;EditStyle::PageFermatas },</a>
<a name="ln728">      { ElementType::STAFF_TEXT,          &amp;EditStyle::PageStaffText },</a>
<a name="ln729">      { ElementType::TEMPO_TEXT,          &amp;EditStyle::PageTempoText },</a>
<a name="ln730">      { ElementType::LYRICS,              &amp;EditStyle::PageLyrics   },</a>
<a name="ln731">      { ElementType::LYRICSLINE,          &amp;EditStyle::PageLyrics   },</a>
<a name="ln732">      { ElementType::LYRICSLINE_SEGMENT,  &amp;EditStyle::PageLyrics   },</a>
<a name="ln733">      { ElementType::DYNAMIC,             &amp;EditStyle::PageDynamics },</a>
<a name="ln734">      { ElementType::REHEARSAL_MARK,      &amp;EditStyle::PageRehearsalMarks },</a>
<a name="ln735">      { ElementType::FIGURED_BASS,        &amp;EditStyle::PageFiguredBass },</a>
<a name="ln736">      { ElementType::HARMONY,             &amp;EditStyle::PageChordSymbols },</a>
<a name="ln737">      { ElementType::FRET_DIAGRAM,        &amp;EditStyle::PageFretboardDiagrams },</a>
<a name="ln738">      };</a>
<a name="ln739"> </a>
<a name="ln740">//---------------------------------------------------------</a>
<a name="ln741">//   gotoElement</a>
<a name="ln742">///   switch the page to the one related to the element `e`</a>
<a name="ln743">//---------------------------------------------------------</a>
<a name="ln744"> </a>
<a name="ln745">void EditStyle::gotoElement(Element* e)</a>
<a name="ln746">      {</a>
<a name="ln747">      const ElementType&amp; t = e-&gt;type();</a>
<a name="ln748">      const auto i = PAGES.find(t);</a>
<a name="ln749">      if (i != PAGES.cend()) {</a>
<a name="ln750">            QWidget* page = this-&gt;*(i-&gt;second);</a>
<a name="ln751">            setPage(pageStack-&gt;indexOf(page));</a>
<a name="ln752">            }</a>
<a name="ln753">      }</a>
<a name="ln754"> </a>
<a name="ln755">//---------------------------------------------------------</a>
<a name="ln756">//   elementHasPage</a>
<a name="ln757">///   check if an element has a style page related to it</a>
<a name="ln758">//---------------------------------------------------------</a>
<a name="ln759"> </a>
<a name="ln760">bool EditStyle::elementHasPage(Element* e)</a>
<a name="ln761">      {</a>
<a name="ln762">      const ElementType&amp; t = e-&gt;type();</a>
<a name="ln763">      const auto i = PAGES.find(t);</a>
<a name="ln764">      return i != PAGES.cend();</a>
<a name="ln765">      }</a>
<a name="ln766"> </a>
<a name="ln767">//---------------------------------------------------------</a>
<a name="ln768">//   showEvent</a>
<a name="ln769">//---------------------------------------------------------</a>
<a name="ln770"> </a>
<a name="ln771">void EditStyle::showEvent(QShowEvent* ev)</a>
<a name="ln772">      {</a>
<a name="ln773">      if (!hasShown &amp;&amp; isTooBig) {</a>
<a name="ln774">            // Add scroll bars to pageStack - this cannot be in the constructor</a>
<a name="ln775">            // or the Header, Footer text input boxes size themselves too large.</a>
<a name="ln776">            QScrollArea* scrollArea = new QScrollArea(splitter);</a>
<a name="ln777">            scrollArea-&gt;setWidget(pageStack);</a>
<a name="ln778">            hasShown = true; // so that it only happens once</a>
<a name="ln779">            }</a>
<a name="ln780">      setValues();</a>
<a name="ln781">      pageList-&gt;setFocus();</a>
<a name="ln782">      cs-&gt;startCmd();</a>
<a name="ln783">      buttonApplyToAllParts-&gt;setEnabled(!cs-&gt;isMaster());</a>
<a name="ln784">      QWidget::showEvent(ev);</a>
<a name="ln785">      }</a>
<a name="ln786"> </a>
<a name="ln787">//---------------------------------------------------------</a>
<a name="ln788">//   hideEvent</a>
<a name="ln789">//---------------------------------------------------------</a>
<a name="ln790"> </a>
<a name="ln791">void EditStyle::hideEvent(QHideEvent* ev)</a>
<a name="ln792">      {</a>
<a name="ln793">      MuseScore::saveGeometry(this);</a>
<a name="ln794">      QWidget::hideEvent(ev);</a>
<a name="ln795">      }</a>
<a name="ln796"> </a>
<a name="ln797">//---------------------------------------------------------</a>
<a name="ln798">//   buttonClicked</a>
<a name="ln799">//---------------------------------------------------------</a>
<a name="ln800"> </a>
<a name="ln801">void EditStyle::buttonClicked(QAbstractButton* b)</a>
<a name="ln802">      {</a>
<a name="ln803">      switch (buttonBox-&gt;standardButton(b)) {</a>
<a name="ln804">            case QDialogButtonBox::Ok:</a>
<a name="ln805">                  done(1);</a>
<a name="ln806">                  cs-&gt;endCmd();</a>
<a name="ln807">                  break;</a>
<a name="ln808">            case QDialogButtonBox::Cancel:</a>
<a name="ln809">                  done(0);</a>
<a name="ln810">                  cs-&gt;endCmd(true);</a>
<a name="ln811">                  break;</a>
<a name="ln812">            case QDialogButtonBox::NoButton:</a>
<a name="ln813">            default:</a>
<a name="ln814">                  if (b == buttonApplyToAllParts)</a>
<a name="ln815">                        applyToAllParts();</a>
<a name="ln816">                  break;</a>
<a name="ln817">            }</a>
<a name="ln818">      }</a>
<a name="ln819"> </a>
<a name="ln820">//---------------------------------------------------------</a>
<a name="ln821">//   On comboFBFont currentIndex changed</a>
<a name="ln822">//---------------------------------------------------------</a>
<a name="ln823"> </a>
<a name="ln824">void EditStyle::on_comboFBFont_currentIndexChanged(int index)</a>
<a name="ln825">      {</a>
<a name="ln826">      qreal size, lineHeight;</a>
<a name="ln827"> </a>
<a name="ln828">      if (FiguredBass::fontData(index, 0, 0, &amp;size, &amp;lineHeight)) {</a>
<a name="ln829">            doubleSpinFBSize-&gt;setValue(size);</a>
<a name="ln830">            spinFBLineHeight-&gt;setValue(static_cast&lt;int&gt;(lineHeight * 100.0));</a>
<a name="ln831">            }</a>
<a name="ln832">      }</a>
<a name="ln833"> </a>
<a name="ln834">//---------------------------------------------------------</a>
<a name="ln835">//    On buttonTogglePagelist clicked</a>
<a name="ln836">//---------------------------------------------------------</a>
<a name="ln837"> </a>
<a name="ln838">void EditStyle::on_buttonTogglePagelist_clicked()</a>
<a name="ln839">      {</a>
<a name="ln840">      bool isVis = !pageList-&gt;isVisible(); // toggle it</a>
<a name="ln841"> </a>
<a name="ln842">      pageList-&gt;setVisible(isVis);</a>
<a name="ln843">      buttonTogglePagelist-&gt;setIcon(QIcon(*icons[int(isVis ? Icons::goNext_ICON</a>
<a name="ln844">                                                           : Icons::goPrevious_ICON)]));</a>
<a name="ln845">      }</a>
<a name="ln846">//---------------------------------------------------------</a>
<a name="ln847">//   applyToAllParts</a>
<a name="ln848">//---------------------------------------------------------</a>
<a name="ln849"> </a>
<a name="ln850">void EditStyle::applyToAllParts()</a>
<a name="ln851">      {</a>
<a name="ln852">      for (Excerpt* e : cs-&gt;masterScore()-&gt;excerpts()) {</a>
<a name="ln853">            e-&gt;partScore()-&gt;undo(new ChangeStyle(e-&gt;partScore(), cs-&gt;style()));</a>
<a name="ln854">            e-&gt;partScore()-&gt;update();</a>
<a name="ln855">            }</a>
<a name="ln856">      }</a>
<a name="ln857"> </a>
<a name="ln858">//---------------------------------------------------------</a>
<a name="ln859">//   unhandledType</a>
<a name="ln860">//---------------------------------------------------------</a>
<a name="ln861"> </a>
<a name="ln862">static void unhandledType(const StyleWidget* sw)</a>
<a name="ln863">      {</a>
<a name="ln864">      const char* type = MStyle::valueType(sw-&gt;idx);</a>
<a name="ln865">      qFatal(&quot;%s &lt;%s&gt;: widget: %s\n&quot;, type, MStyle::valueName(sw-&gt;idx), sw-&gt;widget-&gt;metaObject()-&gt;className());</a>
<a name="ln866">      }</a>
<a name="ln867"> </a>
<a name="ln868">//---------------------------------------------------------</a>
<a name="ln869">//   getValue</a>
<a name="ln870">//    return current gui value</a>
<a name="ln871">//---------------------------------------------------------</a>
<a name="ln872"> </a>
<a name="ln873">QVariant EditStyle::getValue(Sid idx)</a>
<a name="ln874">      {</a>
<a name="ln875">      const StyleWidget&amp; sw = styleWidget(idx);</a>
<a name="ln876">      const char* type = MStyle::valueType(sw.idx);</a>
<a name="ln877"> </a>
<a name="ln878">      if (!strcmp(&quot;Ms::Spatium&quot;, type)) {</a>
<a name="ln879">            QDoubleSpinBox* sb = qobject_cast&lt;QDoubleSpinBox*&gt;(sw.widget);</a>
<a name="ln880">            return QVariant(Spatium(sb-&gt;value() * (sw.showPercent ? 0.01 : 1.0)));</a>
<a name="ln881">            }</a>
<a name="ln882">      else if (!strcmp(&quot;double&quot;, type)) {</a>
<a name="ln883">            QVariant v = sw.widget-&gt;property(&quot;value&quot;);</a>
<a name="ln884">            if (!v.isValid())</a>
<a name="ln885">                  unhandledType(&amp;sw);</a>
<a name="ln886">            if (sw.showPercent)</a>
<a name="ln887">                  v = v.toDouble() * 0.01;</a>
<a name="ln888">            return v;</a>
<a name="ln889">            }</a>
<a name="ln890">      else if (!strcmp(&quot;bool&quot;, type)) {</a>
<a name="ln891">            QVariant v = sw.widget-&gt;property(&quot;checked&quot;);</a>
<a name="ln892">            if (!v.isValid())</a>
<a name="ln893">                  unhandledType(&amp;sw);</a>
<a name="ln894">            return v;</a>
<a name="ln895">            }</a>
<a name="ln896">      else if (!strcmp(&quot;int&quot;, type)) {</a>
<a name="ln897">            if (qobject_cast&lt;QComboBox*&gt;(sw.widget)) {</a>
<a name="ln898">                  QComboBox* cb = qobject_cast&lt;QComboBox*&gt;(sw.widget);</a>
<a name="ln899">                  return cb-&gt;currentData().toInt();</a>
<a name="ln900">                  }</a>
<a name="ln901">            else if (qobject_cast&lt;QSpinBox*&gt;(sw.widget))</a>
<a name="ln902">                  return qobject_cast&lt;QSpinBox*&gt;(sw.widget)-&gt;value() / (sw.showPercent ? 100 : 1);</a>
<a name="ln903">            else if (qobject_cast&lt;QButtonGroup*&gt;(sw.widget)) {</a>
<a name="ln904">                  QButtonGroup* bg = qobject_cast&lt;QButtonGroup*&gt;(sw.widget);</a>
<a name="ln905">                  return bg-&gt;checkedId();</a>
<a name="ln906">                  }</a>
<a name="ln907">            else if (FontStyleSelect* fontStyle = qobject_cast&lt;FontStyleSelect*&gt;(sw.widget))</a>
<a name="ln908">                  return int(fontStyle-&gt;fontStyle());</a>
<a name="ln909">            else</a>
<a name="ln910">                  qFatal(&quot;unhandled int&quot;);</a>
<a name="ln911">            }</a>
<a name="ln912">      else if (!strcmp(&quot;QString&quot;, type)) {</a>
<a name="ln913">            if (qobject_cast&lt;QFontComboBox*&gt;(sw.widget))</a>
<a name="ln914">                  return static_cast&lt;QFontComboBox*&gt;(sw.widget)-&gt;currentFont().family();</a>
<a name="ln915">            if (qobject_cast&lt;QComboBox*&gt;(sw.widget)) {</a>
<a name="ln916">                  QComboBox* cb = qobject_cast&lt;QComboBox*&gt;(sw.widget);</a>
<a name="ln917">                  return cb-&gt;currentData().toString();</a>
<a name="ln918">                  }</a>
<a name="ln919">            if (qobject_cast&lt;QTextEdit*&gt;(sw.widget)) {</a>
<a name="ln920">                  QTextEdit* te = qobject_cast&lt;QTextEdit*&gt;(sw.widget);</a>
<a name="ln921">                  return te-&gt;toPlainText();</a>
<a name="ln922">                  }</a>
<a name="ln923">            qFatal(&quot;getValue: unhandled widget type %s valueType %s&quot;,</a>
<a name="ln924">               sw.widget-&gt;metaObject()-&gt;className(),</a>
<a name="ln925">               MStyle::valueName(idx));</a>
<a name="ln926"> </a>
<a name="ln927">            }</a>
<a name="ln928">      else if (!strcmp(&quot;QPointF&quot;, type)) {</a>
<a name="ln929">            OffsetSelect* cb = qobject_cast&lt;Ms::OffsetSelect*&gt;(sw.widget);</a>
<a name="ln930">            if (cb)</a>
<a name="ln931">                  return cb-&gt;offset();</a>
<a name="ln932">            else</a>
<a name="ln933">                  qFatal(&quot;unhandled QPointF&quot;);</a>
<a name="ln934">            }</a>
<a name="ln935">      else if (!strcmp(&quot;Ms::Direction&quot;, type)) {</a>
<a name="ln936">            QComboBox* cb = qobject_cast&lt;QComboBox*&gt;(sw.widget);</a>
<a name="ln937">            if (cb)</a>
<a name="ln938">                  return cb-&gt;currentIndex();</a>
<a name="ln939">            else</a>
<a name="ln940">                  qFatal(&quot;unhandled Direction&quot;);</a>
<a name="ln941">            }</a>
<a name="ln942">      else if (!strcmp(&quot;Ms::Align&quot;, type)) {</a>
<a name="ln943">            AlignSelect* as = qobject_cast&lt;Ms::AlignSelect*&gt;(sw.widget);</a>
<a name="ln944">            return QVariant::fromValue(as-&gt;align());</a>
<a name="ln945">            }</a>
<a name="ln946">      else {</a>
<a name="ln947">            qFatal(&quot;EditStyle::getValue: unhandled type &lt;%s&gt;&quot;, type);</a>
<a name="ln948">            }</a>
<a name="ln949">      return QVariant();</a>
<a name="ln950">      }</a>
<a name="ln951"> </a>
<a name="ln952">//---------------------------------------------------------</a>
<a name="ln953">//   setValues</a>
<a name="ln954">//---------------------------------------------------------</a>
<a name="ln955"> </a>
<a name="ln956">void EditStyle::setValues()</a>
<a name="ln957">      {</a>
<a name="ln958">      const MStyle&amp; lstyle = cs-&gt;style();</a>
<a name="ln959">      for (const StyleWidget&amp; sw : styleWidgets) {</a>
<a name="ln960">            if (sw.widget)</a>
<a name="ln961">                  sw.widget-&gt;blockSignals(true);</a>
<a name="ln962">            QVariant val = lstyle.value(sw.idx);</a>
<a name="ln963">            const char* type = MStyle::valueType(sw.idx);</a>
<a name="ln964">            if (sw.reset)</a>
<a name="ln965">                  sw.reset-&gt;setEnabled(!lstyle.isDefault(sw.idx));</a>
<a name="ln966"> </a>
<a name="ln967">            if (!strcmp(&quot;Ms::Spatium&quot;, type)) {</a>
<a name="ln968">                  if (sw.showPercent)</a>
<a name="ln969">                        qobject_cast&lt;QSpinBox*&gt;(sw.widget)-&gt;setValue(int(val.value&lt;Spatium&gt;().val() * 100.0));</a>
<a name="ln970">                  else</a>
<a name="ln971">                        sw.widget-&gt;setProperty(&quot;value&quot;, val);</a>
<a name="ln972">                  }</a>
<a name="ln973">            else if (!strcmp(&quot;double&quot;, type)) {</a>
<a name="ln974">                  if (sw.showPercent)</a>
<a name="ln975">                        val = QVariant(val.toDouble() * 100);</a>
<a name="ln976">                  if (!sw.widget-&gt;setProperty(&quot;value&quot;, val))</a>
<a name="ln977">                        unhandledType(&amp;sw);</a>
<a name="ln978">                  }</a>
<a name="ln979">            else if (!strcmp(&quot;bool&quot;, type)) {</a>
<a name="ln980">                  if (!sw.widget-&gt;setProperty(&quot;checked&quot;, val))</a>
<a name="ln981">                        unhandledType(&amp;sw);</a>
<a name="ln982">                  if (sw.idx == Sid::measureNumberSystem &amp;&amp; !val.toBool())</a>
<a name="ln983">                        showIntervalMeasureNumber-&gt;setChecked(true);</a>
<a name="ln984">                  }</a>
<a name="ln985">            else if (!strcmp(&quot;int&quot;, type)) {</a>
<a name="ln986">                  if (qobject_cast&lt;QComboBox*&gt;(sw.widget)) {</a>
<a name="ln987">                        QComboBox* cb = qobject_cast&lt;QComboBox*&gt;(sw.widget);</a>
<a name="ln988">                        cb-&gt;setCurrentIndex(cb-&gt;findData(val));</a>
<a name="ln989">                        }</a>
<a name="ln990">                  else if (qobject_cast&lt;QSpinBox*&gt;(sw.widget)) {</a>
<a name="ln991">                        qobject_cast&lt;QSpinBox*&gt;(sw.widget)-&gt;setValue(val.toInt()</a>
<a name="ln992">                           * (sw.showPercent ? 100 : 1));</a>
<a name="ln993">                        }</a>
<a name="ln994">                  else if (qobject_cast&lt;QButtonGroup*&gt;(sw.widget)) {</a>
<a name="ln995">                        QButtonGroup* bg = qobject_cast&lt;QButtonGroup*&gt;(sw.widget);</a>
<a name="ln996">                        for (auto a : bg-&gt;buttons()) {</a>
<a name="ln997">                              if (bg-&gt;id(a) == val.toInt()) {</a>
<a name="ln998">                                    a-&gt;setChecked(true);</a>
<a name="ln999">                                    break;</a>
<a name="ln1000">                                    }</a>
<a name="ln1001">                              }</a>
<a name="ln1002">                        }</a>
<a name="ln1003">                  else if (FontStyleSelect* fontStyle = qobject_cast&lt;FontStyleSelect*&gt;(sw.widget))</a>
<a name="ln1004">                        fontStyle-&gt;setFontStyle(FontStyle(val.toInt()));</a>
<a name="ln1005">                  else</a>
<a name="ln1006">                        unhandledType(&amp;sw);</a>
<a name="ln1007">                  }</a>
<a name="ln1008">            else if (!strcmp(&quot;QString&quot;, type)) {</a>
<a name="ln1009">                  if (qobject_cast&lt;QFontComboBox*&gt;(sw.widget))</a>
<a name="ln1010">                        static_cast&lt;QFontComboBox*&gt;(sw.widget)-&gt;setCurrentFont(QFont(val.toString()));</a>
<a name="ln1011">                  else if (qobject_cast&lt;QComboBox*&gt;(sw.widget)) {</a>
<a name="ln1012">                        QComboBox* cb = qobject_cast&lt;QComboBox*&gt;(sw.widget);</a>
<a name="ln1013">                        for (int i = 0; i &lt; cb-&gt;count(); ++i) {</a>
<a name="ln1014">                              if (cb-&gt;itemData(i) == val.toString()) {</a>
<a name="ln1015">                                    cb-&gt;setCurrentIndex(i);</a>
<a name="ln1016">                                    break;</a>
<a name="ln1017">                                    }</a>
<a name="ln1018">                              }</a>
<a name="ln1019">                        }</a>
<a name="ln1020">                  else if (qobject_cast&lt;QTextEdit*&gt;(sw.widget))</a>
<a name="ln1021">                        static_cast&lt;QTextEdit*&gt;(sw.widget)-&gt;setPlainText(val.toString());</a>
<a name="ln1022">                  else</a>
<a name="ln1023">                        unhandledType(&amp;sw);</a>
<a name="ln1024">                  }</a>
<a name="ln1025">            else if (!strcmp(&quot;Ms::Direction&quot;, type)) {</a>
<a name="ln1026">                  QComboBox* cb = qobject_cast&lt;QComboBox*&gt;(sw.widget);</a>
<a name="ln1027">                  if (cb)</a>
<a name="ln1028">                        cb-&gt;setCurrentIndex(int(val.value&lt;Direction&gt;()));</a>
<a name="ln1029">                  else</a>
<a name="ln1030">                        unhandledType(&amp;sw);</a>
<a name="ln1031">                  }</a>
<a name="ln1032">            else if (!strcmp(&quot;Ms::Align&quot;, type)) {</a>
<a name="ln1033">                  AlignSelect* as = qobject_cast&lt;Ms::AlignSelect*&gt;(sw.widget);</a>
<a name="ln1034">                  as-&gt;setAlign(val.value&lt;Align&gt;());</a>
<a name="ln1035">                  }</a>
<a name="ln1036">            else if (!strcmp(&quot;QPointF&quot;, type)) {</a>
<a name="ln1037">                  OffsetSelect* as = qobject_cast&lt;Ms::OffsetSelect*&gt;(sw.widget);</a>
<a name="ln1038">                  if (as)</a>
<a name="ln1039">                        as-&gt;setOffset(val.value&lt;QPointF&gt;());</a>
<a name="ln1040">#if 0  // debug</a>
<a name="ln1041">                  else {</a>
<a name="ln1042">                        printf(&quot;no widget for QPointF &lt;%s&gt;&lt;%s&gt;\n&quot;,</a>
<a name="ln1043">                               sw.widget-&gt;metaObject()-&gt;className(), MStyle::valueName(sw.idx));</a>
<a name="ln1044">                        }</a>
<a name="ln1045">#endif</a>
<a name="ln1046">                  }</a>
<a name="ln1047">            else</a>
<a name="ln1048">                  unhandledType(&amp;sw);</a>
<a name="ln1049">            if (sw.widget)</a>
<a name="ln1050">                  sw.widget-&gt;blockSignals(false);</a>
<a name="ln1051">            }</a>
<a name="ln1052"> </a>
<a name="ln1053">      //TODO: convert the rest:</a>
<a name="ln1054"> </a>
<a name="ln1055">      QString unit(lstyle.value(Sid::swingUnit).toString());</a>
<a name="ln1056"> </a>
<a name="ln1057">      if (unit == TDuration(TDuration::DurationType::V_EIGHTH).name()) {</a>
<a name="ln1058">            swingEighth-&gt;setChecked(true);</a>
<a name="ln1059">            swingBox-&gt;setEnabled(true);</a>
<a name="ln1060">            }</a>
<a name="ln1061">      else if (unit == TDuration(TDuration::DurationType::V_16TH).name()) {</a>
<a name="ln1062">            swingSixteenth-&gt;setChecked(true);</a>
<a name="ln1063">            swingBox-&gt;setEnabled(true);</a>
<a name="ln1064">            }</a>
<a name="ln1065">      else if (unit == TDuration(TDuration::DurationType::V_ZERO).name()) {</a>
<a name="ln1066">            swingOff-&gt;setChecked(true);</a>
<a name="ln1067">            swingBox-&gt;setEnabled(false);</a>
<a name="ln1068">            }</a>
<a name="ln1069">      QString s(lstyle.value(Sid::chordDescriptionFile).toString());</a>
<a name="ln1070">      chordDescriptionFile-&gt;setText(s);</a>
<a name="ln1071">      QString cstyle(lstyle.value(Sid::chordStyle).toString());</a>
<a name="ln1072">      if (cstyle == &quot;std&quot;) {</a>
<a name="ln1073">            chordsStandard-&gt;setChecked(true);</a>
<a name="ln1074">            chordDescriptionGroup-&gt;setEnabled(false);</a>
<a name="ln1075">            }</a>
<a name="ln1076">      else if (cstyle == &quot;jazz&quot;) {</a>
<a name="ln1077">            chordsJazz-&gt;setChecked(true);</a>
<a name="ln1078">            chordDescriptionGroup-&gt;setEnabled(false);</a>
<a name="ln1079">            }</a>
<a name="ln1080">      else {</a>
<a name="ln1081">            chordsCustom-&gt;setChecked(true);</a>
<a name="ln1082">            chordDescriptionGroup-&gt;setEnabled(true);</a>
<a name="ln1083">            }</a>
<a name="ln1084">      //formattingGroup-&gt;setEnabled(lstyle.chordList()-&gt;autoAdjust());</a>
<a name="ln1085"> </a>
<a name="ln1086">      dontHideStavesInFirstSystem-&gt;setEnabled(hideEmptyStaves-&gt;isChecked());</a>
<a name="ln1087"> </a>
<a name="ln1088">      // figured bass</a>
<a name="ln1089">      for (int i = 0; i &lt; comboFBFont-&gt;count(); i++)</a>
<a name="ln1090">            if (comboFBFont-&gt;itemText(i) == lstyle.value(Sid::figuredBassFontFamily).toString()) {</a>
<a name="ln1091">                  comboFBFont-&gt;setCurrentIndex(i);</a>
<a name="ln1092">                  break;</a>
<a name="ln1093">            }</a>
<a name="ln1094">      doubleSpinFBSize-&gt;setValue(lstyle.value(Sid::figuredBassFontSize).toDouble());</a>
<a name="ln1095">      doubleSpinFBVertPos-&gt;setValue(lstyle.value(Sid::figuredBassYOffset).toDouble());</a>
<a name="ln1096">      spinFBLineHeight-&gt;setValue(lstyle.value(Sid::figuredBassLineHeight).toDouble() * 100.0);</a>
<a name="ln1097"> </a>
<a name="ln1098">      QString mfont(lstyle.value(Sid::MusicalSymbolFont).toString());</a>
<a name="ln1099">      int idx = 0;</a>
<a name="ln1100">      for (const auto&amp; i : ScoreFont::scoreFonts()) {</a>
<a name="ln1101">            if (i.name().toLower() == mfont.toLower()) {</a>
<a name="ln1102">                  musicalSymbolFont-&gt;setCurrentIndex(idx);</a>
<a name="ln1103">                  break;</a>
<a name="ln1104">                  }</a>
<a name="ln1105">            ++idx;</a>
<a name="ln1106">            }</a>
<a name="ln1107">      musicalTextFont-&gt;blockSignals(true);</a>
<a name="ln1108">      musicalTextFont-&gt;clear();</a>
<a name="ln1109">      // CAUTION: the second element, the itemdata, is a font family name!</a>
<a name="ln1110">      // It's also stored in score file as the musicalTextFont</a>
<a name="ln1111">      musicalTextFont-&gt;addItem(&quot;Bravura Text&quot;, &quot;Bravura Text&quot;);</a>
<a name="ln1112">      musicalTextFont-&gt;addItem(&quot;Emmentaler Text&quot;, &quot;MScore Text&quot;);</a>
<a name="ln1113">      musicalTextFont-&gt;addItem(&quot;Gonville Text&quot;, &quot;Gootville Text&quot;);</a>
<a name="ln1114">      musicalTextFont-&gt;addItem(&quot;MuseJazz Text&quot;, &quot;MuseJazz Text&quot;);</a>
<a name="ln1115">      QString tfont(lstyle.value(Sid::MusicalTextFont).toString());</a>
<a name="ln1116">      idx = musicalTextFont-&gt;findData(tfont);</a>
<a name="ln1117">      musicalTextFont-&gt;setCurrentIndex(idx);</a>
<a name="ln1118">      musicalTextFont-&gt;blockSignals(false);</a>
<a name="ln1119"> </a>
<a name="ln1120">      toggleHeaderOddEven(lstyle.value(Sid::headerOddEven).toBool());</a>
<a name="ln1121">      toggleFooterOddEven(lstyle.value(Sid::footerOddEven).toBool());</a>
<a name="ln1122">      }</a>
<a name="ln1123"> </a>
<a name="ln1124">//---------------------------------------------------------</a>
<a name="ln1125">//   selectChordDescriptionFile</a>
<a name="ln1126">//---------------------------------------------------------</a>
<a name="ln1127"> </a>
<a name="ln1128">void EditStyle::selectChordDescriptionFile()</a>
<a name="ln1129">      {</a>
<a name="ln1130">      QString fn = mscore-&gt;getChordStyleFilename(true);</a>
<a name="ln1131">      if (fn.isEmpty())</a>
<a name="ln1132">            return;</a>
<a name="ln1133">      chordDescriptionFile-&gt;setText(fn);</a>
<a name="ln1134">      setChordStyle(true);</a>
<a name="ln1135">      }</a>
<a name="ln1136"> </a>
<a name="ln1137">//---------------------------------------------------------</a>
<a name="ln1138">//   setSwingParams</a>
<a name="ln1139">//---------------------------------------------------------</a>
<a name="ln1140"> </a>
<a name="ln1141">void EditStyle::setSwingParams(bool checked)</a>
<a name="ln1142">      {</a>
<a name="ln1143">      if (!checked)</a>
<a name="ln1144">            return;</a>
<a name="ln1145">      QVariant val;</a>
<a name="ln1146">      if (swingOff-&gt;isChecked()) {</a>
<a name="ln1147">            val = TDuration(TDuration::DurationType::V_ZERO).name();</a>
<a name="ln1148">            swingBox-&gt;setEnabled(false);</a>
<a name="ln1149">            }</a>
<a name="ln1150">      else if (swingEighth-&gt;isChecked()) {</a>
<a name="ln1151">            val = TDuration(TDuration::DurationType::V_EIGHTH).name();</a>
<a name="ln1152">            swingBox-&gt;setEnabled(true);</a>
<a name="ln1153">            }</a>
<a name="ln1154">      else if (swingSixteenth-&gt;isChecked()) {</a>
<a name="ln1155">            val = TDuration(TDuration::DurationType::V_16TH).name();</a>
<a name="ln1156">            swingBox-&gt;setEnabled(true);</a>
<a name="ln1157">            }</a>
<a name="ln1158">      cs-&gt;undo(new ChangeStyleVal(cs, Sid::swingUnit, val));</a>
<a name="ln1159">      cs-&gt;update();</a>
<a name="ln1160">      }</a>
<a name="ln1161"> </a>
<a name="ln1162">//---------------------------------------------------------</a>
<a name="ln1163">//   concertPitchToggled</a>
<a name="ln1164">//---------------------------------------------------------</a>
<a name="ln1165"> </a>
<a name="ln1166">void EditStyle::concertPitchToggled(bool checked)</a>
<a name="ln1167">      {</a>
<a name="ln1168">      cs-&gt;cmdConcertPitchChanged(checked, true);</a>
<a name="ln1169">      }</a>
<a name="ln1170"> </a>
<a name="ln1171">//---------------------------------------------------------</a>
<a name="ln1172">//   setChordStyle</a>
<a name="ln1173">//---------------------------------------------------------</a>
<a name="ln1174"> </a>
<a name="ln1175">void EditStyle::setChordStyle(bool checked)</a>
<a name="ln1176">      {</a>
<a name="ln1177">      if (!checked)</a>
<a name="ln1178">            return;</a>
<a name="ln1179">      QVariant val;</a>
<a name="ln1180">      QString file;</a>
<a name="ln1181">      bool chordsXml;</a>
<a name="ln1182">      if (chordsStandard-&gt;isChecked()) {</a>
<a name="ln1183">            val  = QString(&quot;std&quot;);</a>
<a name="ln1184">            file = &quot;chords_std.xml&quot;;</a>
<a name="ln1185">            chordsXml = false;</a>
<a name="ln1186">            }</a>
<a name="ln1187">      else if (chordsJazz-&gt;isChecked()) {</a>
<a name="ln1188">            val  = QString(&quot;jazz&quot;);</a>
<a name="ln1189">            file = &quot;chords_jazz.xml&quot;;</a>
<a name="ln1190">            chordsXml = false;</a>
<a name="ln1191">            }</a>
<a name="ln1192">      else {</a>
<a name="ln1193">            val = QString(&quot;custom&quot;);</a>
<a name="ln1194">            chordDescriptionGroup-&gt;setEnabled(true);</a>
<a name="ln1195">            file = chordDescriptionFile-&gt;text();</a>
<a name="ln1196">            chordsXml = chordsXmlFile-&gt;isChecked();</a>
<a name="ln1197">            }</a>
<a name="ln1198">      if (val != &quot;custom&quot;) {</a>
<a name="ln1199">            chordsXmlFile-&gt;setChecked(chordsXml);</a>
<a name="ln1200">            chordDescriptionGroup-&gt;setEnabled(false);</a>
<a name="ln1201">            chordDescriptionFile-&gt;setText(file);</a>
<a name="ln1202">            }</a>
<a name="ln1203">      cs-&gt;undo(new ChangeStyleVal(cs, Sid::chordsXmlFile, chordsXml));</a>
<a name="ln1204">      cs-&gt;undo(new ChangeStyleVal(cs, Sid::chordStyle, val));</a>
<a name="ln1205">      if (!file.isEmpty()) {</a>
<a name="ln1206">            cs-&gt;undo(new ChangeStyleVal(cs, Sid::chordDescriptionFile, file));</a>
<a name="ln1207">            cs-&gt;update();</a>
<a name="ln1208">            }</a>
<a name="ln1209">      //formattingGroup-&gt;setEnabled(cs-&gt;style().chordList()-&gt;autoAdjust());</a>
<a name="ln1210">      }</a>
<a name="ln1211"> </a>
<a name="ln1212">//---------------------------------------------------------</a>
<a name="ln1213">//   toggleHeaderOddEven</a>
<a name="ln1214">//---------------------------------------------------------</a>
<a name="ln1215"> </a>
<a name="ln1216">void EditStyle::toggleHeaderOddEven(bool checked)</a>
<a name="ln1217">      {</a>
<a name="ln1218">      if (!showHeader-&gt;isChecked())</a>
<a name="ln1219">            return;</a>
<a name="ln1220">      labelEvenHeader-&gt;setEnabled(checked);</a>
<a name="ln1221">      evenHeaderL-&gt;setEnabled(checked);</a>
<a name="ln1222">      evenHeaderC-&gt;setEnabled(checked);</a>
<a name="ln1223">      evenHeaderR-&gt;setEnabled(checked);</a>
<a name="ln1224">      static QString odd  = labelOddHeader-&gt;text();  // save on 1st round</a>
<a name="ln1225">      static QString even = labelEvenHeader-&gt;text(); // save on 1st round</a>
<a name="ln1226">      if (checked)</a>
<a name="ln1227">            labelOddHeader-&gt;setText(odd); // restore</a>
<a name="ln1228">      else</a>
<a name="ln1229">            labelOddHeader-&gt;setText(odd + &quot;\n&quot; + even); // replace</a>
<a name="ln1230">      return;</a>
<a name="ln1231">      }</a>
<a name="ln1232"> </a>
<a name="ln1233">//---------------------------------------------------------</a>
<a name="ln1234">//   toggleFooterOddEven</a>
<a name="ln1235">//---------------------------------------------------------</a>
<a name="ln1236"> </a>
<a name="ln1237">void EditStyle::toggleFooterOddEven(bool checked)</a>
<a name="ln1238">      {</a>
<a name="ln1239">      if (!showFooter-&gt;isChecked())</a>
<a name="ln1240">            return;</a>
<a name="ln1241">      labelEvenFooter-&gt;setEnabled(checked);</a>
<a name="ln1242">      evenFooterL-&gt;setEnabled(checked);</a>
<a name="ln1243">      evenFooterC-&gt;setEnabled(checked);</a>
<a name="ln1244">      evenFooterR-&gt;setEnabled(checked);</a>
<a name="ln1245">      static QString odd  = labelOddFooter-&gt;text();  // save on 1st round</a>
<a name="ln1246">      static QString even = labelEvenFooter-&gt;text(); // save on 1st round</a>
<a name="ln1247">      if (checked)</a>
<a name="ln1248">            labelOddFooter-&gt;setText(odd); // restore</a>
<a name="ln1249">      else</a>
<a name="ln1250">            labelOddFooter-&gt;setText(odd + &quot;\n&quot; + even); // replace</a>
<a name="ln1251">      return;</a>
<a name="ln1252">      }</a>
<a name="ln1253"> </a>
<a name="ln1254">//---------------------------------------------------------</a>
<a name="ln1255">//   lyricsDashMin/MaxLengthValueChanged</a>
<a name="ln1256">//</a>
<a name="ln1257">//    Ensure lyricsDashMinLength &lt;= lyricsDashMaxLength</a>
<a name="ln1258">//---------------------------------------------------------</a>
<a name="ln1259"> </a>
<a name="ln1260">void EditStyle::lyricsDashMaxLengthValueChanged(double val)</a>
<a name="ln1261">      {</a>
<a name="ln1262">      double otherVal = lyricsDashMinLength-&gt;value();</a>
<a name="ln1263">      if (otherVal &gt; val)</a>
<a name="ln1264">            lyricsDashMaxLength-&gt;setValue(otherVal);</a>
<a name="ln1265">      }</a>
<a name="ln1266"> </a>
<a name="ln1267">void EditStyle::lyricsDashMinLengthValueChanged(double val)</a>
<a name="ln1268">      {</a>
<a name="ln1269">      double otherVal = lyricsDashMaxLength-&gt;value();</a>
<a name="ln1270">      if (otherVal &lt; val)</a>
<a name="ln1271">            lyricsDashMinLength-&gt;setValue(otherVal);</a>
<a name="ln1272">      }</a>
<a name="ln1273"> </a>
<a name="ln1274">//---------------------------------------------------------</a>
<a name="ln1275">//   systemMin/MaxDistanceValueChanged</a>
<a name="ln1276">//</a>
<a name="ln1277">//    Ensure minSystemDistance &lt;= maxSystemDistance</a>
<a name="ln1278">//---------------------------------------------------------</a>
<a name="ln1279"> </a>
<a name="ln1280">void EditStyle::systemMaxDistanceValueChanged(double val)</a>
<a name="ln1281">      {</a>
<a name="ln1282">      double otherVal = minSystemDistance-&gt;value();</a>
<a name="ln1283">      if (otherVal &gt; val)</a>
<a name="ln1284">            maxSystemDistance-&gt;setValue(otherVal);</a>
<a name="ln1285">      }</a>
<a name="ln1286"> </a>
<a name="ln1287"> </a>
<a name="ln1288">void EditStyle::systemMinDistanceValueChanged(double val)</a>
<a name="ln1289">      {</a>
<a name="ln1290">      double otherVal = maxSystemDistance-&gt;value();</a>
<a name="ln1291">      if (otherVal &lt; val)</a>
<a name="ln1292">            minSystemDistance-&gt;setValue(otherVal);</a>
<a name="ln1293">      }</a>
<a name="ln1294">//---------------------------------------------------------</a>
<a name="ln1295">//   setPage</a>
<a name="ln1296">//---------------------------------------------------------</a>
<a name="ln1297"> </a>
<a name="ln1298">void EditStyle::setPage(int row)</a>
<a name="ln1299">      {</a>
<a name="ln1300">      pageList-&gt;setCurrentRow(row);</a>
<a name="ln1301">      }</a>
<a name="ln1302"> </a>
<a name="ln1303">//---------------------------------------------------------</a>
<a name="ln1304">//   styleWidget</a>
<a name="ln1305">//---------------------------------------------------------</a>
<a name="ln1306"> </a>
<a name="ln1307">const StyleWidget&amp; EditStyle::styleWidget(Sid idx) const</a>
<a name="ln1308">      {</a>
<a name="ln1309">      for (const StyleWidget&amp; sw : styleWidgets) {</a>
<a name="ln1310">            if (sw.idx == idx)</a>
<a name="ln1311">                  return sw;</a>
<a name="ln1312">            }</a>
<a name="ln1313">#if (!defined (_MSCVER) &amp;&amp; !defined (_MSC_VER))</a>
<a name="ln1314">      __builtin_unreachable();</a>
<a name="ln1315">#else</a>
<a name="ln1316">      // The MSVC __assume() optimizer hint is similar, though not identical, to __builtin_unreachable()</a>
<a name="ln1317">      __assume(0);</a>
<a name="ln1318">#endif</a>
<a name="ln1319">   }</a>
<a name="ln1320"> </a>
<a name="ln1321">//---------------------------------------------------------</a>
<a name="ln1322">//   valueChanged</a>
<a name="ln1323">//---------------------------------------------------------</a>
<a name="ln1324"> </a>
<a name="ln1325">void EditStyle::valueChanged(int i)</a>
<a name="ln1326">      {</a>
<a name="ln1327">      Sid idx       = (Sid)i;</a>
<a name="ln1328">      QVariant val  = getValue(idx);</a>
<a name="ln1329">      bool setValue = false;</a>
<a name="ln1330">      if (idx == Sid::MusicalSymbolFont &amp;&amp; optimizeStyleCheckbox-&gt;isChecked()) {</a>
<a name="ln1331">            ScoreFont* scoreFont = ScoreFont::fontFactory(val.toString());</a>
<a name="ln1332">            if (scoreFont) {</a>
<a name="ln1333">                  for (auto j : scoreFont-&gt;engravingDefaults()) {</a>
<a name="ln1334">#if 0  // debug</a>
<a name="ln1335">                        if (cs-&gt;styleV(j.first) != j.second) {</a>
<a name="ln1336">                              printf(&quot;change style &lt;%s&gt;(%s) %f -&gt; %f (%f %f)\n&quot;,</a>
<a name="ln1337">                                 MStyle::valueName(j.first),</a>
<a name="ln1338">                                 MStyle::valueType(j.first),</a>
<a name="ln1339">                                 cs-&gt;styleV(j.first).toDouble(),</a>
<a name="ln1340">                                 j.second.toDouble(),</a>
<a name="ln1341">                                 SPATIUM20,</a>
<a name="ln1342">                                 cs-&gt;spatium()</a>
<a name="ln1343">                                 );</a>
<a name="ln1344">                              }</a>
<a name="ln1345">#endif</a>
<a name="ln1346">                          cs-&gt;undo(new ChangeStyleVal(cs, j.first, j.second));</a>
<a name="ln1347">                          }</a>
<a name="ln1348">                  // fix values, the distances are defined different in MuseScore</a>
<a name="ln1349">                  cs-&gt;undo(new ChangeStyleVal(cs, Sid::endBarDistance,</a>
<a name="ln1350">                    cs-&gt;styleV(Sid::endBarDistance).toDouble()</a>
<a name="ln1351">                    + (cs-&gt;styleV(Sid::barWidth).toDouble() + cs-&gt;styleV(Sid::endBarWidth).toDouble()) * .5));</a>
<a name="ln1352">                  cs-&gt;undo(new ChangeStyleVal(cs, Sid::doubleBarDistance,</a>
<a name="ln1353">                    cs-&gt;styleV(Sid::doubleBarDistance).toDouble()</a>
<a name="ln1354">                    + (cs-&gt;styleV(Sid::barWidth).toDouble() + cs-&gt;styleV(Sid::barWidth).toDouble()) * .5));</a>
<a name="ln1355"> </a>
<a name="ln1356">                  // guess the repeat dot width = spatium * .3</a>
<a name="ln1357">                  cs-&gt;undo(new ChangeStyleVal(cs, Sid::repeatBarlineDotSeparation,</a>
<a name="ln1358">                    cs-&gt;styleV(Sid::repeatBarlineDotSeparation).toDouble()</a>
<a name="ln1359">                    + (cs-&gt;styleV(Sid::barWidth).toDouble() + .3) * .5));</a>
<a name="ln1360"> </a>
<a name="ln1361">//                  if (scoreFont-&gt;textEnclosureThickness()) {</a>
<a name="ln1362">//                        TextStyle ts = cs-&gt;textStyle(TextStyleType::REHEARSAL_MARK);</a>
<a name="ln1363">//                        ts.setFrameWidth(Spatium(scoreFont-&gt;textEnclosureThickness()));</a>
<a name="ln1364">//TODO                        cs-&gt;undo(new ChangeTextStyle(cs, ts));</a>
<a name="ln1365">//                        }</a>
<a name="ln1366">                  }</a>
<a name="ln1367">            setValue = true;</a>
<a name="ln1368">            }</a>
<a name="ln1369">      cs-&gt;undo(new ChangeStyleVal(cs, idx, val));</a>
<a name="ln1370">      cs-&gt;update();</a>
<a name="ln1371">      if (setValue)</a>
<a name="ln1372">            setValues();</a>
<a name="ln1373">      const StyleWidget&amp; sw = styleWidget(idx);</a>
<a name="ln1374">      if (sw.reset)</a>
<a name="ln1375">            sw.reset-&gt;setEnabled(!cs-&gt;style().isDefault(idx));</a>
<a name="ln1376">      }</a>
<a name="ln1377"> </a>
<a name="ln1378">//---------------------------------------------------------</a>
<a name="ln1379">//   resetStyleValue</a>
<a name="ln1380">//---------------------------------------------------------</a>
<a name="ln1381"> </a>
<a name="ln1382">void EditStyle::resetStyleValue(int i)</a>
<a name="ln1383">      {</a>
<a name="ln1384">      Sid idx = (Sid)i;</a>
<a name="ln1385">      cs-&gt;undo(new ChangeStyleVal(cs, idx, MScore::defaultStyle().value(idx)));</a>
<a name="ln1386">      setValues();</a>
<a name="ln1387">      cs-&gt;update();</a>
<a name="ln1388">      }</a>
<a name="ln1389"> </a>
<a name="ln1390">//---------------------------------------------------------</a>
<a name="ln1391">//   textStyleChanged</a>
<a name="ln1392">//---------------------------------------------------------</a>
<a name="ln1393"> </a>
<a name="ln1394">void EditStyle::textStyleChanged(int row)</a>
<a name="ln1395">      {</a>
<a name="ln1396">      Tid tid = Tid(textStyles-&gt;item(row)-&gt;data(Qt::UserRole).toInt());</a>
<a name="ln1397">      const TextStyle* ts = textStyle(tid);</a>
<a name="ln1398"> </a>
<a name="ln1399">      for (const StyledProperty&amp; a : *ts) {</a>
<a name="ln1400">            switch (a.pid) {</a>
<a name="ln1401">                  case Pid::FONT_FACE: {</a>
<a name="ln1402">                        QVariant val = cs-&gt;styleV(a.sid);</a>
<a name="ln1403">                        textStyleFontFace-&gt;setCurrentFont(QFont(val.toString()));</a>
<a name="ln1404">                        resetTextStyleFontFace-&gt;setEnabled(val != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1405">                        }</a>
<a name="ln1406">                        break;</a>
<a name="ln1407"> </a>
<a name="ln1408">                  case Pid::FONT_SIZE:</a>
<a name="ln1409">                        textStyleFontSize-&gt;setValue(cs-&gt;styleD(a.sid));</a>
<a name="ln1410">                        resetTextStyleFontSize-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1411">                        break;</a>
<a name="ln1412"> </a>
<a name="ln1413">                  case Pid::FONT_STYLE:</a>
<a name="ln1414">                        textStyleFontStyle-&gt;setFontStyle(FontStyle(cs-&gt;styleV(a.sid).toInt()));</a>
<a name="ln1415">                        resetTextStyleFontStyle-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1416">                        break;</a>
<a name="ln1417"> </a>
<a name="ln1418">                  case Pid::ALIGN:</a>
<a name="ln1419">                        textStyleAlign-&gt;setAlign(cs-&gt;styleV(a.sid).value&lt;Align&gt;());</a>
<a name="ln1420">                        resetTextStyleAlign-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1421">                        break;</a>
<a name="ln1422"> </a>
<a name="ln1423">                  case Pid::OFFSET:</a>
<a name="ln1424">                        textStyleOffset-&gt;setOffset(cs-&gt;styleV(a.sid).toPointF());</a>
<a name="ln1425">                        resetTextStyleOffset-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1426">                        break;</a>
<a name="ln1427"> </a>
<a name="ln1428">                  case Pid::SIZE_SPATIUM_DEPENDENT: {</a>
<a name="ln1429">                        QVariant val = cs-&gt;styleV(a.sid);</a>
<a name="ln1430">                        textStyleSpatiumDependent-&gt;setChecked(val.toBool());</a>
<a name="ln1431">                        resetTextStyleSpatiumDependent-&gt;setEnabled(val != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1432">                        textStyleOffset-&gt;setSuffix(val.toBool() ? tr(&quot;sp&quot;) : tr(&quot;mm&quot;));</a>
<a name="ln1433">                        }</a>
<a name="ln1434">                        break;</a>
<a name="ln1435"> </a>
<a name="ln1436">                  case Pid::FRAME_TYPE:</a>
<a name="ln1437">                        textStyleFrameType-&gt;setCurrentIndex(cs-&gt;styleV(a.sid).toInt());</a>
<a name="ln1438">                        resetTextStyleFrameType-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1439">                        frameWidget-&gt;setEnabled(cs-&gt;styleV(a.sid).toInt() != 0); // disable if no frame</a>
<a name="ln1440">                        break;</a>
<a name="ln1441"> </a>
<a name="ln1442">                  case Pid::FRAME_PADDING:</a>
<a name="ln1443">                        textStyleFramePadding-&gt;setValue(cs-&gt;styleV(a.sid).toDouble());</a>
<a name="ln1444">                        resetTextStyleFramePadding-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1445">                        break;</a>
<a name="ln1446"> </a>
<a name="ln1447">                  case Pid::FRAME_WIDTH:</a>
<a name="ln1448">                        textStyleFrameBorder-&gt;setValue(cs-&gt;styleV(a.sid).toDouble());</a>
<a name="ln1449">                        resetTextStyleFrameBorder-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1450">                        break;</a>
<a name="ln1451"> </a>
<a name="ln1452">                  case Pid::FRAME_ROUND:</a>
<a name="ln1453">                        textStyleFrameBorderRadius-&gt;setValue(cs-&gt;styleV(a.sid).toDouble());</a>
<a name="ln1454">                        resetTextStyleFrameBorderRadius-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1455">                        break;</a>
<a name="ln1456"> </a>
<a name="ln1457">                  case Pid::FRAME_FG_COLOR:</a>
<a name="ln1458">                        textStyleFrameForeground-&gt;setColor(cs-&gt;styleV(a.sid).value&lt;QColor&gt;());</a>
<a name="ln1459">                        resetTextStyleFrameForeground-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1460">                        break;</a>
<a name="ln1461"> </a>
<a name="ln1462">                  case Pid::FRAME_BG_COLOR:</a>
<a name="ln1463">                        textStyleFrameBackground-&gt;setColor(cs-&gt;styleV(a.sid).value&lt;QColor&gt;());</a>
<a name="ln1464">                        resetTextStyleFrameBackground-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1465">                        break;</a>
<a name="ln1466"> </a>
<a name="ln1467">                  case Pid::COLOR:</a>
<a name="ln1468">                        textStyleColor-&gt;setColor(cs-&gt;styleV(a.sid).value&lt;QColor&gt;());</a>
<a name="ln1469">                        resetTextStyleColor-&gt;setEnabled(cs-&gt;styleV(a.sid) != MScore::defaultStyle().value(a.sid));</a>
<a name="ln1470">                        break;</a>
<a name="ln1471"> </a>
<a name="ln1472">                  default:</a>
<a name="ln1473">                        break;</a>
<a name="ln1474">                  }</a>
<a name="ln1475">            }</a>
<a name="ln1476">      styleName-&gt;setText(cs-&gt;getTextStyleUserName(tid));</a>
<a name="ln1477">      styleName-&gt;setEnabled(int(tid) &gt;= int(Tid::USER1));</a>
<a name="ln1478">      resetTextStyleName-&gt;setEnabled(styleName-&gt;text() != textStyleUserName(tid));</a>
<a name="ln1479">      }</a>
<a name="ln1480"> </a>
<a name="ln1481">//---------------------------------------------------------</a>
<a name="ln1482">//   textStyleValueChanged</a>
<a name="ln1483">//---------------------------------------------------------</a>
<a name="ln1484"> </a>
<a name="ln1485">void EditStyle::textStyleValueChanged(Pid pid, QVariant value)</a>
<a name="ln1486">      {</a>
<a name="ln1487">      Tid tid = Tid(textStyles-&gt;item(textStyles-&gt;currentRow())-&gt;data(Qt::UserRole).toInt());</a>
<a name="ln1488">      const TextStyle* ts = textStyle(tid);</a>
<a name="ln1489"> </a>
<a name="ln1490">      for (const StyledProperty&amp; a : *ts) {</a>
<a name="ln1491">            if (a.pid == pid) {</a>
<a name="ln1492">                  cs-&gt;undoChangeStyleVal(a.sid, value);</a>
<a name="ln1493">                  break;</a>
<a name="ln1494">                  }</a>
<a name="ln1495">            }</a>
<a name="ln1496">      textStyleChanged(textStyles-&gt;currentRow());     // update GUI (reset buttons)</a>
<a name="ln1497">      cs-&gt;update();</a>
<a name="ln1498">      }</a>
<a name="ln1499"> </a>
<a name="ln1500">//---------------------------------------------------------</a>
<a name="ln1501">//   resetTextStyle</a>
<a name="ln1502">//---------------------------------------------------------</a>
<a name="ln1503"> </a>
<a name="ln1504">void EditStyle::resetTextStyle(Pid pid)</a>
<a name="ln1505">      {</a>
<a name="ln1506">      Tid tid = Tid(textStyles-&gt;item(textStyles-&gt;currentRow())-&gt;data(Qt::UserRole).toInt());</a>
<a name="ln1507">      const TextStyle* ts = textStyle(tid);</a>
<a name="ln1508"> </a>
<a name="ln1509">      for (const StyledProperty&amp; a : *ts) {</a>
<a name="ln1510">            if (a.pid == pid) {</a>
<a name="ln1511">                  cs-&gt;undoChangeStyleVal(a.sid, MScore::defaultStyle().value(a.sid));</a>
<a name="ln1512">                  break;</a>
<a name="ln1513">                  }</a>
<a name="ln1514">            }</a>
<a name="ln1515">      textStyleChanged(textStyles-&gt;currentRow());     // update GUI</a>
<a name="ln1516">      cs-&gt;update();</a>
<a name="ln1517">      }</a>
<a name="ln1518"> </a>
<a name="ln1519">//---------------------------------------------------------</a>
<a name="ln1520">//   editUserStyleName</a>
<a name="ln1521">//---------------------------------------------------------</a>
<a name="ln1522"> </a>
<a name="ln1523">void EditStyle::editUserStyleName()</a>
<a name="ln1524">      {</a>
<a name="ln1525">      int row = textStyles-&gt;currentRow();</a>
<a name="ln1526">      Tid tid = Tid(textStyles-&gt;item(row)-&gt;data(Qt::UserRole).toInt());</a>
<a name="ln1527">      textStyles-&gt;item(row)-&gt;setText(styleName-&gt;text());</a>
<a name="ln1528">      resetTextStyleName-&gt;setEnabled(styleName-&gt;text() != textStyleUserName(tid));</a>
<a name="ln1529">      }</a>
<a name="ln1530"> </a>
<a name="ln1531">//---------------------------------------------------------</a>
<a name="ln1532">//   endEditUserStyleName</a>
<a name="ln1533">//---------------------------------------------------------</a>
<a name="ln1534"> </a>
<a name="ln1535">void EditStyle::endEditUserStyleName()</a>
<a name="ln1536">      {</a>
<a name="ln1537">      int row = textStyles-&gt;currentRow();</a>
<a name="ln1538">      Tid tid = Tid(textStyles-&gt;item(row)-&gt;data(Qt::UserRole).toInt());</a>
<a name="ln1539">      int idx = int(tid) - int(Tid::USER1);</a>
<a name="ln1540">      if ((idx &lt; 0) || (idx &gt; 5)) {</a>
<a name="ln1541">            qDebug(&quot;User style index %d outside of range [0,5].&quot;, idx);</a>
<a name="ln1542">            return;</a>
<a name="ln1543">            }</a>
<a name="ln1544">      Sid sid[] = { Sid::user1Name, Sid::user2Name, Sid::user3Name, Sid::user4Name, Sid::user5Name, Sid::user6Name };</a>
<a name="ln1545">      QString name = styleName-&gt;text();</a>
<a name="ln1546">      cs-&gt;undoChangeStyleVal(sid[idx], name);</a>
<a name="ln1547">      if (name == &quot;&quot;) {</a>
<a name="ln1548">            name = textStyleUserName(tid);</a>
<a name="ln1549">            styleName-&gt;setText(name);</a>
<a name="ln1550">            textStyles-&gt;item(row)-&gt;setText(name);</a>
<a name="ln1551">            resetTextStyleName-&gt;setEnabled(false);</a>
<a name="ln1552">            }</a>
<a name="ln1553">      MuseScoreCore::mscoreCore-&gt;updateInspector();</a>
<a name="ln1554">      }</a>
<a name="ln1555">//---------------------------------------------------------</a>
<a name="ln1556">//   resetUserStyleName</a>
<a name="ln1557">//---------------------------------------------------------</a>
<a name="ln1558"> </a>
<a name="ln1559">void EditStyle::resetUserStyleName()</a>
<a name="ln1560">      {</a>
<a name="ln1561">      styleName-&gt;clear();</a>
<a name="ln1562">      endEditUserStyleName();</a>
<a name="ln1563">      }</a>
<a name="ln1564"> </a>
<a name="ln1565">} //namespace Ms</a>
<a name="ln1566"> </a>

</code></pre>
<div class="balloon" rel="8"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
