
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>inspector.cpp</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">//=============================================================================</a>
<a name="ln2">//  MuseScore</a>
<a name="ln3">//  Music Composition &amp; Notation</a>
<a name="ln4">//</a>
<a name="ln5">//  Copyright (C) 2011-2016 Werner Schweer</a>
<a name="ln6">//</a>
<a name="ln7">//  This program is free software; you can redistribute it and/or modify</a>
<a name="ln8">//  it under the terms of the GNU General Public License version 2</a>
<a name="ln9">//  as published by the Free Software Foundation and appearing in</a>
<a name="ln10">//  the file LICENSE.GPL</a>
<a name="ln11">//=============================================================================</a>
<a name="ln12"> </a>
<a name="ln13">#include &quot;inspector.h&quot;</a>
<a name="ln14">#include &quot;inspectorTextBase.h&quot;</a>
<a name="ln15">#include &quot;inspectorBeam.h&quot;</a>
<a name="ln16">#include &quot;inspectorImage.h&quot;</a>
<a name="ln17">#include &quot;inspectorLasso.h&quot;</a>
<a name="ln18">#include &quot;inspectorGroupElement.h&quot;</a>
<a name="ln19">#include &quot;inspectorVolta.h&quot;</a>
<a name="ln20">#include &quot;inspectorOttava.h&quot;</a>
<a name="ln21">#include &quot;inspectorTrill.h&quot;</a>
<a name="ln22">#include &quot;inspectorHairpin.h&quot;</a>
<a name="ln23">#include &quot;inspectorTextLine.h&quot;</a>
<a name="ln24">#include &quot;inspectorMarker.h&quot;</a>
<a name="ln25">#include &quot;inspectorJump.h&quot;</a>
<a name="ln26">#include &quot;inspectorGlissando.h&quot;</a>
<a name="ln27">#include &quot;inspectorArpeggio.h&quot;</a>
<a name="ln28">#include &quot;inspectorNote.h&quot;</a>
<a name="ln29">#include &quot;inspectorAmbitus.h&quot;</a>
<a name="ln30">#include &quot;inspectorFret.h&quot;</a>
<a name="ln31">#include &quot;inspectorText.h&quot;</a>
<a name="ln32">#include &quot;inspectorBarline.h&quot;</a>
<a name="ln33">#include &quot;inspectorFingering.h&quot;</a>
<a name="ln34">#include &quot;inspectorDynamic.h&quot;</a>
<a name="ln35">#include &quot;inspectorHarmony.h&quot;</a>
<a name="ln36">#include &quot;inspectorLetRing.h&quot;</a>
<a name="ln37">#include &quot;inspectorPedal.h&quot;</a>
<a name="ln38">#include &quot;inspectorPalmMute.h&quot;</a>
<a name="ln39">#include &quot;inspectorVibrato.h&quot;</a>
<a name="ln40">#include &quot;inspectorNoteDot.h&quot;</a>
<a name="ln41">#include &quot;inspectorInstrchange.h&quot;</a>
<a name="ln42">#include &quot;inspectorMeasureNumber.h&quot;</a>
<a name="ln43">#include &quot;inspectorBend.h&quot;</a>
<a name="ln44">#include &quot;inspectorTremoloBar.h&quot;</a>
<a name="ln45">#include &quot;musescore.h&quot;</a>
<a name="ln46">#include &quot;scoreview.h&quot;</a>
<a name="ln47">#include &quot;icons.h&quot;</a>
<a name="ln48"> </a>
<a name="ln49">#include &quot;libmscore/element.h&quot;</a>
<a name="ln50">#include &quot;libmscore/score.h&quot;</a>
<a name="ln51">#include &quot;libmscore/box.h&quot;</a>
<a name="ln52">#include &quot;libmscore/undo.h&quot;</a>
<a name="ln53">#include &quot;libmscore/spacer.h&quot;</a>
<a name="ln54">#include &quot;libmscore/note.h&quot;</a>
<a name="ln55">#include &quot;libmscore/chord.h&quot;</a>
<a name="ln56">#include &quot;libmscore/segment.h&quot;</a>
<a name="ln57">#include &quot;libmscore/rest.h&quot;</a>
<a name="ln58">#include &quot;libmscore/beam.h&quot;</a>
<a name="ln59">#include &quot;libmscore/clef.h&quot;</a>
<a name="ln60">#include &quot;libmscore/notedot.h&quot;</a>
<a name="ln61">#include &quot;libmscore/hook.h&quot;</a>
<a name="ln62">#include &quot;libmscore/stem.h&quot;</a>
<a name="ln63">#include &quot;libmscore/keysig.h&quot;</a>
<a name="ln64">#include &quot;libmscore/timesig.h&quot;</a>
<a name="ln65">#include &quot;libmscore/barline.h&quot;</a>
<a name="ln66">#include &quot;libmscore/staff.h&quot;</a>
<a name="ln67">#include &quot;libmscore/measure.h&quot;</a>
<a name="ln68">#include &quot;libmscore/tuplet.h&quot;</a>
<a name="ln69">#include &quot;libmscore/slur.h&quot;</a>
<a name="ln70">#include &quot;libmscore/breath.h&quot;</a>
<a name="ln71">#include &quot;libmscore/lyrics.h&quot;</a>
<a name="ln72">#include &quot;libmscore/accidental.h&quot;</a>
<a name="ln73">#include &quot;libmscore/articulation.h&quot;</a>
<a name="ln74">#include &quot;libmscore/fermata.h&quot;</a>
<a name="ln75">#include &quot;libmscore/stafftypechange.h&quot;</a>
<a name="ln76">#include &quot;libmscore/mscore.h&quot;</a>
<a name="ln77">#include &quot;libmscore/stafftextbase.h&quot;</a>
<a name="ln78"> </a>
<a name="ln79">namespace Ms {</a>
<a name="ln80"> </a>
<a name="ln81">//---------------------------------------------------------</a>
<a name="ln82">//   showInspector</a>
<a name="ln83">//---------------------------------------------------------</a>
<a name="ln84"> </a>
<a name="ln85">void MuseScore::showInspector(bool visible)</a>
<a name="ln86">      {</a>
<a name="ln87">      QAction* a = getAction(&quot;inspector&quot;);</a>
<a name="ln88">      if (!_inspector) {</a>
<a name="ln89">            _inspector = new Inspector();</a>
<a name="ln90">            connect(_inspector, SIGNAL(visibilityChanged(bool)), a, SLOT(setChecked(bool)));</a>
<a name="ln91">            addDockWidget(Qt::RightDockWidgetArea, _inspector);</a>
<a name="ln92">            }</a>
<a name="ln93">      if (_inspector)</a>
<a name="ln94">            reDisplayDockWidget(_inspector, visible);</a>
<a name="ln95">      if (visible)</a>
<a name="ln96">            updateInspector();</a>
<a name="ln97">      }</a>
<a name="ln98"> </a>
<a name="ln99">//---------------------------------------------------------</a>
<a name="ln100">//   Inspector</a>
<a name="ln101">//---------------------------------------------------------</a>
<a name="ln102"> </a>
<a name="ln103">Inspector::Inspector(QWidget* parent)</a>
<a name="ln104">   : QDockWidget(parent)</a>
<a name="ln105">      {</a>
<a name="ln106">      setObjectName(&quot;inspector&quot;);</a>
<a name="ln107">      setAllowedAreas(Qt::DockWidgetAreas(Qt::LeftDockWidgetArea | Qt::RightDockWidgetArea));</a>
<a name="ln108">      sa = new QScrollArea;</a>
<a name="ln109">      sa-&gt;setFrameShape(QFrame::NoFrame);</a>
<a name="ln110">      sa-&gt;setSizeAdjustPolicy(QAbstractScrollArea::AdjustToContents);</a>
<a name="ln111">      sa-&gt;setWidgetResizable(true);</a>
<a name="ln112"> </a>
<a name="ln113">//      setSizePolicy(QSizePolicy::Fixed, QSizePolicy::Expanding);</a>
<a name="ln114">//      sa-&gt;setSizePolicy(QSizePolicy::Minimum, QSizePolicy::Expanding);</a>
<a name="ln115"> </a>
<a name="ln116">      setWidget(sa);</a>
<a name="ln117">      sa-&gt;setFocusPolicy(Qt::NoFocus);</a>
<a name="ln118"> </a>
<a name="ln119">      _inspectorEdit = false;</a>
<a name="ln120">      ie             = 0;</a>
<a name="ln121">      oe             = 0;</a>
<a name="ln122">      oSameTypes     = true;</a>
<a name="ln123">      _score         = 0;</a>
<a name="ln124">//      retranslate();</a>
<a name="ln125">      setWindowTitle(tr(&quot;Inspector&quot;));</a>
<a name="ln126">      }</a>
<a name="ln127"> </a>
<a name="ln128">//---------------------------------------------------------</a>
<a name="ln129">//   retranslate</a>
<a name="ln130">//---------------------------------------------------------</a>
<a name="ln131"> </a>
<a name="ln132">void Inspector::retranslate()</a>
<a name="ln133">      {</a>
<a name="ln134">      setWindowTitle(tr(&quot;Inspector&quot;));</a>
<a name="ln135">      sa-&gt;setAccessibleName(tr(&quot;Inspector Subwindow&quot;));</a>
<a name="ln136">      Score* s = _score;</a>
<a name="ln137">      update(0);</a>
<a name="ln138">      update(s);</a>
<a name="ln139">      }</a>
<a name="ln140"> </a>
<a name="ln141">//---------------------------------------------------------</a>
<a name="ln142">//   element</a>
<a name="ln143">//---------------------------------------------------------</a>
<a name="ln144"> </a>
<a name="ln145">Element* Inspector::element() const</a>
<a name="ln146">      {</a>
<a name="ln147">      return el() &amp;&amp; !el()-&gt;empty() ? (*el())[0] : 0;</a>
<a name="ln148">      }</a>
<a name="ln149"> </a>
<a name="ln150">//---------------------------------------------------------</a>
<a name="ln151">//   reset</a>
<a name="ln152">//---------------------------------------------------------</a>
<a name="ln153"> </a>
<a name="ln154">void Inspector::update()</a>
<a name="ln155">      {</a>
<a name="ln156">      update(_score);</a>
<a name="ln157">      }</a>
<a name="ln158"> </a>
<a name="ln159">//---------------------------------------------------------</a>
<a name="ln160">//   el</a>
<a name="ln161">//---------------------------------------------------------</a>
<a name="ln162"> </a>
<a name="ln163">const QList&lt;Element*&gt;* Inspector::el() const</a>
<a name="ln164">      {</a>
<a name="ln165">      return _score ? &amp;_score-&gt;selection().elements() : 0;</a>
<a name="ln166">      }</a>
<a name="ln167"> </a>
<a name="ln168">//---------------------------------------------------------</a>
<a name="ln169">//   update</a>
<a name="ln170">//---------------------------------------------------------</a>
<a name="ln171"> </a>
<a name="ln172">void Inspector::update(Score* s)</a>
<a name="ln173">      {</a>
<a name="ln174">      if (_inspectorEdit)     // if within an inspector-originated edit</a>
<a name="ln175">            return;</a>
<a name="ln176">      _score = s;</a>
<a name="ln177">      bool sameTypes = true;</a>
<a name="ln178">      bool sameSubtypes = true;</a>
<a name="ln179">      if (el()) {</a>
<a name="ln180">            for (Element* ee : *el()) {</a>
<a name="ln181">                  if (((element()-&gt;type() != ee-&gt;type()) &amp;&amp; // different and</a>
<a name="ln182">                      (!element()-&gt;isSystemText()     || !ee-&gt;isStaffText())  &amp;&amp; // neither system text nor</a>
<a name="ln183">                      (!element()-&gt;isStaffText()      || !ee-&gt;isSystemText()) &amp;&amp; // staff text either side and</a>
<a name="ln184">                      (!element()-&gt;isPedalSegment()   || !ee-&gt;isTextLineSegment()) &amp;&amp; // neither pedal nor</a>
<a name="ln185">                      (!element()-&gt;isTextLineSegment()|| !ee-&gt;isPedalSegment())    &amp;&amp; // text line either side and</a>
<a name="ln186">                      (!element()-&gt;isSlurTieSegment() || !ee-&gt;isSlurTieSegment())) || // neither Slur nor Tie either side, or</a>
<a name="ln187">                      (ee-&gt;isNote() &amp;&amp; toNote(ee)-&gt;chord()-&gt;isGrace() != toNote(element())-&gt;chord()-&gt;isGrace())) // HACK</a>
<a name="ln188">                        {</a>
<a name="ln189">                        sameTypes = false;</a>
<a name="ln190">                        break;</a>
<a name="ln191">                        }</a>
<a name="ln192">                      // an articulation and an ornament</a>
<a name="ln193">                  if ((ee-&gt;isArticulation() &amp;&amp; toArticulation(ee)-&gt;isOrnament() != toArticulation(element())-&gt;isOrnament()) ||</a>
<a name="ln194">                      // a slur and a tie</a>
<a name="ln195">                      (ee-&gt;isSlurTieSegment() &amp;&amp; toSlurTieSegment(ee)-&gt;isSlurSegment() != toSlurTieSegment(element())-&gt;isSlurSegment()) ||</a>
<a name="ln196">                      // a breath and a caesura</a>
<a name="ln197">                      (ee-&gt;isBreath() &amp;&amp; toBreath(ee)-&gt;isCaesura() != toBreath(element())-&gt;isCaesura()) ||</a>
<a name="ln198">                      // a staff text and a system text</a>
<a name="ln199">                      ((ee-&gt;isStaffText() || ee-&gt;isSystemText())</a>
<a name="ln200">                          &amp;&amp; (ee-&gt;type() != element()-&gt;type() || ee-&gt;isSystemText() != element()-&gt;isSystemText())))</a>
<a name="ln201">                        sameSubtypes = false;</a>
<a name="ln202">                  }</a>
<a name="ln203">            }</a>
<a name="ln204">      if (oe != element() || oSameTypes != sameTypes || (sameTypes &amp;&amp; !sameSubtypes)) {</a>
<a name="ln205">            delete ie;</a>
<a name="ln206">            ie  = 0;</a>
<a name="ln207">            oe  = element();</a>
<a name="ln208">            oSameTypes = sameTypes;</a>
<a name="ln209">            if (!element())</a>
<a name="ln210">                  ie = new InspectorEmpty(this);</a>
<a name="ln211">            else if (!sameTypes)</a>
<a name="ln212">                  ie = new InspectorGroupElement(this);</a>
<a name="ln213">            else {</a>
<a name="ln214">                  switch (element()-&gt;type()) {</a>
<a name="ln215">                        case ElementType::FBOX:</a>
<a name="ln216">                        case ElementType::VBOX:</a>
<a name="ln217">                              ie = new InspectorVBox(this);</a>
<a name="ln218">                              break;</a>
<a name="ln219">                        case ElementType::TBOX:</a>
<a name="ln220">                              ie = new InspectorTBox(this);</a>
<a name="ln221">                              break;</a>
<a name="ln222">                        case ElementType::HBOX:</a>
<a name="ln223">                              ie = new InspectorHBox(this);</a>
<a name="ln224">                              break;</a>
<a name="ln225">                        case ElementType::ARTICULATION:</a>
<a name="ln226">                              ie = new InspectorArticulation(this);</a>
<a name="ln227">                              break;</a>
<a name="ln228">                        case ElementType::FERMATA:</a>
<a name="ln229">                              ie = new InspectorFermata(this);</a>
<a name="ln230">                              break;</a>
<a name="ln231">                        case ElementType::SPACER:</a>
<a name="ln232">                              ie = new InspectorSpacer(this);</a>
<a name="ln233">                              break;</a>
<a name="ln234">                        case ElementType::NOTE:</a>
<a name="ln235">                              ie = new InspectorNote(this);</a>
<a name="ln236">                              break;</a>
<a name="ln237">                        case ElementType::ACCIDENTAL:</a>
<a name="ln238">                              ie = new InspectorAccidental(this);</a>
<a name="ln239">                              break;</a>
<a name="ln240">                        case ElementType::REST:</a>
<a name="ln241">                              ie = new InspectorRest(this);</a>
<a name="ln242">                              break;</a>
<a name="ln243">                        case ElementType::CLEF:</a>
<a name="ln244">                              ie = new InspectorClef(this);</a>
<a name="ln245">                              break;</a>
<a name="ln246">                        case ElementType::TIMESIG:</a>
<a name="ln247">                              ie = new InspectorTimeSig(this);</a>
<a name="ln248">                              break;</a>
<a name="ln249">                        case ElementType::KEYSIG:</a>
<a name="ln250">                              ie = new InspectorKeySig(this);</a>
<a name="ln251">                              break;</a>
<a name="ln252">                        case ElementType::TUPLET:</a>
<a name="ln253">                              ie = new InspectorTuplet(this);</a>
<a name="ln254">                              break;</a>
<a name="ln255">                        case ElementType::BEAM:</a>
<a name="ln256">                              ie = new InspectorBeam(this);</a>
<a name="ln257">                              break;</a>
<a name="ln258">                        case ElementType::IMAGE:</a>
<a name="ln259">                              ie = new InspectorImage(this);</a>
<a name="ln260">                              break;</a>
<a name="ln261">                        case ElementType::LASSO:</a>
<a name="ln262">                              ie = new InspectorLasso(this);</a>
<a name="ln263">                              break;</a>
<a name="ln264">                        case ElementType::VOLTA_SEGMENT:</a>
<a name="ln265">                              ie = new InspectorVolta(this);</a>
<a name="ln266">                              break;</a>
<a name="ln267">                        case ElementType::OTTAVA_SEGMENT:</a>
<a name="ln268">                              ie = new InspectorOttava(this);</a>
<a name="ln269">                              break;</a>
<a name="ln270">                        case ElementType::TRILL_SEGMENT:</a>
<a name="ln271">                              ie = new InspectorTrill(this);</a>
<a name="ln272">                              break;</a>
<a name="ln273">                        case ElementType::HAIRPIN_SEGMENT:</a>
<a name="ln274">                              ie = new InspectorHairpin(this);</a>
<a name="ln275">                              break;</a>
<a name="ln276">                        case ElementType::TEXTLINE_SEGMENT:</a>
<a name="ln277">                              ie = new InspectorTextLine(this);</a>
<a name="ln278">                              break;</a>
<a name="ln279">                        case ElementType::PEDAL_SEGMENT:</a>
<a name="ln280">                              ie = new InspectorPedal(this);</a>
<a name="ln281">                              break;</a>
<a name="ln282">                        case ElementType::LET_RING_SEGMENT:</a>
<a name="ln283">                              ie = new InspectorLetRing(this);</a>
<a name="ln284">                              break;</a>
<a name="ln285">                        case ElementType::PALM_MUTE_SEGMENT:</a>
<a name="ln286">                              ie = new InspectorPalmMute(this);</a>
<a name="ln287">                              break;</a>
<a name="ln288">                        case ElementType::SLUR_SEGMENT:</a>
<a name="ln289">                        case ElementType::TIE_SEGMENT:</a>
<a name="ln290">                              ie = new InspectorSlurTie(this);</a>
<a name="ln291">                              break;</a>
<a name="ln292">                        case ElementType::BAR_LINE:</a>
<a name="ln293">                              ie = new InspectorBarLine(this);</a>
<a name="ln294">                              break;</a>
<a name="ln295">                        case ElementType::JUMP:</a>
<a name="ln296">                              ie = new InspectorJump(this);</a>
<a name="ln297">                              break;</a>
<a name="ln298">                        case ElementType::MARKER:</a>
<a name="ln299">                              ie = new InspectorMarker(this);</a>
<a name="ln300">                              break;</a>
<a name="ln301">                        case ElementType::GLISSANDO:</a>
<a name="ln302">                        case ElementType::GLISSANDO_SEGMENT:</a>
<a name="ln303">                              ie = new InspectorGlissando(this);</a>
<a name="ln304">                              break;</a>
<a name="ln305">                        case ElementType::TEMPO_TEXT:</a>
<a name="ln306">                              ie = new InspectorTempoText(this);</a>
<a name="ln307">                              break;</a>
<a name="ln308">                        case ElementType::DYNAMIC:</a>
<a name="ln309">                              ie = new InspectorDynamic(this);</a>
<a name="ln310">                              break;</a>
<a name="ln311">                        case ElementType::AMBITUS:</a>
<a name="ln312">                              ie = new InspectorAmbitus(this);</a>
<a name="ln313">                              break;</a>
<a name="ln314">                        case ElementType::FRET_DIAGRAM:</a>
<a name="ln315">                              ie = new InspectorFretDiagram(this);</a>
<a name="ln316">                              break;</a>
<a name="ln317">                        case ElementType::LAYOUT_BREAK:</a>
<a name="ln318">                              if (toLayoutBreak(element())-&gt;layoutBreakType() == LayoutBreak::Type::SECTION)</a>
<a name="ln319">                                    ie = new InspectorSectionBreak(this);</a>
<a name="ln320">                              else</a>
<a name="ln321">                                    ie = new InspectorBreak(this);</a>
<a name="ln322">                              break;</a>
<a name="ln323">                        case ElementType::BEND:</a>
<a name="ln324">                              ie = new InspectorBend(this);</a>
<a name="ln325">                              break;</a>
<a name="ln326">                        case ElementType::TREMOLO:</a>
<a name="ln327">                              ie = new InspectorTremolo(this);</a>
<a name="ln328">                              break;</a>
<a name="ln329">                        case ElementType::TREMOLOBAR:</a>
<a name="ln330">                              ie = new InspectorTremoloBar(this);</a>
<a name="ln331">                              break;</a>
<a name="ln332">                        case ElementType::ARPEGGIO:</a>
<a name="ln333">                              ie = new InspectorArpeggio(this);</a>
<a name="ln334">                              break;</a>
<a name="ln335">                        case ElementType::BREATH:</a>
<a name="ln336">                              ie = new InspectorCaesura(this);</a>
<a name="ln337">                              break;</a>
<a name="ln338">                        case ElementType::LYRICS:</a>
<a name="ln339">                              ie = new InspectorLyric(this);</a>
<a name="ln340">                              break;</a>
<a name="ln341">                        case ElementType::STAFF_TEXT:</a>
<a name="ln342">                        case ElementType::SYSTEM_TEXT:</a>
<a name="ln343">                        case ElementType::REHEARSAL_MARK:</a>
<a name="ln344">                        case ElementType::INSTRUMENT_CHANGE:</a>
<a name="ln345">                              ie = new InspectorStaffText(this);</a>
<a name="ln346">                              break;</a>
<a name="ln347">                        case ElementType::MEASURE_NUMBER:</a>
<a name="ln348">                              ie = new InspectorMeasureNumber(this);</a>
<a name="ln349">                              break;</a>
<a name="ln350">                        case ElementType::STAFFTYPE_CHANGE:</a>
<a name="ln351">                              ie = new InspectorStaffTypeChange(this);</a>
<a name="ln352">                              break;</a>
<a name="ln353">                        case ElementType::BRACKET:</a>
<a name="ln354">                              ie = new InspectorBracket(this);</a>
<a name="ln355">                              break;</a>
<a name="ln356">                        case ElementType::INSTRUMENT_NAME:</a>
<a name="ln357">                              //ie = new InspectorIname(this);</a>
<a name="ln358">                              break;</a>
<a name="ln359">                        case ElementType::FINGERING:</a>
<a name="ln360">                              ie = new InspectorFingering(this);</a>
<a name="ln361">                              break;</a>
<a name="ln362">                        case ElementType::STICKING:</a>
<a name="ln363">                              ie = new InspectorText(this); // TODO: add a separate inspector for sticking?</a>
<a name="ln364">                              break;</a>
<a name="ln365">                        case ElementType::STEM:</a>
<a name="ln366">                              ie = new InspectorStem(this);</a>
<a name="ln367">                              break;</a>
<a name="ln368">                        case ElementType::HARMONY:</a>
<a name="ln369">                              ie = new InspectorHarmony(this);</a>
<a name="ln370">                              break;</a>
<a name="ln371">                        case ElementType::VIBRATO_SEGMENT:</a>
<a name="ln372">                              ie = new InspectorVibrato(this);</a>
<a name="ln373">                              break;</a>
<a name="ln374">                        case ElementType::NOTEDOT:</a>
<a name="ln375">                              ie = new InspectorNoteDot(this);</a>
<a name="ln376">                              break;</a>
<a name="ln377">                        default:</a>
<a name="ln378">                              if (element()-&gt;isText())</a>
<a name="ln379">                                    ie = new InspectorText(this);</a>
<a name="ln380">                              else</a>
<a name="ln381">                                    ie = new InspectorElement(this);</a>
<a name="ln382">                              break;</a>
<a name="ln383">                        }</a>
<a name="ln384">                  }</a>
<a name="ln385">            connect(ie, &amp;InspectorBase::elementChanged, this, QOverload&lt;&gt;::of(&amp;Inspector::update), Qt::QueuedConnection);</a>
<a name="ln386">            sa-&gt;setWidget(ie);      // will destroy previous set widget</a>
<a name="ln387"> </a>
<a name="ln388">            //focus policies were set by hand in each inspector_*.ui. this code just helps keeping them like they are</a>
<a name="ln389">            //also fixes mac problem. on Mac Qt::TabFocus doesn't work, but Qt::StrongFocus works</a>
<a name="ln390">            QList&lt;QWidget*&gt; widgets = ie-&gt;findChildren&lt;QWidget*&gt;();</a>
<a name="ln391">            for (int i = 0; i &lt; widgets.size(); i++) {</a>
<a name="ln392">                  QWidget* currentWidget = widgets.at(i);</a>
<a name="ln393">                  switch (currentWidget-&gt;focusPolicy()) {</a>
<a name="ln394">                        case Qt::WheelFocus:</a>
<a name="ln395">                        case Qt::StrongFocus:</a>
<a name="ln396">                              if (currentWidget-&gt;inherits(&quot;QComboBox&quot;)                  ||</a>
<a name="ln397">                                  currentWidget-&gt;parent()-&gt;inherits(&quot;QAbstractSpinBox&quot;) ||</a>
<a name="ln398">                                  currentWidget-&gt;inherits(&quot;QAbstractSpinBox&quot;)           ||</a>
<a name="ln399">                                  currentWidget-&gt;inherits(&quot;QLineEdit&quot;)) ; //leave it like it is</a>
<a name="ln400">                              else</a>
<a name="ln401">                                   currentWidget-&gt;setFocusPolicy(Qt::TabFocus);</a>
<a name="ln402">                              break;</a>
<a name="ln403">                        case Qt::NoFocus:</a>
<a name="ln404">                        case Qt::ClickFocus:</a>
<a name="ln405">                                    currentWidget-&gt;setFocusPolicy(Qt::NoFocus);</a>
<a name="ln406">                              break;</a>
<a name="ln407">                        case Qt::TabFocus:</a>
<a name="ln408">                              break;</a>
<a name="ln409">                        }</a>
<a name="ln410">                  }</a>
<a name="ln411">            }</a>
<a name="ln412">      if (ie)</a>
<a name="ln413">            ie-&gt;setElement();</a>
<a name="ln414">      }</a>
<a name="ln415"> </a>
<a name="ln416">//---------------------------------------------------------</a>
<a name="ln417">//   changeEvent</a>
<a name="ln418">//---------------------------------------------------------</a>
<a name="ln419"> </a>
<a name="ln420">void Inspector::changeEvent(QEvent *event)</a>
<a name="ln421">      {</a>
<a name="ln422">      QDockWidget::changeEvent(event);</a>
<a name="ln423">      if (event-&gt;type() == QEvent::LanguageChange)</a>
<a name="ln424">            retranslate();</a>
<a name="ln425">      }</a>
<a name="ln426"> </a>
<a name="ln427">//---------------------------------------------------------</a>
<a name="ln428">//   setupUi</a>
<a name="ln429">//---------------------------------------------------------</a>
<a name="ln430"> </a>
<a name="ln431">void UiInspectorElement::setupUi(QWidget* inspectorElement)</a>
<a name="ln432">      {</a>
<a name="ln433">      Ui::InspectorElement::setupUi(inspectorElement);</a>
<a name="ln434">      }</a>
<a name="ln435"> </a>
<a name="ln436">//---------------------------------------------------------</a>
<a name="ln437">//   InspectorElement</a>
<a name="ln438">//---------------------------------------------------------</a>
<a name="ln439"> </a>
<a name="ln440">InspectorElement::InspectorElement(QWidget* parent)</a>
<a name="ln441">   : InspectorElementBase(parent)</a>
<a name="ln442">      {</a>
<a name="ln443">      mapSignals();</a>
<a name="ln444">      }</a>
<a name="ln445"> </a>
<a name="ln446">//---------------------------------------------------------</a>
<a name="ln447">//   InspectorBreak</a>
<a name="ln448">//---------------------------------------------------------</a>
<a name="ln449"> </a>
<a name="ln450">InspectorBreak::InspectorBreak(QWidget* parent)</a>
<a name="ln451">   : InspectorBase(parent)</a>
<a name="ln452">      {</a>
<a name="ln453">      b.setupUi(addWidget());</a>
<a name="ln454"> </a>
<a name="ln455">      iList = {         // currently empty</a>
<a name="ln456">            };</a>
<a name="ln457"> </a>
<a name="ln458">      mapSignals();</a>
<a name="ln459">      }</a>
<a name="ln460"> </a>
<a name="ln461">//---------------------------------------------------------</a>
<a name="ln462">//   InspectorSectionBreak</a>
<a name="ln463">//---------------------------------------------------------</a>
<a name="ln464"> </a>
<a name="ln465">InspectorSectionBreak::InspectorSectionBreak(QWidget* parent)</a>
<a name="ln466">   : InspectorBase(parent)</a>
<a name="ln467">      {</a>
<a name="ln468">      scb.setupUi(addWidget());</a>
<a name="ln469"> </a>
<a name="ln470">      iList = {</a>
<a name="ln471">            { Pid::PAUSE,                   0, scb.pause,               scb.resetPause               },</a>
<a name="ln472">            { Pid::START_WITH_LONG_NAMES,   0, scb.startWithLongNames,  scb.resetStartWithLongNames  },</a>
<a name="ln473">            { Pid::START_WITH_MEASURE_ONE,  0, scb.startWithMeasureOne, scb.resetStartWithMeasureOne }</a>
<a name="ln474">            };</a>
<a name="ln475">      mapSignals();</a>
<a name="ln476">      }</a>
<a name="ln477"> </a>
<a name="ln478">//---------------------------------------------------------</a>
<a name="ln479">//   InspectorStaffTypeChange</a>
<a name="ln480">//---------------------------------------------------------</a>
<a name="ln481"> </a>
<a name="ln482">InspectorStaffTypeChange::InspectorStaffTypeChange(QWidget* parent)</a>
<a name="ln483">   : InspectorBase(parent)</a>
<a name="ln484">      {</a>
<a name="ln485">      sl.setupUi(addWidget());</a>
<a name="ln486"> </a>
<a name="ln487">      iList = {</a>
<a name="ln488">            { Pid::STAFF_YOFFSET,          0, sl.yoffset,         sl.resetYoffset         },</a>
<a name="ln489">            { Pid::SMALL,                  0, sl.small,           sl.resetSmall           },</a>
<a name="ln490">            { Pid::MAG,                    0, sl.scale,           sl.resetScale           },</a>
<a name="ln491">            { Pid::STAFF_LINES,            0, sl.lines,           sl.resetLines           },</a>
<a name="ln492">            { Pid::STEP_OFFSET,            0, sl.stepOffset,      sl.resetStepOffset      },</a>
<a name="ln493">            { Pid::LINE_DISTANCE,          0, sl.lineDistance,    sl.resetLineDistance    },</a>
<a name="ln494">            { Pid::STAFF_SHOW_BARLINES,    0, sl.showBarlines,    sl.resetShowBarlines    },</a>
<a name="ln495">            { Pid::STAFF_SHOW_LEDGERLINES, 0, sl.showLedgerlines, sl.resetShowLedgerlines },</a>
<a name="ln496">            { Pid::STAFF_STEMLESS,         0, sl.stemless,        sl.resetStemless        },</a>
<a name="ln497">            { Pid::STAFF_NOTEHEAD_SCHEME,  0, sl.noteheadScheme,  sl.resetNoteheadScheme  },</a>
<a name="ln498">            { Pid::STAFF_GEN_CLEF,         0, sl.genClefs,        sl.resetGenClefs        },</a>
<a name="ln499">            { Pid::STAFF_GEN_TIMESIG,      0, sl.genTimesig,      sl.resetGenTimesig      },</a>
<a name="ln500">            { Pid::STAFF_GEN_KEYSIG,       0, sl.genKeysig,       sl.resetGenKeysig       },</a>
<a name="ln501">            };</a>
<a name="ln502"> </a>
<a name="ln503">      sl.noteheadScheme-&gt;clear();</a>
<a name="ln504">      for (auto i : { NoteHeadScheme::HEAD_NORMAL,</a>
<a name="ln505">         NoteHeadScheme::HEAD_PITCHNAME,</a>
<a name="ln506">         NoteHeadScheme::HEAD_PITCHNAME_GERMAN,</a>
<a name="ln507">         NoteHeadScheme::HEAD_SOLFEGE,</a>
<a name="ln508">         NoteHeadScheme::HEAD_SOLFEGE_FIXED,</a>
<a name="ln509">         NoteHeadScheme::HEAD_SHAPE_NOTE_4,</a>
<a name="ln510">         NoteHeadScheme::HEAD_SHAPE_NOTE_7_AIKIN,</a>
<a name="ln511">         NoteHeadScheme::HEAD_SHAPE_NOTE_7_FUNK,</a>
<a name="ln512">         NoteHeadScheme::HEAD_SHAPE_NOTE_7_WALKER} ) {</a>
<a name="ln513">            sl.noteheadScheme-&gt;addItem(StaffType::scheme2userName(i), int(i));</a>
<a name="ln514">            }</a>
<a name="ln515">      mapSignals();</a>
<a name="ln516">      }</a>
<a name="ln517"> </a>
<a name="ln518">//---------------------------------------------------------</a>
<a name="ln519">//   setElement</a>
<a name="ln520">//---------------------------------------------------------</a>
<a name="ln521"> </a>
<a name="ln522">void InspectorStaffTypeChange::setElement()</a>
<a name="ln523">      {</a>
<a name="ln524">      InspectorBase::setElement();</a>
<a name="ln525">      bool hasTabStaff = false;</a>
<a name="ln526">      bool hasNonTabStaff = false;</a>
<a name="ln527">      for (Element* el : *(inspector-&gt;el())) {</a>
<a name="ln528">            StaffTypeChange* stc = toStaffTypeChange(el);</a>
<a name="ln529">            // tab staff shouldn't have key signature</a>
<a name="ln530">            if (stc-&gt;staffType()-&gt;group() == StaffGroup::TAB) {</a>
<a name="ln531">                  hasTabStaff = true;</a>
<a name="ln532">                  sl.genKeysig-&gt;setEnabled(false);</a>
<a name="ln533">                  sl.resetGenKeysig-&gt;setEnabled(false);</a>
<a name="ln534">                  }</a>
<a name="ln535">            else {</a>
<a name="ln536">                  hasNonTabStaff = true;</a>
<a name="ln537">                  }</a>
<a name="ln538">            }</a>
<a name="ln539">      if (hasTabStaff &amp;&amp; !hasNonTabStaff)</a>
<a name="ln540">            sl.genKeysig-&gt;setChecked(false);</a>
<a name="ln541">      }</a>
<a name="ln542"> </a>
<a name="ln543">//---------------------------------------------------------</a>
<a name="ln544">//   InspectorVBox</a>
<a name="ln545">//---------------------------------------------------------</a>
<a name="ln546"> </a>
<a name="ln547">InspectorVBox::InspectorVBox(QWidget* parent)</a>
<a name="ln548">   : InspectorBase(parent)</a>
<a name="ln549">      {</a>
<a name="ln550">      vb.setupUi(addWidget());</a>
<a name="ln551"> </a>
<a name="ln552">      iList = {</a>
<a name="ln553">            { Pid::TOP_GAP,       0, vb.topGap,       vb.resetTopGap       },</a>
<a name="ln554">            { Pid::BOTTOM_GAP,    0, vb.bottomGap,    vb.resetBottomGap    },</a>
<a name="ln555">            { Pid::LEFT_MARGIN,   0, vb.leftMargin,   vb.resetLeftMargin   },</a>
<a name="ln556">            { Pid::RIGHT_MARGIN,  0, vb.rightMargin,  vb.resetRightMargin  },</a>
<a name="ln557">            { Pid::TOP_MARGIN,    0, vb.topMargin,    vb.resetTopMargin    },</a>
<a name="ln558">            { Pid::BOTTOM_MARGIN, 0, vb.bottomMargin, vb.resetBottomMargin },</a>
<a name="ln559">            { Pid::BOX_HEIGHT,    0, vb.height,       0                    }</a>
<a name="ln560">            };</a>
<a name="ln561">      mapSignals();</a>
<a name="ln562">      }</a>
<a name="ln563"> </a>
<a name="ln564">//---------------------------------------------------------</a>
<a name="ln565">//   InspectorTBox</a>
<a name="ln566">//---------------------------------------------------------</a>
<a name="ln567"> </a>
<a name="ln568">InspectorTBox::InspectorTBox(QWidget* parent)</a>
<a name="ln569">   : InspectorBase(parent)</a>
<a name="ln570">      {</a>
<a name="ln571">      tb.setupUi(addWidget());</a>
<a name="ln572"> </a>
<a name="ln573">      iList = {</a>
<a name="ln574">            { Pid::TOP_GAP,       0, tb.topGap,       tb.resetTopGap       },</a>
<a name="ln575">            { Pid::BOTTOM_GAP,    0, tb.bottomGap,    tb.resetBottomGap    },</a>
<a name="ln576">            { Pid::LEFT_MARGIN,   0, tb.leftMargin,   tb.resetLeftMargin   },</a>
<a name="ln577">            { Pid::RIGHT_MARGIN,  0, tb.rightMargin,  tb.resetRightMargin  },</a>
<a name="ln578">            { Pid::TOP_MARGIN,    0, tb.topMargin,    tb.resetTopMargin    },</a>
<a name="ln579">            { Pid::BOTTOM_MARGIN, 0, tb.bottomMargin, tb.resetBottomMargin },</a>
<a name="ln580">            };</a>
<a name="ln581">      mapSignals();</a>
<a name="ln582">      }</a>
<a name="ln583"> </a>
<a name="ln584">//---------------------------------------------------------</a>
<a name="ln585">//   InspectorHBox</a>
<a name="ln586">//---------------------------------------------------------</a>
<a name="ln587"> </a>
<a name="ln588">InspectorHBox::InspectorHBox(QWidget* parent)</a>
<a name="ln589">   : InspectorBase(parent)</a>
<a name="ln590">      {</a>
<a name="ln591">      hb.setupUi(addWidget());</a>
<a name="ln592"> </a>
<a name="ln593">      iList = {</a>
<a name="ln594">            { Pid::TOP_GAP,               0, hb.leftGap,  hb.resetLeftGap  },</a>
<a name="ln595">            { Pid::BOTTOM_GAP,            0, hb.rightGap, hb.resetRightGap },</a>
<a name="ln596">            { Pid::BOX_WIDTH,             0, hb.width,    0                },</a>
<a name="ln597">            { Pid::CREATE_SYSTEM_HEADER,  0, hb.createSystemHeader, hb.resetCreateSystemHeader }</a>
<a name="ln598">            };</a>
<a name="ln599"> </a>
<a name="ln600">      mapSignals();</a>
<a name="ln601">      }</a>
<a name="ln602"> </a>
<a name="ln603">//---------------------------------------------------------</a>
<a name="ln604">//   InspectorArticulation</a>
<a name="ln605">//---------------------------------------------------------</a>
<a name="ln606"> </a>
<a name="ln607">InspectorArticulation::InspectorArticulation(QWidget* parent)</a>
<a name="ln608">   : InspectorElementBase(parent)</a>
<a name="ln609">      {</a>
<a name="ln610">      ar.setupUi(addWidget());</a>
<a name="ln611"> </a>
<a name="ln612">      Articulation* el = toArticulation(inspector-&gt;element());</a>
<a name="ln613">      bool sameTypes = true;</a>
<a name="ln614"> </a>
<a name="ln615">      for (const auto&amp; ee : *inspector-&gt;el()) {</a>
<a name="ln616">            if (toArticulation(ee)-&gt;isOrnament() != el-&gt;isOrnament()) {</a>
<a name="ln617">                  sameTypes = false;</a>
<a name="ln618">                  break;</a>
<a name="ln619">                  }</a>
<a name="ln620">            }</a>
<a name="ln621">      if (sameTypes)</a>
<a name="ln622">            ar.title-&gt;setText(el-&gt;isOrnament() ? tr(&quot;Ornament&quot;) : tr(&quot;Articulation&quot;));</a>
<a name="ln623"> </a>
<a name="ln624">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln625">            { Pid::ARTICULATION_ANCHOR, 0, ar.anchor,           ar.resetAnchor           },</a>
<a name="ln626">            { Pid::DIRECTION,           0, ar.direction,        ar.resetDirection        },</a>
<a name="ln627">            { Pid::TIME_STRETCH,        0, ar.timeStretch,      ar.resetTimeStretch      },</a>
<a name="ln628">            { Pid::ORNAMENT_STYLE,      0, ar.ornamentStyle,    ar.resetOrnamentStyle    },</a>
<a name="ln629">            { Pid::PLAY,                0, ar.playArticulation, ar.resetPlayArticulation }</a>
<a name="ln630">            };</a>
<a name="ln631">      const std::vector&lt;InspectorPanel&gt; ppList = { { ar.title, ar.panel } };</a>
<a name="ln632">      mapSignals(iiList, ppList);</a>
<a name="ln633">      connect(ar.properties, SIGNAL(clicked()), SLOT(propertiesClicked()));</a>
<a name="ln634">      }</a>
<a name="ln635"> </a>
<a name="ln636">//---------------------------------------------------------</a>
<a name="ln637">//   propertiesClicked</a>
<a name="ln638">//---------------------------------------------------------</a>
<a name="ln639"> </a>
<a name="ln640">void InspectorArticulation::propertiesClicked()</a>
<a name="ln641">      {</a>
<a name="ln642">      Articulation* a = toArticulation(inspector-&gt;element());</a>
<a name="ln643">      Score* score = a-&gt;score();</a>
<a name="ln644">      score-&gt;startCmd();</a>
<a name="ln645">      mscore-&gt;currentScoreView()-&gt;editArticulationProperties(a);</a>
<a name="ln646">      a-&gt;triggerLayoutAll();</a>
<a name="ln647">      score-&gt;endCmd();</a>
<a name="ln648">      }</a>
<a name="ln649"> </a>
<a name="ln650">//---------------------------------------------------------</a>
<a name="ln651">//   setElement</a>
<a name="ln652">//---------------------------------------------------------</a>
<a name="ln653"> </a>
<a name="ln654">void InspectorArticulation::setElement()</a>
<a name="ln655">      {</a>
<a name="ln656">      InspectorElementBase::setElement();</a>
<a name="ln657">      if (!ar.playArticulation-&gt;isChecked()) {</a>
<a name="ln658">            ar.gridWidget-&gt;setEnabled(false);</a>
<a name="ln659">            }</a>
<a name="ln660">      }</a>
<a name="ln661"> </a>
<a name="ln662">//---------------------------------------------------------</a>
<a name="ln663">//   InspectorFermata</a>
<a name="ln664">//---------------------------------------------------------</a>
<a name="ln665"> </a>
<a name="ln666">InspectorFermata::InspectorFermata(QWidget* parent)</a>
<a name="ln667">   : InspectorElementBase(parent)</a>
<a name="ln668">      {</a>
<a name="ln669">      f.setupUi(addWidget());</a>
<a name="ln670"> </a>
<a name="ln671">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln672">            { Pid::PLACEMENT,           0, f.placement,        f.resetPlacement        },</a>
<a name="ln673">            { Pid::TIME_STRETCH,        0, f.timeStretch,      f.resetTimeStretch      },</a>
<a name="ln674">            { Pid::PLAY,                0, f.playArticulation, f.resetPlayArticulation }</a>
<a name="ln675">            };</a>
<a name="ln676">      const std::vector&lt;InspectorPanel&gt; ppList = { { f.title, f.panel } };</a>
<a name="ln677">      mapSignals(iiList, ppList);</a>
<a name="ln678">      }</a>
<a name="ln679"> </a>
<a name="ln680">//---------------------------------------------------------</a>
<a name="ln681">//   setElement</a>
<a name="ln682">//---------------------------------------------------------</a>
<a name="ln683"> </a>
<a name="ln684">void InspectorFermata::setElement()</a>
<a name="ln685">      {</a>
<a name="ln686">      InspectorElementBase::setElement();</a>
<a name="ln687">      if (!f.playArticulation-&gt;isChecked()) {</a>
<a name="ln688">            f.labelTimeStretch-&gt;setEnabled(false);</a>
<a name="ln689">            f.timeStretch-&gt;setEnabled(false);</a>
<a name="ln690">            f.resetTimeStretch-&gt;setEnabled(false);</a>
<a name="ln691">            }</a>
<a name="ln692">      }</a>
<a name="ln693"> </a>
<a name="ln694">//---------------------------------------------------------</a>
<a name="ln695">//   InspectorSpacer</a>
<a name="ln696">//---------------------------------------------------------</a>
<a name="ln697"> </a>
<a name="ln698">InspectorSpacer::InspectorSpacer(QWidget* parent)</a>
<a name="ln699">   : InspectorBase(parent)</a>
<a name="ln700">      {</a>
<a name="ln701">      sp.setupUi(addWidget());</a>
<a name="ln702"> </a>
<a name="ln703">      iList = {</a>
<a name="ln704">            { Pid::SPACE, 0, sp.height, 0 }</a>
<a name="ln705">            };</a>
<a name="ln706">      mapSignals();</a>
<a name="ln707">      }</a>
<a name="ln708"> </a>
<a name="ln709">//---------------------------------------------------------</a>
<a name="ln710">//   InspectorRest</a>
<a name="ln711">//---------------------------------------------------------</a>
<a name="ln712"> </a>
<a name="ln713">InspectorRest::InspectorRest(QWidget* parent)</a>
<a name="ln714">   : InspectorElementBase(parent)</a>
<a name="ln715">      {</a>
<a name="ln716">      s.setupUi(addWidget());</a>
<a name="ln717">      r.setupUi(addWidget());</a>
<a name="ln718"> </a>
<a name="ln719">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln720">            { Pid::LEADING_SPACE,  1, s.leadingSpace,  s.resetLeadingSpace  },</a>
<a name="ln721">            { Pid::SMALL,          0, r.small,         r.resetSmall         },</a>
<a name="ln722">            };</a>
<a name="ln723">      const std::vector&lt;InspectorPanel&gt; ppList = {</a>
<a name="ln724">            { s.title, s.panel },</a>
<a name="ln725">            { r.title, r.panel }</a>
<a name="ln726">            };</a>
<a name="ln727">      mapSignals(iiList, ppList);</a>
<a name="ln728"> </a>
<a name="ln729">      //</a>
<a name="ln730">      // Select</a>
<a name="ln731">      //</a>
<a name="ln732">      QLabel* l = new QLabel;</a>
<a name="ln733">      l-&gt;setText(tr(&quot;Select&quot;));</a>
<a name="ln734">      QFont font(l-&gt;font());</a>
<a name="ln735">      font.setBold(true);</a>
<a name="ln736">      l-&gt;setFont(font);</a>
<a name="ln737">      l-&gt;setAlignment(Qt::AlignHCenter);</a>
<a name="ln738">      _layout-&gt;addWidget(l);</a>
<a name="ln739"> </a>
<a name="ln740">      QVBoxLayout* vbox = new QVBoxLayout;</a>
<a name="ln741">      vbox-&gt;setSpacing(3);</a>
<a name="ln742">      vbox-&gt;setContentsMargins(3,3,3,3);</a>
<a name="ln743">      _layout-&gt;addLayout(vbox);</a>
<a name="ln744"> </a>
<a name="ln745">      QHBoxLayout* hbox = new QHBoxLayout;</a>
<a name="ln746">      hbox-&gt;setSpacing(3);</a>
<a name="ln747">      dot1 = new QPushButton(this);</a>
<a name="ln748">      dot1-&gt;setText(tr(&quot;Dot 1&quot;));</a>
<a name="ln749">      hbox-&gt;addWidget(dot1);</a>
<a name="ln750">      dot2 = new QPushButton(this);</a>
<a name="ln751">      dot2-&gt;setText(tr(&quot;Dot 2&quot;));</a>
<a name="ln752">      hbox-&gt;addWidget(dot2);</a>
<a name="ln753">      dot3 = new QPushButton(this);</a>
<a name="ln754">      dot3-&gt;setText(tr(&quot;Dot 3&quot;));</a>
<a name="ln755">      hbox-&gt;addWidget(dot3);</a>
<a name="ln756">      vbox-&gt;addLayout(hbox);</a>
<a name="ln757"> </a>
<a name="ln758">      hbox = new QHBoxLayout;</a>
<a name="ln759">      hbox-&gt;setSpacing(3);</a>
<a name="ln760">      dot4 = new QPushButton(this);</a>
<a name="ln761">      dot4-&gt;setText(tr(&quot;Dot 4&quot;));</a>
<a name="ln762">      hbox-&gt;addWidget(dot4);</a>
<a name="ln763">      tuplet = new QPushButton(this);</a>
<a name="ln764">      tuplet-&gt;setText(tr(&quot;Tuplet&quot;));</a>
<a name="ln765">      tuplet-&gt;setEnabled(false);</a>
<a name="ln766">      hbox-&gt;addWidget(tuplet);</a>
<a name="ln767">      vbox-&gt;addLayout(hbox);</a>
<a name="ln768"> </a>
<a name="ln769">//TODO      e.offset-&gt;setSingleStep(1.0);        // step in spatium units</a>
<a name="ln770"> </a>
<a name="ln771">      connect(dot1,     SIGNAL(clicked()),     SLOT(dot1Clicked()));</a>
<a name="ln772">      connect(dot2,     SIGNAL(clicked()),     SLOT(dot2Clicked()));</a>
<a name="ln773">      connect(dot3,     SIGNAL(clicked()),     SLOT(dot3Clicked()));</a>
<a name="ln774">      connect(dot4,     SIGNAL(clicked()),     SLOT(dot4Clicked()));</a>
<a name="ln775">      connect(tuplet,   SIGNAL(clicked()),     SLOT(tupletClicked()));</a>
<a name="ln776">      }</a>
<a name="ln777"> </a>
<a name="ln778">//---------------------------------------------------------</a>
<a name="ln779">//   setElement</a>
<a name="ln780">//---------------------------------------------------------</a>
<a name="ln781"> </a>
<a name="ln782">void InspectorRest::setElement()</a>
<a name="ln783">      {</a>
<a name="ln784">      Rest* rest = toRest(inspector-&gt;element());</a>
<a name="ln785">      int dots = rest-&gt;dots();</a>
<a name="ln786">      dot1-&gt;setEnabled(dots &gt; 0);</a>
<a name="ln787">      dot2-&gt;setEnabled(dots &gt; 1);</a>
<a name="ln788">      dot3-&gt;setEnabled(dots &gt; 2);</a>
<a name="ln789">      dot4-&gt;setEnabled(dots &gt; 3);</a>
<a name="ln790">      tuplet-&gt;setEnabled(rest-&gt;tuplet());</a>
<a name="ln791">      InspectorElementBase::setElement();</a>
<a name="ln792">      }</a>
<a name="ln793"> </a>
<a name="ln794">//---------------------------------------------------------</a>
<a name="ln795">//   dotClicked</a>
<a name="ln796">//---------------------------------------------------------</a>
<a name="ln797"> </a>
<a name="ln798">void InspectorRest::dotClicked(int n)</a>
<a name="ln799">      {</a>
<a name="ln800">      Rest* rest = toRest(inspector-&gt;element());</a>
<a name="ln801">      if (rest == 0)</a>
<a name="ln802">            return;</a>
<a name="ln803">      if (rest-&gt;dots() &gt; n) {</a>
<a name="ln804">            NoteDot* dot = rest-&gt;dot(n);</a>
<a name="ln805">            dot-&gt;score()-&gt;select(dot);</a>
<a name="ln806">            dot-&gt;score()-&gt;update();</a>
<a name="ln807">            inspector-&gt;update();</a>
<a name="ln808">            }</a>
<a name="ln809">      }</a>
<a name="ln810"> </a>
<a name="ln811">//---------------------------------------------------------</a>
<a name="ln812">//   dot1Clicked</a>
<a name="ln813">//---------------------------------------------------------</a>
<a name="ln814"> </a>
<a name="ln815">void InspectorRest::dot1Clicked()</a>
<a name="ln816">      {</a>
<a name="ln817">      dotClicked(0);</a>
<a name="ln818">      }</a>
<a name="ln819"> </a>
<a name="ln820">//---------------------------------------------------------</a>
<a name="ln821">//   dot2Clicked</a>
<a name="ln822">//---------------------------------------------------------</a>
<a name="ln823"> </a>
<a name="ln824">void InspectorRest::dot2Clicked()</a>
<a name="ln825">      {</a>
<a name="ln826">      dotClicked(1);</a>
<a name="ln827">      }</a>
<a name="ln828"> </a>
<a name="ln829">//---------------------------------------------------------</a>
<a name="ln830">//   dot3Clicked</a>
<a name="ln831">//---------------------------------------------------------</a>
<a name="ln832"> </a>
<a name="ln833">void InspectorRest::dot3Clicked()</a>
<a name="ln834">      {</a>
<a name="ln835">      dotClicked(2);</a>
<a name="ln836">      }</a>
<a name="ln837"> </a>
<a name="ln838">//---------------------------------------------------------</a>
<a name="ln839">//   dot4Clicked</a>
<a name="ln840">//---------------------------------------------------------</a>
<a name="ln841"> </a>
<a name="ln842">void InspectorRest::dot4Clicked()</a>
<a name="ln843">      {</a>
<a name="ln844">      dotClicked(3);</a>
<a name="ln845">      }</a>
<a name="ln846"> </a>
<a name="ln847">//---------------------------------------------------------</a>
<a name="ln848">//   tupletClicked</a>
<a name="ln849">//---------------------------------------------------------</a>
<a name="ln850"> </a>
<a name="ln851">void InspectorRest::tupletClicked()</a>
<a name="ln852">      {</a>
<a name="ln853">      Rest* rest = toRest(inspector-&gt;element());</a>
<a name="ln854">      if (rest == 0)</a>
<a name="ln855">            return;</a>
<a name="ln856">      Tuplet* t = rest-&gt;tuplet();</a>
<a name="ln857">      if (t) {</a>
<a name="ln858">            rest-&gt;score()-&gt;select(t);</a>
<a name="ln859">            rest-&gt;score()-&gt;update();</a>
<a name="ln860">            inspector-&gt;update();</a>
<a name="ln861">            }</a>
<a name="ln862">      }</a>
<a name="ln863"> </a>
<a name="ln864">//---------------------------------------------------------</a>
<a name="ln865">//   InspectorTimeSig</a>
<a name="ln866">//---------------------------------------------------------</a>
<a name="ln867"> </a>
<a name="ln868">InspectorTimeSig::InspectorTimeSig(QWidget* parent)</a>
<a name="ln869">   : InspectorElementBase(parent)</a>
<a name="ln870">      {</a>
<a name="ln871">      s.setupUi(addWidget());</a>
<a name="ln872">      t.setupUi(addWidget());</a>
<a name="ln873"> </a>
<a name="ln874">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln875">            { Pid::LEADING_SPACE,  1, s.leadingSpace,   s.resetLeadingSpace  },</a>
<a name="ln876">            { Pid::SHOW_COURTESY,  0, t.showCourtesy,   t.resetShowCourtesy  },</a>
<a name="ln877">            { Pid::SCALE,          0, t.scale,          t.resetScale         },</a>
<a name="ln878">//          { Pid::TIMESIG,        0, t.timesigZ,       t.resetTimesig       },</a>
<a name="ln879">//          { Pid::TIMESIG,        0, t.timesigN,       t.resetTimesig       },</a>
<a name="ln880">//          { Pid::TIMESIG_GLOBAL, 0, t.globalTimesigZ, t.resetGlobalTimesig },</a>
<a name="ln881">//          { Pid::TIMESIG_GLOBAL, 0, t.globalTimesigN, t.resetGlobalTimesig }</a>
<a name="ln882">            };</a>
<a name="ln883">      const std::vector&lt;InspectorPanel&gt; ppList = {</a>
<a name="ln884">            { s.title, s.panel },</a>
<a name="ln885">            { t.title, t.panel }</a>
<a name="ln886">            };</a>
<a name="ln887">      mapSignals(iiList, ppList);</a>
<a name="ln888">      connect(t.properties, SIGNAL(clicked()), SLOT(propertiesClicked()));</a>
<a name="ln889">      }</a>
<a name="ln890"> </a>
<a name="ln891">//---------------------------------------------------------</a>
<a name="ln892">//   propertiesClicked</a>
<a name="ln893">//---------------------------------------------------------</a>
<a name="ln894"> </a>
<a name="ln895">void InspectorTimeSig::propertiesClicked()</a>
<a name="ln896">      {</a>
<a name="ln897">      TimeSig* ts = toTimeSig(inspector-&gt;element());</a>
<a name="ln898">      Score* score = ts-&gt;score();</a>
<a name="ln899">      score-&gt;startCmd();</a>
<a name="ln900">      mscore-&gt;currentScoreView()-&gt;editTimeSigProperties(ts);</a>
<a name="ln901">      ts-&gt;triggerLayoutAll();</a>
<a name="ln902">      score-&gt;endCmd();</a>
<a name="ln903">      }</a>
<a name="ln904"> </a>
<a name="ln905">//---------------------------------------------------------</a>
<a name="ln906">//   setElement</a>
<a name="ln907">//---------------------------------------------------------</a>
<a name="ln908"> </a>
<a name="ln909">void InspectorTimeSig::setElement()</a>
<a name="ln910">      {</a>
<a name="ln911">      InspectorElementBase::setElement();</a>
<a name="ln912">      TimeSig* ts = toTimeSig(inspector-&gt;element());</a>
<a name="ln913">      if (ts-&gt;generated())</a>
<a name="ln914">            t.showCourtesy-&gt;setEnabled(false);</a>
<a name="ln915">      }</a>
<a name="ln916"> </a>
<a name="ln917">//---------------------------------------------------------</a>
<a name="ln918">//   InspectorKeySig</a>
<a name="ln919">//---------------------------------------------------------</a>
<a name="ln920"> </a>
<a name="ln921">InspectorKeySig::InspectorKeySig(QWidget* parent)</a>
<a name="ln922">   : InspectorElementBase(parent)</a>
<a name="ln923">      {</a>
<a name="ln924">      s.setupUi(addWidget());</a>
<a name="ln925">      k.setupUi(addWidget());</a>
<a name="ln926"> </a>
<a name="ln927">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln928">            { Pid::LEADING_SPACE,  1, s.leadingSpace,  s.resetLeadingSpace  },</a>
<a name="ln929">            { Pid::SHOW_COURTESY,  0, k.showCourtesy,  k.resetShowCourtesy  },</a>
<a name="ln930">//          { Pid::SHOW_NATURALS,  0, k.showNaturals,  k.resetShowNaturals  }</a>
<a name="ln931">            { Pid::KEYSIG_MODE,    0, k.keysigMode,    k.resetKeysigMode    }</a>
<a name="ln932">            };</a>
<a name="ln933">      const std::vector&lt;InspectorPanel&gt; ppList = {</a>
<a name="ln934">            { s.title, s.panel },</a>
<a name="ln935">            { k.title, k.panel }</a>
<a name="ln936">            };</a>
<a name="ln937">      k.keysigMode-&gt;clear();</a>
<a name="ln938">      k.keysigMode-&gt;addItem(tr(&quot;Unknown&quot;),    int(KeyMode::UNKNOWN));</a>
<a name="ln939">      k.keysigMode-&gt;addItem(tr(&quot;None&quot;),       int(KeyMode::NONE));</a>
<a name="ln940">      k.keysigMode-&gt;addItem(tr(&quot;Major&quot;),      int(KeyMode::MAJOR));</a>
<a name="ln941">      k.keysigMode-&gt;addItem(tr(&quot;Minor&quot;),      int(KeyMode::MINOR));</a>
<a name="ln942">      k.keysigMode-&gt;addItem(tr(&quot;Dorian&quot;),     int(KeyMode::DORIAN));</a>
<a name="ln943">      k.keysigMode-&gt;addItem(tr(&quot;Phrygian&quot;),   int(KeyMode::PHRYGIAN));</a>
<a name="ln944">      k.keysigMode-&gt;addItem(tr(&quot;Lydian&quot;),     int(KeyMode::LYDIAN));</a>
<a name="ln945">      k.keysigMode-&gt;addItem(tr(&quot;Mixolydian&quot;), int(KeyMode::MIXOLYDIAN));</a>
<a name="ln946">      k.keysigMode-&gt;addItem(tr(&quot;Ionian&quot;),     int(KeyMode::IONIAN));</a>
<a name="ln947">      k.keysigMode-&gt;addItem(tr(&quot;Locrian&quot;),    int(KeyMode::LOCRIAN));</a>
<a name="ln948">      mapSignals(iiList, ppList);</a>
<a name="ln949">      }</a>
<a name="ln950"> </a>
<a name="ln951">//---------------------------------------------------------</a>
<a name="ln952">//   setElement</a>
<a name="ln953">//---------------------------------------------------------</a>
<a name="ln954"> </a>
<a name="ln955">void InspectorKeySig::setElement()</a>
<a name="ln956">      {</a>
<a name="ln957">      InspectorElementBase::setElement();</a>
<a name="ln958">      KeySig* ks = toKeySig(inspector-&gt;element());</a>
<a name="ln959">      if (ks-&gt;generated()) {</a>
<a name="ln960">            k.showCourtesy-&gt;setEnabled(false);</a>
<a name="ln961">            k.keysigModeLabel-&gt;setEnabled(false);</a>
<a name="ln962">            k.keysigMode-&gt;setEnabled(false);</a>
<a name="ln963">            }</a>
<a name="ln964">      }</a>
<a name="ln965"> </a>
<a name="ln966">//---------------------------------------------------------</a>
<a name="ln967">//   InspectorTuplet</a>
<a name="ln968">//---------------------------------------------------------</a>
<a name="ln969"> </a>
<a name="ln970">InspectorTuplet::InspectorTuplet(QWidget* parent)</a>
<a name="ln971">   : InspectorElementBase(parent)</a>
<a name="ln972">      {</a>
<a name="ln973">      t.setupUi(addWidget());</a>
<a name="ln974"> </a>
<a name="ln975">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln976">            { Pid::FONT_FACE,      0, t.tupletFontFace,  t.resetTupletFontFace    },</a>
<a name="ln977">            { Pid::FONT_SIZE,      0, t.tupletFontSize,  t.resetTupletFontSize    },</a>
<a name="ln978">            { Pid::FONT_STYLE,     0, t.tupletFontStyle, t.resetTupletFontStyle   },</a>
<a name="ln979">            { Pid::DIRECTION,      0, t.direction,       t.resetDirection         },</a>
<a name="ln980">            { Pid::NUMBER_TYPE,    0, t.numberType,      t.resetNumberType        },</a>
<a name="ln981">            { Pid::BRACKET_TYPE,   0, t.bracketType,     t.resetBracketType       },</a>
<a name="ln982">            { Pid::LINE_WIDTH,     0, t.lineWidth,       t.resetLineWidth         },</a>
<a name="ln983">            { Pid::SIZE_SPATIUM_DEPENDENT,      0,    t.spatiumDependent,     t.resetSpatiumDependent },</a>
<a name="ln984">            };</a>
<a name="ln985">      const std::vector&lt;InspectorPanel&gt; ppList = { {t.title, t.panel} };</a>
<a name="ln986">      mapSignals(iiList, ppList);</a>
<a name="ln987">      }</a>
<a name="ln988"> </a>
<a name="ln989">//---------------------------------------------------------</a>
<a name="ln990">//   InspectorAccidental</a>
<a name="ln991">//---------------------------------------------------------</a>
<a name="ln992"> </a>
<a name="ln993">InspectorAccidental::InspectorAccidental(QWidget* parent)</a>
<a name="ln994">   : InspectorElementBase(parent)</a>
<a name="ln995">      {</a>
<a name="ln996">      a.setupUi(addWidget());</a>
<a name="ln997"> </a>
<a name="ln998">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln999">            { Pid::SMALL,               0, a.small,    a.resetSmall    },</a>
<a name="ln1000">            { Pid::ACCIDENTAL_BRACKET,  0, a.bracket,  a.resetBracket  }</a>
<a name="ln1001">            };</a>
<a name="ln1002">      a.bracket-&gt;clear();</a>
<a name="ln1003">      a.bracket-&gt;addItem(tr(&quot;None&quot;, &quot;no accidental bracket type&quot;), int(AccidentalBracket::NONE));</a>
<a name="ln1004">      a.bracket-&gt;addItem(tr(&quot;Parenthesis&quot;), int(AccidentalBracket::PARENTHESIS));</a>
<a name="ln1005">      a.bracket-&gt;addItem(tr(&quot;Bracket&quot;), int(AccidentalBracket::BRACKET));</a>
<a name="ln1006"> </a>
<a name="ln1007">      const std::vector&lt;InspectorPanel&gt; ppList = { { a.title, a.panel } };</a>
<a name="ln1008">      mapSignals(iiList, ppList);</a>
<a name="ln1009">      }</a>
<a name="ln1010"> </a>
<a name="ln1011">//---------------------------------------------------------</a>
<a name="ln1012">//   InspectorTremolo</a>
<a name="ln1013">//---------------------------------------------------------</a>
<a name="ln1014"> </a>
<a name="ln1015">InspectorTremolo::InspectorTremolo(QWidget* parent)</a>
<a name="ln1016">   : InspectorElementBase(parent)</a>
<a name="ln1017">      {</a>
<a name="ln1018">      g.setupUi(addWidget());</a>
<a name="ln1019"> </a>
<a name="ln1020">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln1021">            { Pid::TREMOLO_PLACEMENT, 0, g.tremoloPlacement, g.resetTremoloPlacement },</a>
<a name="ln1022">            };</a>
<a name="ln1023">      const std::vector&lt;InspectorPanel&gt; ppList = { { g.title, g.panel } };</a>
<a name="ln1024"> </a>
<a name="ln1025">      mapSignals(iiList, ppList);</a>
<a name="ln1026">      }</a>
<a name="ln1027"> </a>
<a name="ln1028">//---------------------------------------------------------</a>
<a name="ln1029">//   InspectorClef</a>
<a name="ln1030">//---------------------------------------------------------</a>
<a name="ln1031"> </a>
<a name="ln1032">InspectorClef::InspectorClef(QWidget* parent)</a>
<a name="ln1033">   : InspectorElementBase(parent)</a>
<a name="ln1034">      {</a>
<a name="ln1035">      s.setupUi(addWidget());</a>
<a name="ln1036">      c.setupUi(addWidget());</a>
<a name="ln1037"> </a>
<a name="ln1038">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln1039">            { Pid::LEADING_SPACE, 1, s.leadingSpace,  s.resetLeadingSpace  },</a>
<a name="ln1040">            { Pid::SHOW_COURTESY, 0, c.showCourtesy,  c.resetShowCourtesy  }</a>
<a name="ln1041">            };</a>
<a name="ln1042">      const std::vector&lt;InspectorPanel&gt; ppList = {</a>
<a name="ln1043">            { s.title, s.panel },</a>
<a name="ln1044">            { c.title, c.panel }</a>
<a name="ln1045">            };</a>
<a name="ln1046">      mapSignals(iiList, ppList);</a>
<a name="ln1047">      }</a>
<a name="ln1048"> </a>
<a name="ln1049">//---------------------------------------------------------</a>
<a name="ln1050">//   setElement</a>
<a name="ln1051">//---------------------------------------------------------</a>
<a name="ln1052"> </a>
<a name="ln1053">void InspectorClef::setElement()</a>
<a name="ln1054">      {</a>
<a name="ln1055">      otherClef = toClef(inspector-&gt;element())-&gt;otherClef();</a>
<a name="ln1056">      InspectorElementBase::setElement();</a>
<a name="ln1057">      }</a>
<a name="ln1058"> </a>
<a name="ln1059">//---------------------------------------------------------</a>
<a name="ln1060">//   valueChanged</a>
<a name="ln1061">//---------------------------------------------------------</a>
<a name="ln1062"> </a>
<a name="ln1063">void InspectorClef::valueChanged(int idx)</a>
<a name="ln1064">      {</a>
<a name="ln1065">      // copy into 'other clef' the ShowCouretsy ser of this clef</a>
<a name="ln1066">      Pid pid = iList[idx].t;</a>
<a name="ln1067">      if (pid == Pid::SHOW_COURTESY &amp;&amp; otherClef)</a>
<a name="ln1068">            otherClef-&gt;setShowCourtesy(c.showCourtesy-&gt;isChecked());</a>
<a name="ln1069">      InspectorBase::valueChanged(idx);</a>
<a name="ln1070">      }</a>
<a name="ln1071"> </a>
<a name="ln1072">//---------------------------------------------------------</a>
<a name="ln1073">//   InspectorStem</a>
<a name="ln1074">//---------------------------------------------------------</a>
<a name="ln1075"> </a>
<a name="ln1076">InspectorStem::InspectorStem(QWidget* parent)</a>
<a name="ln1077">   : InspectorElementBase(parent)</a>
<a name="ln1078">      {</a>
<a name="ln1079">      s.setupUi(addWidget());</a>
<a name="ln1080"> </a>
<a name="ln1081">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln1082">            { Pid::LINE_WIDTH,     0, s.lineWidth,     s.resetLineWidth     },</a>
<a name="ln1083">            { Pid::USER_LEN,       0, s.userLength,    s.resetUserLength    },</a>
<a name="ln1084">            { Pid::STEM_DIRECTION, 0, s.stemDirection, s.resetStemDirection }</a>
<a name="ln1085">            };</a>
<a name="ln1086">      const std::vector&lt;InspectorPanel&gt; ppList = { { s.title, s.panel } };</a>
<a name="ln1087">      mapSignals(iiList, ppList);</a>
<a name="ln1088">      }</a>
<a name="ln1089"> </a>
<a name="ln1090">//---------------------------------------------------------</a>
<a name="ln1091">//   populatePlacement</a>
<a name="ln1092">//---------------------------------------------------------</a>
<a name="ln1093"> </a>
<a name="ln1094">void populatePlacement(QComboBox* b)</a>
<a name="ln1095">      {</a>
<a name="ln1096">      b-&gt;clear();</a>
<a name="ln1097">      b-&gt;addItem(b-&gt;QObject::tr(&quot;Above&quot;), int(Placement::ABOVE));</a>
<a name="ln1098">      b-&gt;addItem(b-&gt;QObject::tr(&quot;Below&quot;), int(Placement::BELOW));</a>
<a name="ln1099">      }</a>
<a name="ln1100"> </a>
<a name="ln1101">//---------------------------------------------------------</a>
<a name="ln1102">//   InspectorTempoText</a>
<a name="ln1103">//---------------------------------------------------------</a>
<a name="ln1104"> </a>
<a name="ln1105">InspectorTempoText::InspectorTempoText(QWidget* parent)</a>
<a name="ln1106">   : InspectorTextBase(parent)</a>
<a name="ln1107">      {</a>
<a name="ln1108">      tt.setupUi(addWidget());</a>
<a name="ln1109"> </a>
<a name="ln1110">      const std::vector&lt;InspectorItem&gt; il = {</a>
<a name="ln1111">            { Pid::TEMPO,             0, tt.tempo,       tt.resetTempo       },</a>
<a name="ln1112">            { Pid::TEMPO_FOLLOW_TEXT, 0, tt.followText,  tt.resetFollowText  },</a>
<a name="ln1113">            { Pid::SUB_STYLE,         0, tt.style,       tt.resetStyle       },</a>
<a name="ln1114">            { Pid::PLACEMENT,         0, tt.placement,   tt.resetPlacement   }</a>
<a name="ln1115">            };</a>
<a name="ln1116">      const std::vector&lt;InspectorPanel&gt; ppList = {</a>
<a name="ln1117">            { tt.title, tt.panel }</a>
<a name="ln1118">            };</a>
<a name="ln1119">      populatePlacement(tt.placement);</a>
<a name="ln1120">      populateStyle(tt.style);</a>
<a name="ln1121">      mapSignals(il, ppList);</a>
<a name="ln1122">      connect(tt.followText, SIGNAL(toggled(bool)), tt.tempo, SLOT(setDisabled(bool)));</a>
<a name="ln1123">      }</a>
<a name="ln1124"> </a>
<a name="ln1125">//---------------------------------------------------------</a>
<a name="ln1126">//   postInit</a>
<a name="ln1127">//---------------------------------------------------------</a>
<a name="ln1128"> </a>
<a name="ln1129">void InspectorTempoText::postInit()</a>
<a name="ln1130">      {</a>
<a name="ln1131">      bool followText = tt.followText-&gt;isChecked();</a>
<a name="ln1132">      //tt.resetFollowText-&gt;setDisabled(followText);</a>
<a name="ln1133">      tt.tempo-&gt;setDisabled(followText);</a>
<a name="ln1134">      tt.resetTempo-&gt;setDisabled(followText || tt.tempo-&gt;value() == 120.0);  // a default of 120 BPM is assumed all over the place</a>
<a name="ln1135">      }</a>
<a name="ln1136"> </a>
<a name="ln1137">//---------------------------------------------------------</a>
<a name="ln1138">//   InspectorLyric</a>
<a name="ln1139">//---------------------------------------------------------</a>
<a name="ln1140"> </a>
<a name="ln1141">InspectorLyric::InspectorLyric(QWidget* parent)</a>
<a name="ln1142">   : InspectorTextBase(parent)</a>
<a name="ln1143">      {</a>
<a name="ln1144">      l.setupUi(addWidget());</a>
<a name="ln1145"> </a>
<a name="ln1146">      const std::vector&lt;InspectorItem&gt; il = {</a>
<a name="ln1147">            { Pid::VERSE,              0, l.verse,        l.resetVerse        },</a>
<a name="ln1148">            { Pid::SUB_STYLE,          0, l.style,        l.resetStyle        },</a>
<a name="ln1149">            { Pid::PLACEMENT,          0, l.placement,    l.resetPlacement    }</a>
<a name="ln1150">            };</a>
<a name="ln1151">      const std::vector&lt;InspectorPanel&gt; ppList = {</a>
<a name="ln1152">            { l.title, l.panel }</a>
<a name="ln1153">            };</a>
<a name="ln1154">      populatePlacement(l.placement);</a>
<a name="ln1155">      populateStyle(l.style);</a>
<a name="ln1156">      mapSignals(il, ppList);</a>
<a name="ln1157">      connect(t.resetToStyle, SIGNAL(clicked()), SLOT(resetToStyle()));</a>
<a name="ln1158">      }</a>
<a name="ln1159"> </a>
<a name="ln1160">//---------------------------------------------------------</a>
<a name="ln1161">//   InspectorStaffText</a>
<a name="ln1162">//---------------------------------------------------------</a>
<a name="ln1163"> </a>
<a name="ln1164">InspectorStaffText::InspectorStaffText(QWidget* parent)</a>
<a name="ln1165">   : InspectorTextBase(parent)</a>
<a name="ln1166">      {</a>
<a name="ln1167">      s.setupUi(addWidget());</a>
<a name="ln1168"> </a>
<a name="ln1169">      Element* el = inspector-&gt;element();</a>
<a name="ln1170">      bool sameTypes = true;</a>
<a name="ln1171"> </a>
<a name="ln1172">      for (const auto&amp; ee : *inspector-&gt;el()) {</a>
<a name="ln1173">            if (el-&gt;type() != ee-&gt;type() || el-&gt;isSystemText() != ee-&gt;isSystemText()) {</a>
<a name="ln1174">                  sameTypes = false;</a>
<a name="ln1175">                  break;</a>
<a name="ln1176">                  }</a>
<a name="ln1177">            }</a>
<a name="ln1178">      if (sameTypes)</a>
<a name="ln1179">            s.title-&gt;setText(el-&gt;userName());</a>
<a name="ln1180"> </a>
<a name="ln1181">      const std::vector&lt;InspectorItem&gt; il = {</a>
<a name="ln1182">            { Pid::SUB_STYLE,  0, s.style,     s.resetStyle     },</a>
<a name="ln1183">            { Pid::PLACEMENT,  0, s.placement, s.resetPlacement }</a>
<a name="ln1184">            };</a>
<a name="ln1185">      const std::vector&lt;InspectorPanel&gt; ppList = {</a>
<a name="ln1186">            { s.title, s.panel }</a>
<a name="ln1187">            };</a>
<a name="ln1188">      populatePlacement(s.placement);</a>
<a name="ln1189">      populateStyle(s.style);</a>
<a name="ln1190">      mapSignals(il, ppList);</a>
<a name="ln1191">      connect(s.properties, SIGNAL(clicked()), SLOT(propertiesClicked()));</a>
<a name="ln1192">      }</a>
<a name="ln1193"> </a>
<a name="ln1194">//---------------------------------------------------------</a>
<a name="ln1195">//   propertiesClicked</a>
<a name="ln1196">//---------------------------------------------------------</a>
<a name="ln1197"> </a>
<a name="ln1198">void InspectorStaffText::propertiesClicked()</a>
<a name="ln1199">      {</a>
<a name="ln1200">      StaffTextBase* st = toStaffTextBase(inspector-&gt;element());</a>
<a name="ln1201">      Score* score = st-&gt;score();</a>
<a name="ln1202">      score-&gt;startCmd();</a>
<a name="ln1203">      mscore-&gt;currentScoreView()-&gt;editStaffTextProperties(st);</a>
<a name="ln1204">      st-&gt;triggerLayoutAll();</a>
<a name="ln1205">      score-&gt;endCmd();</a>
<a name="ln1206">      }</a>
<a name="ln1207"> </a>
<a name="ln1208">//---------------------------------------------------------</a>
<a name="ln1209">//   setElement</a>
<a name="ln1210">//---------------------------------------------------------</a>
<a name="ln1211"> </a>
<a name="ln1212">void InspectorStaffText::setElement()</a>
<a name="ln1213">      {</a>
<a name="ln1214">      InspectorTextBase::setElement();</a>
<a name="ln1215">      Element* el = inspector-&gt;element();</a>
<a name="ln1216">      s.properties-&gt;setVisible(el-&gt;isStaffText() || el-&gt;isSystemText());</a>
<a name="ln1217">      }</a>
<a name="ln1218"> </a>
<a name="ln1219">//---------------------------------------------------------</a>
<a name="ln1220">//   InspectorSlurTie</a>
<a name="ln1221">//---------------------------------------------------------</a>
<a name="ln1222"> </a>
<a name="ln1223">InspectorSlurTie::InspectorSlurTie(QWidget* parent)</a>
<a name="ln1224">   : InspectorElementBase(parent)</a>
<a name="ln1225">      {</a>
<a name="ln1226">      s.setupUi(addWidget());</a>
<a name="ln1227"> </a>
<a name="ln1228">      Element* el = inspector-&gt;element();</a>
<a name="ln1229">      bool sameTypes = true;</a>
<a name="ln1230"> </a>
<a name="ln1231">      for (const auto&amp; ee : *inspector-&gt;el()) {</a>
<a name="ln1232">            if (ee-&gt;isSlurSegment() != el-&gt;isSlurSegment()) {</a>
<a name="ln1233">                  sameTypes = false;</a>
<a name="ln1234">                  break;</a>
<a name="ln1235">                  }</a>
<a name="ln1236">            }</a>
<a name="ln1237">      if (sameTypes)</a>
<a name="ln1238">            s.title-&gt;setText(el-&gt;isSlurSegment() ? tr(&quot;Slur&quot;) : tr(&quot;Tie&quot;));</a>
<a name="ln1239"> </a>
<a name="ln1240">      const std::vector&lt;InspectorItem&gt; iiList = {</a>
<a name="ln1241">            { Pid::LINE_TYPE,       0, s.lineType,      s.resetLineType      },</a>
<a name="ln1242">            { Pid::SLUR_DIRECTION,  0, s.slurDirection, s.resetSlurDirection }</a>
<a name="ln1243">            };</a>
<a name="ln1244">      const std::vector&lt;InspectorPanel&gt; ppList = { { s.title, s.panel } };</a>
<a name="ln1245">      mapSignals(iiList, ppList);</a>
<a name="ln1246">      }</a>
<a name="ln1247"> </a>
<a name="ln1248">//---------------------------------------------------------</a>
<a name="ln1249">//   InspectorEmpty</a>
<a name="ln1250">//---------------------------------------------------------</a>
<a name="ln1251"> </a>
<a name="ln1252">InspectorEmpty::InspectorEmpty(QWidget* parent)</a>
<a name="ln1253">   : InspectorBase(parent)</a>
<a name="ln1254">      {</a>
<a name="ln1255">      e.setupUi(addWidget());</a>
<a name="ln1256">      }</a>
<a name="ln1257"> </a>
<a name="ln1258">//---------------------------------------------------------</a>
<a name="ln1259">//   sizeHint</a>
<a name="ln1260">//---------------------------------------------------------</a>
<a name="ln1261"> </a>
<a name="ln1262">QSize InspectorEmpty::sizeHint() const</a>
<a name="ln1263">      {</a>
<a name="ln1264">      return QSize(255 * guiScaling, 170 * guiScaling);</a>
<a name="ln1265">      }</a>
<a name="ln1266"> </a>
<a name="ln1267">//---------------------------------------------------------</a>
<a name="ln1268">//   InspectorCaesura</a>
<a name="ln1269">//---------------------------------------------------------</a>
<a name="ln1270"> </a>
<a name="ln1271">InspectorCaesura::InspectorCaesura(QWidget* parent)</a>
<a name="ln1272">   : InspectorElementBase(parent)</a>
<a name="ln1273">      {</a>
<a name="ln1274">      c.setupUi(addWidget());</a>
<a name="ln1275"> </a>
<a name="ln1276">      Breath* b = toBreath(inspector-&gt;element());</a>
<a name="ln1277">      bool sameTypes = true;</a>
<a name="ln1278">      for (const auto&amp; ee : *inspector-&gt;el()) {</a>
<a name="ln1279">            if (toBreath(ee)-&gt;isCaesura() != b-&gt;isCaesura()) {</a>
<a name="ln1280">                  sameTypes = false;</a>
<a name="ln1281">                  break;</a>
<a name="ln1282">                  }</a>
<a name="ln1283">            }</a>
<a name="ln1284">      if (sameTypes)</a>
<a name="ln1285">            c.title-&gt;setText(b-&gt;isCaesura() ? tr(&quot;Caesura&quot;) : tr(&quot;Breath&quot;));</a>
<a name="ln1286"> </a>
<a name="ln1287">      const std::vector&lt;InspectorItem&gt; il = {</a>
<a name="ln1288">            { Pid::PAUSE,  0, c.pause,         c.resetPause         }</a>
<a name="ln1289">            };</a>
<a name="ln1290">      const std::vector&lt;InspectorPanel&gt; ppList = { {c.title, c.panel} };</a>
<a name="ln1291">      mapSignals(il, ppList);</a>
<a name="ln1292">      }</a>
<a name="ln1293"> </a>
<a name="ln1294">//---------------------------------------------------------</a>
<a name="ln1295">//   InspectorBracket</a>
<a name="ln1296">//---------------------------------------------------------</a>
<a name="ln1297"> </a>
<a name="ln1298">InspectorBracket::InspectorBracket(QWidget* parent)</a>
<a name="ln1299">   : InspectorBase(parent)</a>
<a name="ln1300">      {</a>
<a name="ln1301">      b.setupUi(addWidget());</a>
<a name="ln1302"> </a>
<a name="ln1303">      const std::vector&lt;InspectorItem&gt; il = {</a>
<a name="ln1304">            { Pid::BRACKET_COLUMN, 0, b.column, b.resetColumn }</a>
<a name="ln1305">            };</a>
<a name="ln1306">      const std::vector&lt;InspectorPanel&gt; ppList = { { b.title, b.panel } };</a>
<a name="ln1307">      mapSignals(il, ppList);</a>
<a name="ln1308">      }</a>
<a name="ln1309"> </a>
<a name="ln1310">//---------------------------------------------------------</a>
<a name="ln1311">//   InspectorIname</a>
<a name="ln1312">//---------------------------------------------------------</a>
<a name="ln1313"> </a>
<a name="ln1314">InspectorIname::InspectorIname(QWidget* parent)</a>
<a name="ln1315">   : InspectorTextBase(parent)</a>
<a name="ln1316">      {</a>
<a name="ln1317">      i.setupUi(addWidget());</a>
<a name="ln1318"> </a>
<a name="ln1319">      const std::vector&lt;InspectorItem&gt; il = {</a>
<a name="ln1320">            { Pid::INAME_LAYOUT_POSITION, 0, i.layoutPosition, i.resetLayoutPosition }</a>
<a name="ln1321">            };</a>
<a name="ln1322">      const std::vector&lt;InspectorPanel&gt; ppList = { { i.title, i.panel } };</a>
<a name="ln1323">      mapSignals(il, ppList);</a>
<a name="ln1324">      }</a>
<a name="ln1325"> </a>
<a name="ln1326">}</a>
<a name="ln1327"> </a>

</code></pre>
<div class="balloon" rel="200"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v595/" target="_blank">V595</a> The 'element()' pointer was utilized before it was verified against nullptr. Check lines: 200, 209.</p></div>
<div class="balloon" rel="1032"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v730/" target="_blank">V730</a> Not all members of a class are initialized inside the constructor. Consider inspecting: otherClef.</p></div>
<div class="balloon" rel="8"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
