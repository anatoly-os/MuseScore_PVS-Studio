
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>debugger.cpp</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">//=============================================================================</a>
<a name="ln2">//  MuseScore</a>
<a name="ln3">//  Linux Music Score Editor</a>
<a name="ln4">//</a>
<a name="ln5">//  Copyright (C) 2002-2016 Werner Schweer and others</a>
<a name="ln6">//</a>
<a name="ln7">//  This program is free software; you can redistribute it and/or modify</a>
<a name="ln8">//  it under the terms of the GNU General Public License version 2.</a>
<a name="ln9">//</a>
<a name="ln10">//  This program is distributed in the hope that it will be useful,</a>
<a name="ln11">//  but WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<a name="ln12">//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</a>
<a name="ln13">//  GNU General Public License for more details.</a>
<a name="ln14">//</a>
<a name="ln15">//  You should have received a copy of the GNU General Public License</a>
<a name="ln16">//  along with this program; if not, write to the Free Software</a>
<a name="ln17">//  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</a>
<a name="ln18">//=============================================================================</a>
<a name="ln19"> </a>
<a name="ln20">#include &quot;debugger.h&quot;</a>
<a name="ln21">#include &quot;musescore.h&quot;</a>
<a name="ln22">#include &quot;icons.h&quot;</a>
<a name="ln23">#include &quot;globals.h&quot;</a>
<a name="ln24">#include &quot;libmscore/element.h&quot;</a>
<a name="ln25">#include &quot;libmscore/page.h&quot;</a>
<a name="ln26">#include &quot;libmscore/segment.h&quot;</a>
<a name="ln27">#include &quot;libmscore/score.h&quot;</a>
<a name="ln28">#include &quot;libmscore/rest.h&quot;</a>
<a name="ln29">#include &quot;libmscore/note.h&quot;</a>
<a name="ln30">#include &quot;libmscore/chord.h&quot;</a>
<a name="ln31">#include &quot;libmscore/measure.h&quot;</a>
<a name="ln32">#include &quot;libmscore/text.h&quot;</a>
<a name="ln33">#include &quot;libmscore/hairpin.h&quot;</a>
<a name="ln34">#include &quot;libmscore/beam.h&quot;</a>
<a name="ln35">#include &quot;libmscore/tuplet.h&quot;</a>
<a name="ln36">#include &quot;libmscore/clef.h&quot;</a>
<a name="ln37">#include &quot;libmscore/barline.h&quot;</a>
<a name="ln38">#include &quot;libmscore/hook.h&quot;</a>
<a name="ln39">#include &quot;libmscore/dynamic.h&quot;</a>
<a name="ln40">#include &quot;libmscore/slur.h&quot;</a>
<a name="ln41">#include &quot;libmscore/tie.h&quot;</a>
<a name="ln42">#include &quot;libmscore/lyrics.h&quot;</a>
<a name="ln43">#include &quot;libmscore/volta.h&quot;</a>
<a name="ln44">#include &quot;libmscore/line.h&quot;</a>
<a name="ln45">#include &quot;libmscore/textline.h&quot;</a>
<a name="ln46">#include &quot;libmscore/system.h&quot;</a>
<a name="ln47">#include &quot;libmscore/arpeggio.h&quot;</a>
<a name="ln48">#include &quot;libmscore/tremolo.h&quot;</a>
<a name="ln49">#include &quot;libmscore/articulation.h&quot;</a>
<a name="ln50">#include &quot;libmscore/ottava.h&quot;</a>
<a name="ln51">#include &quot;libmscore/bend.h&quot;</a>
<a name="ln52">#include &quot;libmscore/stem.h&quot;</a>
<a name="ln53">#include &quot;libmscore/iname.h&quot;</a>
<a name="ln54">#include &quot;libmscore/accidental.h&quot;</a>
<a name="ln55">#include &quot;libmscore/keysig.h&quot;</a>
<a name="ln56">#include &quot;libmscore/sig.h&quot;</a>
<a name="ln57">#include &quot;libmscore/notedot.h&quot;</a>
<a name="ln58">#include &quot;libmscore/spacer.h&quot;</a>
<a name="ln59">#include &quot;libmscore/box.h&quot;</a>
<a name="ln60">#include &quot;libmscore/fret.h&quot;</a>
<a name="ln61">#include &quot;libmscore/harmony.h&quot;</a>
<a name="ln62">#include &quot;libmscore/stemslash.h&quot;</a>
<a name="ln63">#include &quot;libmscore/ledgerline.h&quot;</a>
<a name="ln64">#include &quot;libmscore/pitchspelling.h&quot;</a>
<a name="ln65">#include &quot;libmscore/chordlist.h&quot;</a>
<a name="ln66">#include &quot;libmscore/bracket.h&quot;</a>
<a name="ln67">#include &quot;libmscore/bracketItem.h&quot;</a>
<a name="ln68">#include &quot;libmscore/trill.h&quot;</a>
<a name="ln69">#include &quot;libmscore/timesig.h&quot;</a>
<a name="ln70">#include &quot;libmscore/systemdivider.h&quot;</a>
<a name="ln71">#include &quot;libmscore/measurenumber.h&quot;</a>
<a name="ln72"> </a>
<a name="ln73">namespace Ms {</a>
<a name="ln74"> </a>
<a name="ln75">extern bool useFactorySettings;</a>
<a name="ln76"> </a>
<a name="ln77">//---------------------------------------------------------</a>
<a name="ln78">//   ElementItem</a>
<a name="ln79">//---------------------------------------------------------</a>
<a name="ln80"> </a>
<a name="ln81">class ElementItem : public QTreeWidgetItem</a>
<a name="ln82">      {</a>
<a name="ln83">      Element* el;</a>
<a name="ln84"> </a>
<a name="ln85">   public:</a>
<a name="ln86">      ElementItem(QTreeWidget* lv, Element* e);</a>
<a name="ln87">      ElementItem(QTreeWidgetItem* ei, Element* e);</a>
<a name="ln88">      Element* element() const { return el; }</a>
<a name="ln89">      void init();</a>
<a name="ln90">      };</a>
<a name="ln91"> </a>
<a name="ln92">ElementItem::ElementItem(QTreeWidget* lv, Element* e)</a>
<a name="ln93">   : QTreeWidgetItem(lv, int(e-&gt;type()) + int(QTreeWidgetItem::UserType))</a>
<a name="ln94">      {</a>
<a name="ln95">      el = e;</a>
<a name="ln96">      init();</a>
<a name="ln97">      }</a>
<a name="ln98"> </a>
<a name="ln99">ElementItem::ElementItem(QTreeWidgetItem* ei, Element* e)</a>
<a name="ln100">   : QTreeWidgetItem(ei, int(e-&gt;type()) + int(QTreeWidgetItem::UserType))</a>
<a name="ln101">      {</a>
<a name="ln102">      el = e;</a>
<a name="ln103">      init();</a>
<a name="ln104">      }</a>
<a name="ln105"> </a>
<a name="ln106">//---------------------------------------------------------</a>
<a name="ln107">//   init</a>
<a name="ln108">//---------------------------------------------------------</a>
<a name="ln109"> </a>
<a name="ln110">void ElementItem::init()</a>
<a name="ln111">      {</a>
<a name="ln112">      QString s;</a>
<a name="ln113">      switch(el-&gt;type()) {</a>
<a name="ln114">            case ElementType::PAGE:</a>
<a name="ln115">                  {</a>
<a name="ln116">                  QString no;</a>
<a name="ln117">                  no.setNum(((Page*)el)-&gt;no()+1);</a>
<a name="ln118">                  s = &quot;Page-&quot; + no;</a>
<a name="ln119">                  }</a>
<a name="ln120">                  break;</a>
<a name="ln121">            case ElementType::MEASURE:</a>
<a name="ln122">                  {</a>
<a name="ln123">                  QString no;</a>
<a name="ln124">                  no.setNum(((Measure*)el)-&gt;no()+1);</a>
<a name="ln125">                  s = &quot;Measure-&quot; + no;</a>
<a name="ln126">                  }</a>
<a name="ln127">                  break;</a>
<a name="ln128">            case ElementType::SEGMENT:</a>
<a name="ln129">                  s = QString(&quot;Segment %1&quot;).arg(toSegment(el)-&gt;subTypeName());</a>
<a name="ln130">                  break;</a>
<a name="ln131">            default:</a>
<a name="ln132">                  s = el-&gt;name();</a>
<a name="ln133">                  break;</a>
<a name="ln134">            }</a>
<a name="ln135">      setText(0, s);</a>
<a name="ln136">      }</a>
<a name="ln137"> </a>
<a name="ln138">//---------------------------------------------------------</a>
<a name="ln139">//   Debugger</a>
<a name="ln140">//---------------------------------------------------------</a>
<a name="ln141"> </a>
<a name="ln142">Debugger::Debugger(QWidget* parent)</a>
<a name="ln143">   : AbstractDialog(parent)</a>
<a name="ln144">      {</a>
<a name="ln145">      setObjectName(&quot;Debugger&quot;);</a>
<a name="ln146">      setupUi(this);</a>
<a name="ln147">      setWindowFlags(this-&gt;windowFlags() &amp; ~Qt::WindowContextHelpButtonHint);</a>
<a name="ln148"> </a>
<a name="ln149">      for (int i = 0; i &lt; int(ElementType::MAXTYPE); ++i)</a>
<a name="ln150">            elementViews[i] = 0;</a>
<a name="ln151">      curElement   = 0;</a>
<a name="ln152">      cs           = 0;</a>
<a name="ln153"> </a>
<a name="ln154">      connect(list, SIGNAL(itemClicked(QTreeWidgetItem*,int)), SLOT(itemClicked(QTreeWidgetItem*,int)));</a>
<a name="ln155">      connect(list, SIGNAL(itemActivated(QTreeWidgetItem*,int)), SLOT(itemClicked(QTreeWidgetItem*, int)));</a>
<a name="ln156">      connect(list, SIGNAL(itemExpanded(QTreeWidgetItem*)), SLOT(itemExpanded(QTreeWidgetItem*)));</a>
<a name="ln157">      connect(list, SIGNAL(itemCollapsed(QTreeWidgetItem*)), SLOT(itemExpanded(QTreeWidgetItem*)));</a>
<a name="ln158"> </a>
<a name="ln159">      list-&gt;resizeColumnToContents(0);</a>
<a name="ln160">      readSettings();</a>
<a name="ln161">      back-&gt;setEnabled(false);</a>
<a name="ln162">      forward-&gt;setEnabled(false);</a>
<a name="ln163">      connect(back,    SIGNAL(clicked()), SLOT(backClicked()));</a>
<a name="ln164">      connect(forward, SIGNAL(clicked()), SLOT(forwardClicked()));</a>
<a name="ln165">      connect(reload,  SIGNAL(clicked()), SLOT(reloadClicked()));</a>
<a name="ln166">      connect(selectButton, SIGNAL(clicked()), SLOT(selectElement()));</a>
<a name="ln167">      connect(resetButton,  SIGNAL(clicked()), SLOT(resetElement()));</a>
<a name="ln168">      connect(layoutButton, SIGNAL(clicked()), SLOT(layout()));</a>
<a name="ln169"> </a>
<a name="ln170">      back-&gt;setIcon(*icons[int(Icons::goPrevious_ICON)]);</a>
<a name="ln171">      forward-&gt;setIcon(*icons[int(Icons::goNext_ICON)]);</a>
<a name="ln172">      reload-&gt;setIcon(*icons[int(Icons::viewRefresh_ICON)]);</a>
<a name="ln173">      }</a>
<a name="ln174"> </a>
<a name="ln175">//---------------------------------------------------------</a>
<a name="ln176">//   selectElement</a>
<a name="ln177">//---------------------------------------------------------</a>
<a name="ln178"> </a>
<a name="ln179">void Debugger::selectElement()</a>
<a name="ln180">      {</a>
<a name="ln181">      if (!curElement)</a>
<a name="ln182">            return;</a>
<a name="ln183">      curElement-&gt;score()-&gt;select(curElement);</a>
<a name="ln184">      }</a>
<a name="ln185"> </a>
<a name="ln186">//---------------------------------------------------------</a>
<a name="ln187">//   resetElement</a>
<a name="ln188">//---------------------------------------------------------</a>
<a name="ln189"> </a>
<a name="ln190">void Debugger::resetElement()</a>
<a name="ln191">      {</a>
<a name="ln192">      if (!curElement)</a>
<a name="ln193">            return;</a>
<a name="ln194">      curElement-&gt;reset();</a>
<a name="ln195">      layout();</a>
<a name="ln196">      }</a>
<a name="ln197"> </a>
<a name="ln198">//---------------------------------------------------------</a>
<a name="ln199">//   layout</a>
<a name="ln200">//---------------------------------------------------------</a>
<a name="ln201"> </a>
<a name="ln202">void Debugger::layout()</a>
<a name="ln203">      {</a>
<a name="ln204">      if (!curElement)</a>
<a name="ln205">            return;</a>
<a name="ln206">      curElement-&gt;triggerLayoutAll();</a>
<a name="ln207">      curElement-&gt;score()-&gt;update();</a>
<a name="ln208">      mscore-&gt;endCmd();</a>
<a name="ln209">      }</a>
<a name="ln210"> </a>
<a name="ln211">//---------------------------------------------------------</a>
<a name="ln212">//   writeSettings</a>
<a name="ln213">//---------------------------------------------------------</a>
<a name="ln214"> </a>
<a name="ln215">void Debugger::writeSettings()</a>
<a name="ln216">      {</a>
<a name="ln217">      QSettings settings;</a>
<a name="ln218">      settings.beginGroup(objectName());</a>
<a name="ln219">      settings.setValue(&quot;splitter&quot;, split-&gt;saveState());</a>
<a name="ln220">      settings.endGroup();</a>
<a name="ln221"> </a>
<a name="ln222">      MuseScore::saveGeometry(this);</a>
<a name="ln223">      }</a>
<a name="ln224"> </a>
<a name="ln225">//---------------------------------------------------------</a>
<a name="ln226">//   readSettings</a>
<a name="ln227">//---------------------------------------------------------</a>
<a name="ln228"> </a>
<a name="ln229">void Debugger::readSettings()</a>
<a name="ln230">      {</a>
<a name="ln231">      if (!useFactorySettings) {</a>
<a name="ln232">            QSettings settings;</a>
<a name="ln233">            settings.beginGroup(objectName());</a>
<a name="ln234">            split-&gt;restoreState(settings.value(&quot;splitter&quot;).toByteArray());</a>
<a name="ln235">            settings.endGroup();</a>
<a name="ln236">            }</a>
<a name="ln237"> </a>
<a name="ln238">      MuseScore::restoreGeometry(this);</a>
<a name="ln239">      }</a>
<a name="ln240"> </a>
<a name="ln241">//---------------------------------------------------------</a>
<a name="ln242">//   layoutScore</a>
<a name="ln243">//---------------------------------------------------------</a>
<a name="ln244"> </a>
<a name="ln245">void Debugger::layoutScore()</a>
<a name="ln246">      {</a>
<a name="ln247">//      cs-&gt;setLayoutAll(true);</a>
<a name="ln248">//      cs-&gt;end();</a>
<a name="ln249">      }</a>
<a name="ln250"> </a>
<a name="ln251">//---------------------------------------------------------</a>
<a name="ln252">//   addSymbol</a>
<a name="ln253">//---------------------------------------------------------</a>
<a name="ln254"> </a>
<a name="ln255">static void addSymbol(ElementItem* parent, BSymbol* bs)</a>
<a name="ln256">      {</a>
<a name="ln257">      const QList&lt;Element*&gt;el = bs-&gt;leafs();</a>
<a name="ln258">      ElementItem* i = new ElementItem(parent, bs);</a>
<a name="ln259">      if (!el.isEmpty()) {</a>
<a name="ln260">            foreach(Element* g, el)</a>
<a name="ln261">                  addSymbol(i, static_cast&lt;BSymbol*&gt;(g));</a>
<a name="ln262">            }</a>
<a name="ln263">      }</a>
<a name="ln264"> </a>
<a name="ln265">//---------------------------------------------------------</a>
<a name="ln266">//   addMeasureBaseToList</a>
<a name="ln267">//---------------------------------------------------------</a>
<a name="ln268"> </a>
<a name="ln269">static void addMeasureBaseToList(ElementItem* mi, MeasureBase* mb)</a>
<a name="ln270">      {</a>
<a name="ln271">      foreach(Element* e, mb-&gt;el()) {</a>
<a name="ln272">            ElementItem* mmi = new ElementItem(mi, e);</a>
<a name="ln273">            if (e-&gt;type() == ElementType::HBOX || e-&gt;type() == ElementType::VBOX)</a>
<a name="ln274">                  addMeasureBaseToList(mmi, static_cast&lt;MeasureBase*&gt;(e));</a>
<a name="ln275">            }</a>
<a name="ln276">      }</a>
<a name="ln277"> </a>
<a name="ln278">//---------------------------------------------------------</a>
<a name="ln279">//   showEvent</a>
<a name="ln280">//---------------------------------------------------------</a>
<a name="ln281"> </a>
<a name="ln282">void Debugger::showEvent(QShowEvent*)</a>
<a name="ln283">      {</a>
<a name="ln284">      updateList(cs);</a>
<a name="ln285">      }</a>
<a name="ln286"> </a>
<a name="ln287">//---------------------------------------------------------</a>
<a name="ln288">//   addBSymbol</a>
<a name="ln289">//---------------------------------------------------------</a>
<a name="ln290"> </a>
<a name="ln291">static void addBSymbol(ElementItem* item, BSymbol* e)</a>
<a name="ln292">      {</a>
<a name="ln293">      ElementItem* si = new ElementItem(item, e);</a>
<a name="ln294">      foreach(Element* ee, e-&gt;leafs())</a>
<a name="ln295">            addBSymbol(si, static_cast&lt;BSymbol*&gt;(ee));</a>
<a name="ln296">      }</a>
<a name="ln297"> </a>
<a name="ln298">//---------------------------------------------------------</a>
<a name="ln299">//   addChord</a>
<a name="ln300">//---------------------------------------------------------</a>
<a name="ln301"> </a>
<a name="ln302">static void addChord(ElementItem* sei, Chord* chord)</a>
<a name="ln303">      {</a>
<a name="ln304">      if (chord-&gt;hook())</a>
<a name="ln305">            new ElementItem(sei, chord-&gt;hook());</a>
<a name="ln306">      if (chord-&gt;stem())</a>
<a name="ln307">            new ElementItem(sei, chord-&gt;stem());</a>
<a name="ln308">      if (chord-&gt;stemSlash())</a>
<a name="ln309">            new ElementItem(sei, chord-&gt;stemSlash());</a>
<a name="ln310">      if (chord-&gt;arpeggio())</a>
<a name="ln311">            new ElementItem(sei, chord-&gt;arpeggio());</a>
<a name="ln312">      if (chord-&gt;tremolo() &amp;&amp; (chord-&gt;tremolo()-&gt;chord1() == chord))</a>
<a name="ln313">            new ElementItem(sei, chord-&gt;tremolo());</a>
<a name="ln314">//      if (chord-&gt;glissando())</a>
<a name="ln315">//            new ElementItem(sei, chord-&gt;glissando());</a>
<a name="ln316"> </a>
<a name="ln317">      for (Articulation* a : chord-&gt;articulations())</a>
<a name="ln318">            new ElementItem(sei, a);</a>
<a name="ln319">      for (LedgerLine* h = chord-&gt;ledgerLines(); h; h = h-&gt;next())</a>
<a name="ln320">            new ElementItem(sei, h);</a>
<a name="ln321">      for (Note* note : chord-&gt;notes()) {</a>
<a name="ln322">            ElementItem* ni = new ElementItem(sei, note);</a>
<a name="ln323">            if (note-&gt;accidental()) {</a>
<a name="ln324">                  new ElementItem(ni, note-&gt;accidental());</a>
<a name="ln325">                  }</a>
<a name="ln326">            for (Element* f : note-&gt;el()) {</a>
<a name="ln327">                  if (f-&gt;type() == ElementType::SYMBOL || f-&gt;type() == ElementType::IMAGE) {</a>
<a name="ln328">                        BSymbol* bs = static_cast&lt;BSymbol*&gt;(f);</a>
<a name="ln329">                        addSymbol(ni, bs);</a>
<a name="ln330">                        }</a>
<a name="ln331">                  else</a>
<a name="ln332">                        new ElementItem(ni, f);</a>
<a name="ln333">                  }</a>
<a name="ln334">            for (NoteDot* dot : note-&gt;dots())</a>
<a name="ln335">                  new ElementItem(ni, dot);</a>
<a name="ln336"> </a>
<a name="ln337">            if (note-&gt;tieFor()) {</a>
<a name="ln338">                  Tie* tie = note-&gt;tieFor();</a>
<a name="ln339">                  ElementItem* ti = new ElementItem(ni, tie);</a>
<a name="ln340">                  for (Element* el1 : tie-&gt;spannerSegments())</a>
<a name="ln341">                        new ElementItem(ti, el1);</a>
<a name="ln342">                  }</a>
<a name="ln343">            for (Spanner* s : note-&gt;spannerFor()) {</a>
<a name="ln344">                  ElementItem* si = new ElementItem(ni, s);</a>
<a name="ln345">                  for (Element* ls : s-&gt;spannerSegments())</a>
<a name="ln346">                        new ElementItem(si, ls);</a>
<a name="ln347">                  }</a>
<a name="ln348">            }</a>
<a name="ln349">      for (Element* e : chord-&gt;el()) {</a>
<a name="ln350">            ElementItem* ei = new ElementItem(sei, e);</a>
<a name="ln351">            if (e-&gt;type() == ElementType::SLUR) {</a>
<a name="ln352">                  Slur* gs = static_cast&lt;Slur*&gt;(e);</a>
<a name="ln353">                  for (SpannerSegment* sp : gs-&gt;spannerSegments())</a>
<a name="ln354">                        new ElementItem(ei, sp);</a>
<a name="ln355">                  }</a>
<a name="ln356">            }</a>
<a name="ln357">      for (Chord* c : chord-&gt;graceNotes()) {</a>
<a name="ln358">            ElementItem* ssei = new ElementItem(sei, c);</a>
<a name="ln359">            addChord(ssei, c);</a>
<a name="ln360">            }</a>
<a name="ln361"> </a>
<a name="ln362">      if (chord-&gt;beam() &amp;&amp; chord-&gt;beam()-&gt;elements().front() == chord)</a>
<a name="ln363">            new ElementItem(sei, chord-&gt;beam());</a>
<a name="ln364">      for (Lyrics* lyrics : chord-&gt;lyrics()) {</a>
<a name="ln365">            if (lyrics)</a>
<a name="ln366">                  new ElementItem(sei, lyrics);</a>
<a name="ln367">            }</a>
<a name="ln368">      DurationElement* de = chord;</a>
<a name="ln369">      while (de-&gt;tuplet() &amp;&amp; de-&gt;tuplet()-&gt;elements().front() == de) {</a>
<a name="ln370">            new ElementItem(sei, de-&gt;tuplet());</a>
<a name="ln371">            de = de-&gt;tuplet();</a>
<a name="ln372">            }</a>
<a name="ln373">      }</a>
<a name="ln374"> </a>
<a name="ln375">//---------------------------------------------------------</a>
<a name="ln376">//   addMeasure</a>
<a name="ln377">//---------------------------------------------------------</a>
<a name="ln378"> </a>
<a name="ln379">void Debugger::addMeasure(ElementItem* mi, Measure* measure)</a>
<a name="ln380">      {</a>
<a name="ln381">      int staves = cs-&gt;nstaves();</a>
<a name="ln382">      int tracks = staves * VOICES;</a>
<a name="ln383">      for (int staffIdx = 0; staffIdx &lt; measure-&gt;score()-&gt;nstaves(); ++staffIdx) {</a>
<a name="ln384">            if (measure-&gt;vspacerUp(staffIdx))</a>
<a name="ln385">                  new ElementItem(mi, measure-&gt;vspacerUp(staffIdx));</a>
<a name="ln386">            if (measure-&gt;vspacerDown(staffIdx))</a>
<a name="ln387">                  new ElementItem(mi, measure-&gt;vspacerDown(staffIdx));</a>
<a name="ln388">            if (measure-&gt;noText(staffIdx))</a>
<a name="ln389">                  new ElementItem(mi, measure-&gt;noText(staffIdx));</a>
<a name="ln390">            }</a>
<a name="ln391">      for (Segment* segment = measure-&gt;first(); segment; segment = segment-&gt;next()) {</a>
<a name="ln392">            ElementItem* segItem = new ElementItem(mi, segment);</a>
<a name="ln393">            for (int track = 0; track &lt; tracks; ++track) {</a>
<a name="ln394">                  Element* e = segment-&gt;element(track);</a>
<a name="ln395">                  if (!e)</a>
<a name="ln396">                        continue;</a>
<a name="ln397">                  ElementItem* sei = new ElementItem(segItem, e);</a>
<a name="ln398">                  if (e-&gt;isChord())</a>
<a name="ln399">                        addChord(sei, toChord(e));</a>
<a name="ln400">                  else if (e-&gt;isRest()) {</a>
<a name="ln401">                        Rest* rest = toRest(e);</a>
<a name="ln402">                        for (int i = 0; i &lt; rest-&gt;dots(); ++i)</a>
<a name="ln403">                              new ElementItem(sei, rest-&gt;dot(i));</a>
<a name="ln404">                        ChordRest* cr = toChordRest(e);</a>
<a name="ln405">                        if (cr-&gt;beam() &amp;&amp; cr-&gt;beam()-&gt;elements().front() == cr)</a>
<a name="ln406">                              new ElementItem(sei, cr-&gt;beam());</a>
<a name="ln407">                        for (Lyrics* lyrics : cr-&gt;lyrics()) {</a>
<a name="ln408">                              if (lyrics)</a>
<a name="ln409">                                    new ElementItem(sei, lyrics);</a>
<a name="ln410">                              }</a>
<a name="ln411">                        DurationElement* de = cr;</a>
<a name="ln412">                        while (de-&gt;tuplet() &amp;&amp; de-&gt;tuplet()-&gt;elements().front() == de) {</a>
<a name="ln413">                              new ElementItem(sei, de-&gt;tuplet());</a>
<a name="ln414">                              de = de-&gt;tuplet();</a>
<a name="ln415">                              }</a>
<a name="ln416">                        }</a>
<a name="ln417">                  }</a>
<a name="ln418"> </a>
<a name="ln419">            foreach(Element* s, segment-&gt;annotations()) {</a>
<a name="ln420">                  if (s-&gt;type() == ElementType::SYMBOL || s-&gt;type() == ElementType::IMAGE)</a>
<a name="ln421">                        addBSymbol(segItem, static_cast&lt;BSymbol*&gt;(s));</a>
<a name="ln422">                  else if (s-&gt;type() == ElementType::FRET_DIAGRAM) {</a>
<a name="ln423">                        ElementItem* fdi = new ElementItem(segItem, s);</a>
<a name="ln424">                        FretDiagram* fd = static_cast&lt;FretDiagram*&gt;(s);</a>
<a name="ln425">                        if (fd-&gt;harmony())</a>
<a name="ln426">                              new ElementItem(fdi, fd-&gt;harmony());</a>
<a name="ln427">                        }</a>
<a name="ln428">                  else</a>
<a name="ln429">                        new ElementItem(segItem, s);</a>
<a name="ln430">                  }</a>
<a name="ln431">            }</a>
<a name="ln432">      }</a>
<a name="ln433"> </a>
<a name="ln434">//---------------------------------------------------------</a>
<a name="ln435">//   updateList</a>
<a name="ln436">//---------------------------------------------------------</a>
<a name="ln437"> </a>
<a name="ln438">void Debugger::updateList(Score* s)</a>
<a name="ln439">      {</a>
<a name="ln440">      if (cs != s) {</a>
<a name="ln441">            backStack.clear();</a>
<a name="ln442">            forwardStack.clear();</a>
<a name="ln443">            back-&gt;setEnabled(false);</a>
<a name="ln444">            forward-&gt;setEnabled(false);</a>
<a name="ln445">            cs = s;</a>
<a name="ln446">            }</a>
<a name="ln447">      curElement = 0;</a>
<a name="ln448">      list-&gt;clear();</a>
<a name="ln449">      if (!isVisible())</a>
<a name="ln450">            return;</a>
<a name="ln451"> </a>
<a name="ln452">      if (s-&gt;masterScore()-&gt;movements()) {</a>
<a name="ln453">            QTreeWidgetItem* mi = new QTreeWidgetItem(list, int(ElementType::INVALID));</a>
<a name="ln454">            mi-&gt;setText(0, &quot;Movements&quot;);</a>
<a name="ln455">            for (MasterScore* ms : *s-&gt;masterScore()-&gt;movements()) {</a>
<a name="ln456">                  QTreeWidgetItem* i = new QTreeWidgetItem(mi, int(ElementType::INVALID));</a>
<a name="ln457">                  i-&gt;setText(0, ms-&gt;metaTag(&quot;movementTitle&quot;));</a>
<a name="ln458">                  }</a>
<a name="ln459">            }</a>
<a name="ln460"> </a>
<a name="ln461"> </a>
<a name="ln462">      QTreeWidgetItem* li = new QTreeWidgetItem(list, int(ElementType::INVALID));</a>
<a name="ln463">      li-&gt;setText(0, &quot;Global&quot;);</a>
<a name="ln464">      for (auto i : s-&gt;spanner()) {</a>
<a name="ln465">            ElementItem* it = new ElementItem(li, i.second);</a>
<a name="ln466">            if (i.second-&gt;type() == ElementType::TRILL) {</a>
<a name="ln467">                  Trill* trill = static_cast&lt;Trill*&gt;(i.second);</a>
<a name="ln468">                  if (trill-&gt;accidental())</a>
<a name="ln469">                        new ElementItem(it, trill-&gt;accidental());</a>
<a name="ln470">                  }</a>
<a name="ln471">            }</a>
<a name="ln472"> </a>
<a name="ln473">      foreach (Page* pg, cs-&gt;pages()) {</a>
<a name="ln474">            ElementItem* pi = new ElementItem(list, pg);</a>
<a name="ln475"> </a>
<a name="ln476">            for (System* system : pg-&gt;systems()) {</a>
<a name="ln477">                  ElementItem* si = new ElementItem(pi, system);</a>
<a name="ln478">                  for (Bracket* b : system-&gt;brackets())</a>
<a name="ln479">                        new ElementItem(si, b);</a>
<a name="ln480">                  if (system-&gt;systemDividerLeft())</a>
<a name="ln481">                        new ElementItem(si, system-&gt;systemDividerLeft());</a>
<a name="ln482">                  if (system-&gt;systemDividerRight())</a>
<a name="ln483">                        new ElementItem(si, system-&gt;systemDividerRight());</a>
<a name="ln484">                  for (SpannerSegment* ss : system-&gt;spannerSegments())</a>
<a name="ln485">                        new ElementItem(si, ss);</a>
<a name="ln486">                  for (SysStaff* ss : *system-&gt;staves()) {</a>
<a name="ln487">                        for (InstrumentName* in : ss-&gt;instrumentNames)</a>
<a name="ln488">                              new ElementItem(si, in);</a>
<a name="ln489">                        }</a>
<a name="ln490"> </a>
<a name="ln491">                  for (MeasureBase* mb : system-&gt;measures()) {</a>
<a name="ln492">                        ElementItem* mi = new ElementItem(si, mb);</a>
<a name="ln493">                        addMeasureBaseToList(mi, mb);</a>
<a name="ln494"> </a>
<a name="ln495">                        if (mb-&gt;type() != ElementType::MEASURE)</a>
<a name="ln496">                              continue;</a>
<a name="ln497">                        Measure* measure = (Measure*) mb;</a>
<a name="ln498">                        if (cs-&gt;styleB(Sid::concertPitch)) {</a>
<a name="ln499">                              if (measure-&gt;mmRest()) {</a>
<a name="ln500">                                    ElementItem* mmi = new ElementItem(mi, measure-&gt;mmRest());</a>
<a name="ln501">                                    addMeasure(mmi, measure-&gt;mmRest());</a>
<a name="ln502">                                    }</a>
<a name="ln503">                              }</a>
<a name="ln504">                        else {</a>
<a name="ln505">                              if (measure-&gt;isMMRest()) {</a>
<a name="ln506">                                    Measure* m1 = measure-&gt;mmRestFirst();</a>
<a name="ln507">                                    Measure* m2 = measure-&gt;mmRestLast();</a>
<a name="ln508">                                    for (;;) {</a>
<a name="ln509">                                          ElementItem* mmi = new ElementItem(mi, m1);</a>
<a name="ln510">                                          addMeasure(mmi, m1);</a>
<a name="ln511">                                          if (m1 == m2)</a>
<a name="ln512">                                                break;</a>
<a name="ln513">                                          m1 = m1-&gt;nextMeasure();</a>
<a name="ln514">                                          }</a>
<a name="ln515">                                    }</a>
<a name="ln516">                              }</a>
<a name="ln517">                        addMeasure(mi, measure);</a>
<a name="ln518">                        }</a>
<a name="ln519">                  }</a>
<a name="ln520">            }</a>
<a name="ln521">      }</a>
<a name="ln522"> </a>
<a name="ln523">//---------------------------------------------------------</a>
<a name="ln524">//   searchElement</a>
<a name="ln525">//---------------------------------------------------------</a>
<a name="ln526"> </a>
<a name="ln527">bool Debugger::searchElement(QTreeWidgetItem* pi, Element* el)</a>
<a name="ln528">      {</a>
<a name="ln529">      for (int i = 0;; ++i) {</a>
<a name="ln530">            QTreeWidgetItem* item = pi-&gt;child(i);</a>
<a name="ln531">            if (item == 0)</a>
<a name="ln532">                  break;</a>
<a name="ln533">            ElementItem* ei = (ElementItem*)item;</a>
<a name="ln534">            if (ei-&gt;element() == el) {</a>
<a name="ln535">                  QTreeWidget* tw = pi-&gt;treeWidget();</a>
<a name="ln536">                  tw-&gt;setItemExpanded(item, true);</a>
<a name="ln537">                  tw-&gt;setCurrentItem(item);</a>
<a name="ln538">                  tw-&gt;scrollToItem(item);</a>
<a name="ln539">                  return true;</a>
<a name="ln540">                  }</a>
<a name="ln541">            if (searchElement(item, el)) {</a>
<a name="ln542">                  pi-&gt;treeWidget()-&gt;setItemExpanded(item, true);</a>
<a name="ln543">                  return true;</a>
<a name="ln544">                  }</a>
<a name="ln545">            }</a>
<a name="ln546">      return false;</a>
<a name="ln547">      }</a>
<a name="ln548"> </a>
<a name="ln549">//---------------------------------------------------------</a>
<a name="ln550">//   setElement</a>
<a name="ln551">//---------------------------------------------------------</a>
<a name="ln552"> </a>
<a name="ln553">void Debugger::setElement(Element* el)</a>
<a name="ln554">      {</a>
<a name="ln555">      if (curElement) {</a>
<a name="ln556">            backStack.push(curElement);</a>
<a name="ln557">            back-&gt;setEnabled(true);</a>
<a name="ln558">            forwardStack.clear();</a>
<a name="ln559">            forward-&gt;setEnabled(false);</a>
<a name="ln560">            }</a>
<a name="ln561">      updateElement(el);</a>
<a name="ln562">      }</a>
<a name="ln563"> </a>
<a name="ln564">//---------------------------------------------------------</a>
<a name="ln565">//   itemExpanded</a>
<a name="ln566">//---------------------------------------------------------</a>
<a name="ln567"> </a>
<a name="ln568">void Debugger::itemExpanded(QTreeWidgetItem*)</a>
<a name="ln569">      {</a>
<a name="ln570">      list-&gt;resizeColumnToContents(0);</a>
<a name="ln571">      }</a>
<a name="ln572"> </a>
<a name="ln573">//---------------------------------------------------------</a>
<a name="ln574">//   itemClicked</a>
<a name="ln575">//---------------------------------------------------------</a>
<a name="ln576"> </a>
<a name="ln577">void Debugger::itemClicked(QTreeWidgetItem* i, int)</a>
<a name="ln578">      {</a>
<a name="ln579">      if (i == 0)</a>
<a name="ln580">            return;</a>
<a name="ln581">      if (i-&gt;type() == int(ElementType::INVALID))</a>
<a name="ln582">            return;</a>
<a name="ln583">      Element* el = static_cast&lt;ElementItem*&gt;(i)-&gt;element();</a>
<a name="ln584">      if (curElement) {</a>
<a name="ln585">            backStack.push(curElement);</a>
<a name="ln586">            back-&gt;setEnabled(true);</a>
<a name="ln587">            forwardStack.clear();</a>
<a name="ln588">            forward-&gt;setEnabled(false);</a>
<a name="ln589">            }</a>
<a name="ln590">      updateElement(el);</a>
<a name="ln591">      }</a>
<a name="ln592"> </a>
<a name="ln593">//---------------------------------------------------------</a>
<a name="ln594">//   updateElement</a>
<a name="ln595">//---------------------------------------------------------</a>
<a name="ln596"> </a>
<a name="ln597">void Debugger::updateElement(Element* el)</a>
<a name="ln598">      {</a>
<a name="ln599">      if (el == 0 || !isVisible() || !el-&gt;score())</a>
<a name="ln600">            return;</a>
<a name="ln601"> </a>
<a name="ln602">      if (cs != el-&gt;score())</a>
<a name="ln603">            updateList(el-&gt;score());</a>
<a name="ln604">      bool found = false;</a>
<a name="ln605">      for (QTreeWidgetItemIterator it(list); *it; ++it) {</a>
<a name="ln606">            QTreeWidgetItem* item = *it;</a>
<a name="ln607">            if (item-&gt;type() == QTreeWidgetItem::Type)</a>
<a name="ln608">                  continue;</a>
<a name="ln609">            ElementItem* ei = static_cast&lt;ElementItem*&gt;(item);</a>
<a name="ln610">            if (ei-&gt;element() == el) {</a>
<a name="ln611">                  list-&gt;setItemExpanded(item, true);</a>
<a name="ln612">                  list-&gt;setCurrentItem(item);</a>
<a name="ln613">                  list-&gt;scrollToItem(item);</a>
<a name="ln614">                  found = true;</a>
<a name="ln615">                  break;</a>
<a name="ln616">                  }</a>
<a name="ln617">            }</a>
<a name="ln618">      if (!found)</a>
<a name="ln619">            qDebug(&quot;Debugger: element not found %s&quot;, el-&gt;name());</a>
<a name="ln620"> </a>
<a name="ln621">      setWindowTitle(QString(&quot;Debugger: &quot;) + el-&gt;name());</a>
<a name="ln622"> </a>
<a name="ln623">      ShowElementBase* ew = elementViews[int(el-&gt;type())];</a>
<a name="ln624">      if (ew == 0) {</a>
<a name="ln625">            switch (el-&gt;type()) {</a>
<a name="ln626">                  case ElementType::PAGE:             ew = new ShowPageWidget;      break;</a>
<a name="ln627">                  case ElementType::SYSTEM:           ew = new SystemView;          break;</a>
<a name="ln628">                  case ElementType::MEASURE:          ew = new MeasureView;         break;</a>
<a name="ln629">                  case ElementType::CHORD:            ew = new ChordDebug;          break;</a>
<a name="ln630">                  case ElementType::NOTE:             ew = new ShowNoteWidget;      break;</a>
<a name="ln631">                  case ElementType::REST:             ew = new RestView;            break;</a>
<a name="ln632">                  case ElementType::CLEF:             ew = new ClefView;            break;</a>
<a name="ln633">                  case ElementType::TIMESIG:          ew = new TimeSigView;         break;</a>
<a name="ln634">                  case ElementType::KEYSIG:           ew = new KeySigView;          break;</a>
<a name="ln635">                  case ElementType::SEGMENT:          ew = new SegmentView;         break;</a>
<a name="ln636">                  case ElementType::HAIRPIN:          ew = new HairpinView;         break;</a>
<a name="ln637">                  case ElementType::BAR_LINE:         ew = new BarLineView;         break;</a>
<a name="ln638">                  case ElementType::DYNAMIC:          ew = new DynamicView;         break;</a>
<a name="ln639">                  case ElementType::TUPLET:           ew = new TupletView;          break;</a>
<a name="ln640">                  case ElementType::SLUR:             ew = new SlurTieView;         break;</a>
<a name="ln641">                  case ElementType::TIE:              ew = new TieView;             break;</a>
<a name="ln642">                  case ElementType::VOLTA:            ew = new VoltaView;           break;</a>
<a name="ln643">                  case ElementType::VOLTA_SEGMENT:    ew = new VoltaSegmentView;    break;</a>
<a name="ln644">                  case ElementType::PEDAL:</a>
<a name="ln645">                  case ElementType::LET_RING:</a>
<a name="ln646">                  case ElementType::VIBRATO:</a>
<a name="ln647">                  case ElementType::TEXTLINE:         ew = new TextLineView;        break;</a>
<a name="ln648">                  case ElementType::PEDAL_SEGMENT:</a>
<a name="ln649">                  case ElementType::TEXTLINE_SEGMENT: ew = new TextLineSegmentView; break;</a>
<a name="ln650">                  case ElementType::LYRICS:           ew = new LyricsView;          break;</a>
<a name="ln651">                  case ElementType::BEAM:             ew = new BeamView;            break;</a>
<a name="ln652">                  case ElementType::TREMOLO:          ew = new TremoloView;         break;</a>
<a name="ln653">                  case ElementType::OTTAVA:           ew = new OttavaView;          break;</a>
<a name="ln654">                  case ElementType::LET_RING_SEGMENT:</a>
<a name="ln655">                  case ElementType::OTTAVA_SEGMENT:   ew = new TextLineSegmentView; break;</a>
<a name="ln656">                  case ElementType::SLUR_SEGMENT:     ew = new SlurSegmentView;     break;</a>
<a name="ln657">                  case ElementType::TIE_SEGMENT:      ew = new TieSegmentView;     break;</a>
<a name="ln658">                  case ElementType::ACCIDENTAL:       ew = new AccidentalView;      break;</a>
<a name="ln659">                  case ElementType::ARTICULATION:     ew = new ArticulationView;    break;</a>
<a name="ln660">                  case ElementType::STEM:             ew = new StemView;            break;</a>
<a name="ln661">                  case ElementType::VBOX:</a>
<a name="ln662">                  case ElementType::HBOX:</a>
<a name="ln663">                  case ElementType::FBOX:</a>
<a name="ln664">                  case ElementType::TBOX:             ew = new BoxView;             break;</a>
<a name="ln665">                  case ElementType::TRILL:            ew = new SpannerView;         break;</a>
<a name="ln666"> </a>
<a name="ln667">                  case ElementType::INSTRUMENT_NAME:</a>
<a name="ln668">                  case ElementType::FINGERING:</a>
<a name="ln669">                  case ElementType::MARKER:</a>
<a name="ln670">                  case ElementType::JUMP:</a>
<a name="ln671">                  case ElementType::TEXT:</a>
<a name="ln672">                  case ElementType::MEASURE_NUMBER:</a>
<a name="ln673">                  case ElementType::STAFF_TEXT:</a>
<a name="ln674">                  case ElementType::SYSTEM_TEXT:</a>
<a name="ln675">                  case ElementType::REHEARSAL_MARK:</a>
<a name="ln676">                        ew = new TextView;</a>
<a name="ln677">                        break;</a>
<a name="ln678">                  case ElementType::HARMONY:</a>
<a name="ln679">                        ew = new HarmonyView;</a>
<a name="ln680">                        break;</a>
<a name="ln681">                  case ElementType::TRILL_SEGMENT:</a>
<a name="ln682">                  case ElementType::VIBRATO_SEGMENT:</a>
<a name="ln683">                  case ElementType::HAIRPIN_SEGMENT:</a>
<a name="ln684">                        ew = new LineSegmentView;</a>
<a name="ln685">                        break;</a>
<a name="ln686">                  case ElementType::BRACKET:</a>
<a name="ln687">                        ew = new BracketView;</a>
<a name="ln688">                        break;</a>
<a name="ln689">                  default:</a>
<a name="ln690">                        ew = new ElementView;</a>
<a name="ln691">                        break;</a>
<a name="ln692">                  }</a>
<a name="ln693">            stack-&gt;addWidget(ew);</a>
<a name="ln694">            connect(ew,  SIGNAL(elementChanged(Element*)), SLOT(setElement(Element*)));</a>
<a name="ln695">            elementViews[int(el-&gt;type())] = ew;</a>
<a name="ln696">            }</a>
<a name="ln697">      curElement = el;</a>
<a name="ln698">      ew-&gt;setElement(el);</a>
<a name="ln699">      stack-&gt;setCurrentWidget(ew);</a>
<a name="ln700">      }</a>
<a name="ln701"> </a>
<a name="ln702">//-----------------------------------------</a>
<a name="ln703">//   ElementListWidgetItem</a>
<a name="ln704">//-----------------------------------------</a>
<a name="ln705"> </a>
<a name="ln706">class ElementListWidgetItem : public QListWidgetItem {</a>
<a name="ln707">      Element* e;</a>
<a name="ln708"> </a>
<a name="ln709">   public:</a>
<a name="ln710">      ElementListWidgetItem(Element* el) : QListWidgetItem () {</a>
<a name="ln711">            e = el;</a>
<a name="ln712">            setText(e-&gt;name());</a>
<a name="ln713">            }</a>
<a name="ln714">      Element* element() const { return e; }</a>
<a name="ln715">      };</a>
<a name="ln716"> </a>
<a name="ln717">//---------------------------------------------------------</a>
<a name="ln718">//   ShowPageWidget</a>
<a name="ln719">//---------------------------------------------------------</a>
<a name="ln720"> </a>
<a name="ln721">ShowPageWidget::ShowPageWidget()</a>
<a name="ln722">   : ShowElementBase()</a>
<a name="ln723">      {</a>
<a name="ln724">      pb.setupUi(addWidget());</a>
<a name="ln725">      }</a>
<a name="ln726"> </a>
<a name="ln727">//---------------------------------------------------------</a>
<a name="ln728">//   setElement</a>
<a name="ln729">//---------------------------------------------------------</a>
<a name="ln730"> </a>
<a name="ln731">void ShowPageWidget::setElement(Element* e)</a>
<a name="ln732">      {</a>
<a name="ln733">      Page* p = (Page*)e;</a>
<a name="ln734">      ShowElementBase::setElement(e);</a>
<a name="ln735">      pb.pageNo-&gt;setValue(p-&gt;no());</a>
<a name="ln736">      }</a>
<a name="ln737"> </a>
<a name="ln738">//---------------------------------------------------------</a>
<a name="ln739">//   itemClicked</a>
<a name="ln740">//---------------------------------------------------------</a>
<a name="ln741"> </a>
<a name="ln742">void ShowPageWidget::itemClicked(QListWidgetItem* i)</a>
<a name="ln743">      {</a>
<a name="ln744">      ElementListWidgetItem* item = (ElementListWidgetItem*)i;</a>
<a name="ln745">      emit elementChanged(item-&gt;element());</a>
<a name="ln746">      }</a>
<a name="ln747"> </a>
<a name="ln748">//---------------------------------------------------------</a>
<a name="ln749">//   MeasureView</a>
<a name="ln750">//---------------------------------------------------------</a>
<a name="ln751"> </a>
<a name="ln752">MeasureView::MeasureView()</a>
<a name="ln753">   : ShowElementBase()</a>
<a name="ln754">      {</a>
<a name="ln755">      mb.setupUi(addWidget());</a>
<a name="ln756">      connect(mb.sel, SIGNAL(itemClicked(QTreeWidgetItem*,int)), SLOT(elementClicked(QTreeWidgetItem*)));</a>
<a name="ln757">      connect(mb.nextButton, SIGNAL(clicked()), SLOT(nextClicked()));</a>
<a name="ln758">      connect(mb.prevButton, SIGNAL(clicked()), SLOT(prevClicked()));</a>
<a name="ln759">      connect(mb.mmRest, SIGNAL(clicked()), SLOT(mmRestClicked()));</a>
<a name="ln760"> </a>
<a name="ln761">      mb.prevButton-&gt;setIcon(*icons[int(Icons::goPrevious_ICON)]);</a>
<a name="ln762">      mb.nextButton-&gt;setIcon(*icons[int(Icons::goNext_ICON)]);</a>
<a name="ln763">      }</a>
<a name="ln764"> </a>
<a name="ln765">//---------------------------------------------------------</a>
<a name="ln766">//   nextClicked</a>
<a name="ln767">//---------------------------------------------------------</a>
<a name="ln768"> </a>
<a name="ln769">void MeasureView::nextClicked()</a>
<a name="ln770">      {</a>
<a name="ln771">      emit elementChanged(((MeasureBase*)element())-&gt;next());</a>
<a name="ln772">      }</a>
<a name="ln773"> </a>
<a name="ln774">//---------------------------------------------------------</a>
<a name="ln775">//   prevClicked</a>
<a name="ln776">//---------------------------------------------------------</a>
<a name="ln777"> </a>
<a name="ln778">void MeasureView::prevClicked()</a>
<a name="ln779">      {</a>
<a name="ln780">      emit elementChanged(((MeasureBase*)element())-&gt;prev());</a>
<a name="ln781">      }</a>
<a name="ln782"> </a>
<a name="ln783">//---------------------------------------------------------</a>
<a name="ln784">//   mmRestClicked</a>
<a name="ln785">//---------------------------------------------------------</a>
<a name="ln786"> </a>
<a name="ln787">void MeasureView::mmRestClicked()</a>
<a name="ln788">      {</a>
<a name="ln789">      emit elementChanged(((Measure*)element())-&gt;mmRest());</a>
<a name="ln790">      }</a>
<a name="ln791"> </a>
<a name="ln792">//---------------------------------------------------------</a>
<a name="ln793">//   setElement</a>
<a name="ln794">//---------------------------------------------------------</a>
<a name="ln795"> </a>
<a name="ln796">void MeasureView::setElement(Element* e)</a>
<a name="ln797">      {</a>
<a name="ln798">      Measure* m = (Measure*)e;</a>
<a name="ln799">      ShowElementBase::setElement(e);</a>
<a name="ln800"> </a>
<a name="ln801">      mb.segments-&gt;setValue(m-&gt;size());</a>
<a name="ln802">//      mb.staves-&gt;setValue(m-&gt;mstaves().size());</a>
<a name="ln803">      mb.measureNo-&gt;setValue(m-&gt;no());</a>
<a name="ln804">      mb.noOffset-&gt;setValue(m-&gt;noOffset());</a>
<a name="ln805">      mb.stretch-&gt;setValue(m-&gt;userStretch());</a>
<a name="ln806">      mb.lineBreak-&gt;setChecked(m-&gt;lineBreak());</a>
<a name="ln807">      mb.pageBreak-&gt;setChecked(m-&gt;pageBreak());</a>
<a name="ln808">      mb.sectionBreak-&gt;setChecked(m-&gt;sectionBreak());</a>
<a name="ln809">      mb.irregular-&gt;setChecked(m-&gt;irregular());</a>
<a name="ln810">      mb.repeatCount-&gt;setValue(m-&gt;repeatCount());</a>
<a name="ln811">      mb.breakMultiMeasureRest-&gt;setChecked(m-&gt;breakMultiMeasureRest());</a>
<a name="ln812">      mb.mmRestCount-&gt;setValue(m-&gt;mmRestCount());</a>
<a name="ln813">      mb.timesig-&gt;setText(m-&gt;timesig().print());</a>
<a name="ln814">      mb.len-&gt;setText(m-&gt;ticks().print());</a>
<a name="ln815">      mb.tick-&gt;setValue(m-&gt;tick().ticks());</a>
<a name="ln816">      mb.startRepeat-&gt;setChecked(m-&gt;repeatStart());</a>
<a name="ln817">      mb.endRepeat-&gt;setChecked(m-&gt;repeatEnd());</a>
<a name="ln818">      mb.hasSystemHeader-&gt;setChecked(m-&gt;header());</a>
<a name="ln819">      mb.hasSystemTrailer-&gt;setChecked(m-&gt;trailer());</a>
<a name="ln820">      mb.hasCourtesyKeySig-&gt;setChecked(m-&gt;hasCourtesyKeySig());</a>
<a name="ln821">      mb.hasVoices-&gt;setChecked(m-&gt;hasVoices(0));</a>
<a name="ln822">      mb.sel-&gt;clear();</a>
<a name="ln823">      for (const Element* elm : m-&gt;el()) {</a>
<a name="ln824">            QTreeWidgetItem* item = new QTreeWidgetItem;</a>
<a name="ln825">            item-&gt;setText(0, elm-&gt;name());</a>
<a name="ln826">//            item-&gt;setText(1, QString(&quot;%1&quot;).arg(elm-&gt;subtype()));</a>
<a name="ln827">            void* p = (void*) elm;</a>
<a name="ln828">            item-&gt;setData(0, Qt::UserRole, QVariant::fromValue&lt;void*&gt;(p));</a>
<a name="ln829">            mb.sel-&gt;addTopLevelItem(item);</a>
<a name="ln830">            }</a>
<a name="ln831">      mb.prevButton-&gt;setEnabled(m-&gt;prev());</a>
<a name="ln832">      mb.nextButton-&gt;setEnabled(m-&gt;next());</a>
<a name="ln833">      mb.mmRest-&gt;setEnabled(m-&gt;mmRest() != 0);</a>
<a name="ln834">      }</a>
<a name="ln835"> </a>
<a name="ln836">//---------------------------------------------------------</a>
<a name="ln837">//   elementClicked</a>
<a name="ln838">//---------------------------------------------------------</a>
<a name="ln839"> </a>
<a name="ln840">void MeasureView::elementClicked(QTreeWidgetItem* item)</a>
<a name="ln841">      {</a>
<a name="ln842">      Element* e = (Element*)item-&gt;data(0, Qt::UserRole).value&lt;void*&gt;();</a>
<a name="ln843">      emit elementChanged(e);</a>
<a name="ln844">      }</a>
<a name="ln845"> </a>
<a name="ln846">//---------------------------------------------------------</a>
<a name="ln847">//   SegmentView</a>
<a name="ln848">//---------------------------------------------------------</a>
<a name="ln849"> </a>
<a name="ln850">SegmentView::SegmentView()</a>
<a name="ln851">   : ShowElementBase()</a>
<a name="ln852">      {</a>
<a name="ln853">      sb.setupUi(addWidget());</a>
<a name="ln854">      sb.segmentType-&gt;clear();</a>
<a name="ln855">      connect(sb.lyrics,      SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln856">      connect(sb.spannerFor,  SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln857">      connect(sb.spannerBack, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln858">      connect(sb.annotations, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln859">      }</a>
<a name="ln860"> </a>
<a name="ln861">//---------------------------------------------------------</a>
<a name="ln862">//   setElement</a>
<a name="ln863">//---------------------------------------------------------</a>
<a name="ln864"> </a>
<a name="ln865">void SegmentView::setElement(Element* e)</a>
<a name="ln866">      {</a>
<a name="ln867">      ShowElementBase::setElement(e);</a>
<a name="ln868"> </a>
<a name="ln869">      Segment* s = (Segment*)e;</a>
<a name="ln870">      ShowElementBase::setElement(e);</a>
<a name="ln871">      int tick = s-&gt;tick().ticks();</a>
<a name="ln872">      TimeSigMap* sm = s-&gt;score()-&gt;sigmap();</a>
<a name="ln873"> </a>
<a name="ln874">      int bar = -1, beat = -1, ticks = -1;</a>
<a name="ln875">      if (tick &gt;= 0)</a>
<a name="ln876">            sm-&gt;tickValues(tick, &amp;bar, &amp;beat, &amp;ticks);</a>
<a name="ln877">      sb.bar-&gt;setValue(bar);</a>
<a name="ln878">      sb.beat-&gt;setValue(beat);</a>
<a name="ln879">      sb.ticks-&gt;setValue(ticks);</a>
<a name="ln880">      sb.tick-&gt;setValue(s-&gt;tick().ticks());</a>
<a name="ln881">      sb.rtick-&gt;setValue(s-&gt;rtick().ticks());</a>
<a name="ln882">      sb.ticks2-&gt;setValue(s-&gt;ticks().ticks());</a>
<a name="ln883">      sb.segmentType-&gt;setText(s-&gt;subTypeName());</a>
<a name="ln884">      sb.lyrics-&gt;clear();</a>
<a name="ln885"> </a>
<a name="ln886">//      Score* cs = e-&gt;score();</a>
<a name="ln887">#if 0 // TODO</a>
<a name="ln888">      for (int i = 0; i &lt; cs-&gt;nstaves(); ++i) {</a>
<a name="ln889">            const LyricsList* ll = s-&gt;lyrics(i);</a>
<a name="ln890">            if (ll) {</a>
<a name="ln891">                  foreach(Lyrics* l, *ll) {</a>
<a name="ln892">                        QString s;</a>
<a name="ln893">                        s.setNum(qptrdiff(l), 16);</a>
<a name="ln894">                        QListWidgetItem* item = new QListWidgetItem(s, 0, long(l));</a>
<a name="ln895">                        sb.lyrics-&gt;addItem(item);</a>
<a name="ln896">                        }</a>
<a name="ln897">                  }</a>
<a name="ln898">            }</a>
<a name="ln899">#endif</a>
<a name="ln900">      sb.spannerFor-&gt;clear();</a>
<a name="ln901">      sb.spannerBack-&gt;clear();</a>
<a name="ln902">      sb.annotations-&gt;clear();</a>
<a name="ln903">      foreach(Element* sp, s-&gt;annotations()) {</a>
<a name="ln904">            QListWidgetItem* item = new QListWidgetItem(QString(&quot;%1 %2&quot;).arg(qptrdiff(sp), 8, 16).arg(sp-&gt;name()));</a>
<a name="ln905">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)sp));</a>
<a name="ln906">            sb.annotations-&gt;addItem(item);</a>
<a name="ln907">            }</a>
<a name="ln908">      }</a>
<a name="ln909"> </a>
<a name="ln910">//---------------------------------------------------------</a>
<a name="ln911">//   ChordDebug</a>
<a name="ln912">//---------------------------------------------------------</a>
<a name="ln913"> </a>
<a name="ln914">ChordDebug::ChordDebug()</a>
<a name="ln915">   : ShowElementBase()</a>
<a name="ln916">      {</a>
<a name="ln917">      // chord rest</a>
<a name="ln918">      crb.setupUi(addWidget());</a>
<a name="ln919">      connect(crb.beamButton, SIGNAL(clicked()), SLOT(beamClicked()));</a>
<a name="ln920">      connect(crb.tupletButton, SIGNAL(clicked()), SLOT(tupletClicked()));</a>
<a name="ln921">      connect(crb.upFlag,   SIGNAL(toggled(bool)), SLOT(upChanged(bool)));</a>
<a name="ln922">      connect(crb.beamMode, SIGNAL(activated(int)), SLOT(beamModeChanged(int)));</a>
<a name="ln923">      connect(crb.attributes, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln924">      connect(crb.lyrics, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln925"> </a>
<a name="ln926">      // chord</a>
<a name="ln927">      cb.setupUi(addWidget());</a>
<a name="ln928">      connect(cb.hookButton, SIGNAL(clicked()), SLOT(hookClicked()));</a>
<a name="ln929">      connect(cb.stemButton, SIGNAL(clicked()), SLOT(stemClicked()));</a>
<a name="ln930">      connect(cb.stemSlashButton, SIGNAL(clicked()), SLOT(stemSlashClicked()));</a>
<a name="ln931">      connect(cb.arpeggioButton, SIGNAL(clicked()), SLOT(arpeggioClicked()));</a>
<a name="ln932">      connect(cb.tremoloButton, SIGNAL(clicked()), SLOT(tremoloClicked()));</a>
<a name="ln933">//      connect(cb.glissandoButton, SIGNAL(clicked()), SLOT(glissandoClicked()));</a>
<a name="ln934"> </a>
<a name="ln935">      connect(cb.stemDirection, SIGNAL(activated(int)), SLOT(directionChanged(int)));</a>
<a name="ln936">      connect(cb.helplineList, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln937">      connect(cb.notes, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln938">      connect(cb.graceChords1, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln939">      connect(cb.graceChords2, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln940">      connect(cb.elements,     SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln941"> </a>
<a name="ln942">      crb.beamMode-&gt;addItem(&quot;auto&quot;);</a>
<a name="ln943">      crb.beamMode-&gt;addItem(&quot;beam begin&quot;);</a>
<a name="ln944">      crb.beamMode-&gt;addItem(&quot;beam mid&quot;);</a>
<a name="ln945">      crb.beamMode-&gt;addItem(&quot;beam end&quot;);</a>
<a name="ln946">      crb.beamMode-&gt;addItem(&quot;no beam&quot;);</a>
<a name="ln947">      crb.beamMode-&gt;addItem(&quot;begin 1/32&quot;);</a>
<a name="ln948">      crb.beamMode-&gt;addItem(&quot;begin 1/64&quot;);</a>
<a name="ln949"> </a>
<a name="ln950">      cb.stemDirection-&gt;addItem(&quot;Auto&quot;, 0);</a>
<a name="ln951">      cb.stemDirection-&gt;addItem(&quot;Up&quot;,   1);</a>
<a name="ln952">      cb.stemDirection-&gt;addItem(&quot;Down&quot;, 2);</a>
<a name="ln953">      }</a>
<a name="ln954"> </a>
<a name="ln955">//---------------------------------------------------------</a>
<a name="ln956">//   setElement</a>
<a name="ln957">//---------------------------------------------------------</a>
<a name="ln958"> </a>
<a name="ln959">void ChordDebug::setElement(Element* e)</a>
<a name="ln960">      {</a>
<a name="ln961">      Chord* chord = (Chord*)e;</a>
<a name="ln962">      ShowElementBase::setElement(e);</a>
<a name="ln963"> </a>
<a name="ln964">      crb.tick-&gt;setText(chord-&gt;tick().print());</a>
<a name="ln965">      crb.ticks-&gt;setText(chord-&gt;actualTicks().print());</a>
<a name="ln966"> </a>
<a name="ln967">      crb.beamButton-&gt;setEnabled(chord-&gt;beam());</a>
<a name="ln968">      crb.tupletButton-&gt;setEnabled(chord-&gt;tuplet());</a>
<a name="ln969">      crb.upFlag-&gt;setChecked(chord-&gt;up());</a>
<a name="ln970">      crb.beamMode-&gt;setCurrentIndex(int(chord-&gt;beamMode()));</a>
<a name="ln971">      crb.dots-&gt;setValue(chord-&gt;dots());</a>
<a name="ln972">      crb.durationType-&gt;setText(chord-&gt;durationType().name());</a>
<a name="ln973">      crb.duration-&gt;setText(chord-&gt;ticks().print());</a>
<a name="ln974">      crb.move-&gt;setValue(chord-&gt;staffMove());</a>
<a name="ln975"> </a>
<a name="ln976">      cb.hookButton-&gt;setEnabled(chord-&gt;hook());</a>
<a name="ln977">      cb.stemButton-&gt;setEnabled(chord-&gt;stem());</a>
<a name="ln978">      cb.stemSlashButton-&gt;setEnabled(chord-&gt;stemSlash());</a>
<a name="ln979">      cb.arpeggioButton-&gt;setEnabled(chord-&gt;arpeggio());</a>
<a name="ln980">      cb.tremoloButton-&gt;setEnabled(chord-&gt;tremolo());</a>
<a name="ln981"> </a>
<a name="ln982">//      cb.glissandoButton-&gt;setEnabled(chord-&gt;glissando());</a>
<a name="ln983">//      cb.glissandoButton-&gt;setEnabled(false);</a>
<a name="ln984">      cb.graceNote-&gt;setChecked(chord-&gt;noteType() != NoteType::NORMAL);</a>
<a name="ln985">      cb.userPlayEvents-&gt;setChecked(chord-&gt;playEventType() != PlayEventType::Auto);</a>
<a name="ln986">      cb.endsGlissando-&gt;setChecked(chord-&gt;endsGlissando());</a>
<a name="ln987">      cb.stemDirection-&gt;setCurrentIndex(int(chord-&gt;stemDirection()));</a>
<a name="ln988"> </a>
<a name="ln989">      crb.attributes-&gt;clear();</a>
<a name="ln990">      foreach(Articulation* a, chord-&gt;articulations()) {</a>
<a name="ln991">            QString s;</a>
<a name="ln992">            s.setNum(qptrdiff(a), 16);</a>
<a name="ln993">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln994">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)a));</a>
<a name="ln995">            crb.attributes-&gt;addItem(item);</a>
<a name="ln996">            }</a>
<a name="ln997">      crb.lyrics-&gt;clear();</a>
<a name="ln998">      for (Lyrics* lyrics : chord-&gt;lyrics()) {</a>
<a name="ln999">            QString s;</a>
<a name="ln1000">            s.setNum(qptrdiff(lyrics), 16);</a>
<a name="ln1001">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln1002">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)lyrics));</a>
<a name="ln1003">            crb.lyrics-&gt;addItem(item);</a>
<a name="ln1004">            }</a>
<a name="ln1005">      cb.notes-&gt;clear();</a>
<a name="ln1006">      foreach(Element* n, chord-&gt;notes()) {</a>
<a name="ln1007">            QString s;</a>
<a name="ln1008">            s.setNum(qptrdiff(n), 16);</a>
<a name="ln1009">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln1010">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)n));</a>
<a name="ln1011">            cb.notes-&gt;addItem(item);</a>
<a name="ln1012">            }</a>
<a name="ln1013">      cb.helplineList-&gt;clear();</a>
<a name="ln1014">      for (LedgerLine* h = chord-&gt;ledgerLines(); h; h = h-&gt;next()) {</a>
<a name="ln1015">            QString s;</a>
<a name="ln1016">            s.setNum(qptrdiff(h), 16);</a>
<a name="ln1017">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln1018">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)h));</a>
<a name="ln1019">            cb.helplineList-&gt;addItem(item);</a>
<a name="ln1020">            }</a>
<a name="ln1021">      cb.graceChords1-&gt;clear();</a>
<a name="ln1022">      for (Element* c : chord-&gt;graceNotes()) {</a>
<a name="ln1023">            QString s;</a>
<a name="ln1024">            s.setNum(qptrdiff(c), 16);</a>
<a name="ln1025">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln1026">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)c));</a>
<a name="ln1027">            cb.graceChords1-&gt;addItem(item);</a>
<a name="ln1028">            }</a>
<a name="ln1029">      cb.elements-&gt;clear();</a>
<a name="ln1030">      for (Element* c : chord-&gt;el()) {</a>
<a name="ln1031">            QString s;</a>
<a name="ln1032">            s.setNum(qptrdiff(c), 16);</a>
<a name="ln1033">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln1034">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)c));</a>
<a name="ln1035">            cb.elements-&gt;addItem(item);</a>
<a name="ln1036">            }</a>
<a name="ln1037">      }</a>
<a name="ln1038"> </a>
<a name="ln1039">//---------------------------------------------------------</a>
<a name="ln1040">//   hookClicked</a>
<a name="ln1041">//---------------------------------------------------------</a>
<a name="ln1042"> </a>
<a name="ln1043">void ChordDebug::hookClicked()</a>
<a name="ln1044">      {</a>
<a name="ln1045">      emit elementChanged(((Chord*)element())-&gt;hook());</a>
<a name="ln1046">      }</a>
<a name="ln1047"> </a>
<a name="ln1048">//---------------------------------------------------------</a>
<a name="ln1049">//   stemClicked</a>
<a name="ln1050">//---------------------------------------------------------</a>
<a name="ln1051"> </a>
<a name="ln1052">void ChordDebug::stemClicked()</a>
<a name="ln1053">      {</a>
<a name="ln1054">      emit elementChanged(((Chord*)element())-&gt;stem());</a>
<a name="ln1055">      }</a>
<a name="ln1056"> </a>
<a name="ln1057">//---------------------------------------------------------</a>
<a name="ln1058">//   beamClicked</a>
<a name="ln1059">//---------------------------------------------------------</a>
<a name="ln1060"> </a>
<a name="ln1061">void ChordDebug::beamClicked()</a>
<a name="ln1062">      {</a>
<a name="ln1063">      emit elementChanged(((Chord*)element())-&gt;beam());</a>
<a name="ln1064">      }</a>
<a name="ln1065"> </a>
<a name="ln1066">//---------------------------------------------------------</a>
<a name="ln1067">//   tupletClicked</a>
<a name="ln1068">//---------------------------------------------------------</a>
<a name="ln1069"> </a>
<a name="ln1070">void ChordDebug::tupletClicked()</a>
<a name="ln1071">      {</a>
<a name="ln1072">      emit elementChanged(((Chord*)element())-&gt;tuplet());</a>
<a name="ln1073">      }</a>
<a name="ln1074"> </a>
<a name="ln1075">void ChordDebug::stemSlashClicked()</a>
<a name="ln1076">      {</a>
<a name="ln1077">      emit elementChanged(((Chord*)element())-&gt;stemSlash());</a>
<a name="ln1078">      }</a>
<a name="ln1079"> </a>
<a name="ln1080">void ChordDebug::arpeggioClicked()</a>
<a name="ln1081">      {</a>
<a name="ln1082">      emit elementChanged(((Chord*)element())-&gt;arpeggio());</a>
<a name="ln1083">      }</a>
<a name="ln1084"> </a>
<a name="ln1085">void ChordDebug::tremoloClicked()</a>
<a name="ln1086">      {</a>
<a name="ln1087">      emit elementChanged(((Chord*)element())-&gt;tremolo());</a>
<a name="ln1088">      }</a>
<a name="ln1089">/*</a>
<a name="ln1090">void ChordDebug::glissandoClicked()</a>
<a name="ln1091">      {</a>
<a name="ln1092">      emit elementChanged(((Chord*)element())-&gt;glissando());</a>
<a name="ln1093">      }</a>
<a name="ln1094">*/</a>
<a name="ln1095">//---------------------------------------------------------</a>
<a name="ln1096">//   upChanged</a>
<a name="ln1097">//---------------------------------------------------------</a>
<a name="ln1098"> </a>
<a name="ln1099">void ChordDebug::upChanged(bool val)</a>
<a name="ln1100">      {</a>
<a name="ln1101">      ((Chord*)element())-&gt;setUp(val);</a>
<a name="ln1102">      }</a>
<a name="ln1103"> </a>
<a name="ln1104">//---------------------------------------------------------</a>
<a name="ln1105">//   beamModeChanged</a>
<a name="ln1106">//---------------------------------------------------------</a>
<a name="ln1107"> </a>
<a name="ln1108">void ChordDebug::beamModeChanged(int n)</a>
<a name="ln1109">      {</a>
<a name="ln1110">      ((Chord*)element())-&gt;setBeamMode(Beam::Mode(n));</a>
<a name="ln1111">      element()-&gt;triggerLayoutAll();</a>
<a name="ln1112">      }</a>
<a name="ln1113"> </a>
<a name="ln1114">//---------------------------------------------------------</a>
<a name="ln1115">//   directionChanged</a>
<a name="ln1116">//---------------------------------------------------------</a>
<a name="ln1117"> </a>
<a name="ln1118">void ChordDebug::directionChanged(int val)</a>
<a name="ln1119">      {</a>
<a name="ln1120">      ((Chord*)element())-&gt;setStemDirection(Direction(val));</a>
<a name="ln1121">      }</a>
<a name="ln1122"> </a>
<a name="ln1123">//---------------------------------------------------------</a>
<a name="ln1124">//   ShowNoteWidget</a>
<a name="ln1125">//---------------------------------------------------------</a>
<a name="ln1126"> </a>
<a name="ln1127">ShowNoteWidget::ShowNoteWidget()</a>
<a name="ln1128">   : ShowElementBase()</a>
<a name="ln1129">      {</a>
<a name="ln1130">      nb.setupUi(addWidget());</a>
<a name="ln1131"> </a>
<a name="ln1132">      connect(nb.tieFor,     SIGNAL(clicked()), SLOT(tieForClicked()));</a>
<a name="ln1133">      connect(nb.tieBack,    SIGNAL(clicked()), SLOT(tieBackClicked()));</a>
<a name="ln1134">      connect(nb.accidental, SIGNAL(clicked()), SLOT(accidentalClicked()));</a>
<a name="ln1135">      connect(nb.fingering,  SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln1136">      connect(nb.dot1,       SIGNAL(clicked()), SLOT(dot1Clicked()));</a>
<a name="ln1137">      connect(nb.dot2,       SIGNAL(clicked()), SLOT(dot2Clicked()));</a>
<a name="ln1138">      connect(nb.dot3,       SIGNAL(clicked()), SLOT(dot3Clicked()));</a>
<a name="ln1139">      connect(nb.dot4,       SIGNAL(clicked()), SLOT(dot4Clicked()));</a>
<a name="ln1140">      }</a>
<a name="ln1141"> </a>
<a name="ln1142">//---------------------------------------------------------</a>
<a name="ln1143">//   setElement</a>
<a name="ln1144">//---------------------------------------------------------</a>
<a name="ln1145"> </a>
<a name="ln1146">void ShowNoteWidget::setElement(Element* e)</a>
<a name="ln1147">      {</a>
<a name="ln1148">      Note* note = (Note*)e;</a>
<a name="ln1149">      ShowElementBase::setElement(e);</a>
<a name="ln1150"> </a>
<a name="ln1151">      nb.pitch-&gt;setValue(note-&gt;pitch());</a>
<a name="ln1152">      nb.epitch-&gt;setValue(note-&gt;epitch());</a>
<a name="ln1153">      nb.tuning-&gt;setValue(note-&gt;tuning());</a>
<a name="ln1154">      nb.line-&gt;setValue(note-&gt;line());</a>
<a name="ln1155">      nb.string-&gt;setValue(note-&gt;string());</a>
<a name="ln1156">      nb.fret-&gt;setValue(note-&gt;fret());</a>
<a name="ln1157">      nb.mirror-&gt;setChecked(note-&gt;mirror());</a>
<a name="ln1158">      nb.tpc1-&gt;setValue(note-&gt;tpc1());</a>
<a name="ln1159">      nb.tpc2-&gt;setValue(note-&gt;tpc2());</a>
<a name="ln1160">      nb.headGroup-&gt;setValue(int(note-&gt;headGroup()));</a>
<a name="ln1161">      nb.hidden-&gt;setChecked(note-&gt;hidden());</a>
<a name="ln1162">      nb.subchannel-&gt;setValue(note-&gt;subchannel());</a>
<a name="ln1163"> </a>
<a name="ln1164">      nb.tieFor-&gt;setEnabled(note-&gt;tieFor());</a>
<a name="ln1165">      nb.tieBack-&gt;setEnabled(note-&gt;tieBack());</a>
<a name="ln1166">      nb.accidental-&gt;setEnabled(note-&gt;accidental());</a>
<a name="ln1167">      nb.dot1-&gt;setEnabled(note-&gt;dots().size() &gt; 0);</a>
<a name="ln1168">      nb.dot2-&gt;setEnabled(note-&gt;dots().size() &gt; 1);</a>
<a name="ln1169">      nb.dot3-&gt;setEnabled(note-&gt;dots().size() &gt; 2);</a>
<a name="ln1170">      nb.dot4-&gt;setEnabled(note-&gt;dots().size() &gt; 3);</a>
<a name="ln1171"> </a>
<a name="ln1172">      nb.fingering-&gt;clear();</a>
<a name="ln1173">      for (Element* text : note-&gt;el()) {</a>
<a name="ln1174">            QString s;</a>
<a name="ln1175">            s.setNum(qptrdiff(text), 16);</a>
<a name="ln1176">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln1177">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)text));</a>
<a name="ln1178">            nb.fingering-&gt;addItem(item);</a>
<a name="ln1179">            }</a>
<a name="ln1180">      nb.noteEvents-&gt;clear();</a>
<a name="ln1181">      for (const NoteEvent&amp; elm : note-&gt;playEvents()) {</a>
<a name="ln1182">            QString s = QString(&quot;%1 %2 %3&quot;).arg(elm.pitch()).arg(elm.ontime()).arg(elm.len());</a>
<a name="ln1183">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln1184">            nb.noteEvents-&gt;addItem(item);</a>
<a name="ln1185">            }</a>
<a name="ln1186">      }</a>
<a name="ln1187"> </a>
<a name="ln1188">//---------------------------------------------------------</a>
<a name="ln1189">//   dot1Clicked</a>
<a name="ln1190">//---------------------------------------------------------</a>
<a name="ln1191"> </a>
<a name="ln1192">void ShowNoteWidget::dot1Clicked()</a>
<a name="ln1193">      {</a>
<a name="ln1194">      emit elementChanged(((Note*)element())-&gt;dot(0));</a>
<a name="ln1195">      }</a>
<a name="ln1196"> </a>
<a name="ln1197">//---------------------------------------------------------</a>
<a name="ln1198">//   dot2Clicked</a>
<a name="ln1199">//---------------------------------------------------------</a>
<a name="ln1200"> </a>
<a name="ln1201">void ShowNoteWidget::dot2Clicked()</a>
<a name="ln1202">      {</a>
<a name="ln1203">      emit elementChanged(((Note*)element())-&gt;dot(1));</a>
<a name="ln1204">      }</a>
<a name="ln1205"> </a>
<a name="ln1206">//---------------------------------------------------------</a>
<a name="ln1207">//   dot3Clicked</a>
<a name="ln1208">//---------------------------------------------------------</a>
<a name="ln1209"> </a>
<a name="ln1210">void ShowNoteWidget::dot3Clicked()</a>
<a name="ln1211">      {</a>
<a name="ln1212">      emit elementChanged(((Note*)element())-&gt;dot(2));</a>
<a name="ln1213">      }</a>
<a name="ln1214"> </a>
<a name="ln1215">//---------------------------------------------------------</a>
<a name="ln1216">//   dot4Clicked</a>
<a name="ln1217">//---------------------------------------------------------</a>
<a name="ln1218"> </a>
<a name="ln1219">void ShowNoteWidget::dot4Clicked()</a>
<a name="ln1220">      {</a>
<a name="ln1221">      emit elementChanged(((Note*)element())-&gt;dot(3));</a>
<a name="ln1222">      }</a>
<a name="ln1223"> </a>
<a name="ln1224">//---------------------------------------------------------</a>
<a name="ln1225">//   tieForClicked</a>
<a name="ln1226">//---------------------------------------------------------</a>
<a name="ln1227"> </a>
<a name="ln1228">void ShowNoteWidget::tieForClicked()</a>
<a name="ln1229">      {</a>
<a name="ln1230">      emit elementChanged(((Note*)element())-&gt;tieFor());</a>
<a name="ln1231">      }</a>
<a name="ln1232"> </a>
<a name="ln1233">//---------------------------------------------------------</a>
<a name="ln1234">//   tieBackClicked</a>
<a name="ln1235">//---------------------------------------------------------</a>
<a name="ln1236"> </a>
<a name="ln1237">void ShowNoteWidget::tieBackClicked()</a>
<a name="ln1238">      {</a>
<a name="ln1239">      emit elementChanged(((Note*)element())-&gt;tieBack());</a>
<a name="ln1240">      }</a>
<a name="ln1241"> </a>
<a name="ln1242">//---------------------------------------------------------</a>
<a name="ln1243">//   accidentalClicked</a>
<a name="ln1244">//---------------------------------------------------------</a>
<a name="ln1245"> </a>
<a name="ln1246">void ShowNoteWidget::accidentalClicked()</a>
<a name="ln1247">      {</a>
<a name="ln1248">      emit elementChanged(((Note*)element())-&gt;accidental());</a>
<a name="ln1249">      }</a>
<a name="ln1250"> </a>
<a name="ln1251">//---------------------------------------------------------</a>
<a name="ln1252">//   RestView</a>
<a name="ln1253">//---------------------------------------------------------</a>
<a name="ln1254"> </a>
<a name="ln1255">RestView::RestView()</a>
<a name="ln1256">   : ShowElementBase()</a>
<a name="ln1257">      {</a>
<a name="ln1258">      // chord rest</a>
<a name="ln1259">      crb.setupUi(addWidget());</a>
<a name="ln1260">      crb.beamMode-&gt;addItem(&quot;auto&quot;);</a>
<a name="ln1261">      crb.beamMode-&gt;addItem(&quot;beam begin&quot;);</a>
<a name="ln1262">      crb.beamMode-&gt;addItem(&quot;beam mid&quot;);</a>
<a name="ln1263">      crb.beamMode-&gt;addItem(&quot;beam end&quot;);</a>
<a name="ln1264">      crb.beamMode-&gt;addItem(&quot;no beam&quot;);</a>
<a name="ln1265">      crb.beamMode-&gt;addItem(&quot;begin 1/32&quot;);</a>
<a name="ln1266"> </a>
<a name="ln1267">      rb.setupUi(addWidget());</a>
<a name="ln1268"> </a>
<a name="ln1269">      connect(crb.beamButton,   SIGNAL(clicked()), SLOT(beamClicked()));</a>
<a name="ln1270">      connect(crb.tupletButton, SIGNAL(clicked()), SLOT(tupletClicked()));</a>
<a name="ln1271">      connect(crb.attributes,   SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln1272">      connect(crb.lyrics,       SIGNAL(itemClicked(QListWidgetItem*)), SLOT(gotoElement(QListWidgetItem*)));</a>
<a name="ln1273"> </a>
<a name="ln1274">      connect(rb.dot1,          SIGNAL(clicked()), SLOT(dot1Clicked()));</a>
<a name="ln1275">      connect(rb.dot2,          SIGNAL(clicked()), SLOT(dot2Clicked()));</a>
<a name="ln1276">      connect(rb.dot3,          SIGNAL(clicked()), SLOT(dot3Clicked()));</a>
<a name="ln1277">      connect(rb.dot4,          SIGNAL(clicked()), SLOT(dot4Clicked()));</a>
<a name="ln1278">      }</a>
<a name="ln1279"> </a>
<a name="ln1280">//---------------------------------------------------------</a>
<a name="ln1281">//   setElement</a>
<a name="ln1282">//---------------------------------------------------------</a>
<a name="ln1283"> </a>
<a name="ln1284">void RestView::setElement(Element* e)</a>
<a name="ln1285">      {</a>
<a name="ln1286">      Rest* rest = toRest(e);</a>
<a name="ln1287">      ShowElementBase::setElement(e);</a>
<a name="ln1288"> </a>
<a name="ln1289">      crb.tick-&gt;setText(rest-&gt;tick().print());</a>
<a name="ln1290">      crb.ticks-&gt;setText(rest-&gt;actualTicks().print());</a>
<a name="ln1291">      crb.duration-&gt;setText(rest-&gt;ticks().print());</a>
<a name="ln1292">      crb.beamButton-&gt;setEnabled(rest-&gt;beam());</a>
<a name="ln1293">      crb.tupletButton-&gt;setEnabled(rest-&gt;tuplet());</a>
<a name="ln1294">      crb.upFlag-&gt;setChecked(rest-&gt;up());</a>
<a name="ln1295">      crb.beamMode-&gt;setCurrentIndex(int(rest-&gt;beamMode()));</a>
<a name="ln1296">      crb.attributes-&gt;clear();</a>
<a name="ln1297">      crb.dots-&gt;setValue(rest-&gt;dots());</a>
<a name="ln1298">      crb.durationType-&gt;setText(rest-&gt;durationType().name());</a>
<a name="ln1299">      crb.move-&gt;setValue(rest-&gt;staffMove());</a>
<a name="ln1300"> </a>
<a name="ln1301">      crb.lyrics-&gt;clear();</a>
<a name="ln1302">      for (Lyrics* lyrics : rest-&gt;lyrics()) {</a>
<a name="ln1303">            QString s;</a>
<a name="ln1304">            s.setNum(qptrdiff(lyrics), 16);</a>
<a name="ln1305">            QListWidgetItem* item = new QListWidgetItem(s);</a>
<a name="ln1306">            item-&gt;setData(Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)lyrics));</a>
<a name="ln1307">            crb.lyrics-&gt;addItem(item);</a>
<a name="ln1308">            }</a>
<a name="ln1309"> </a>
<a name="ln1310">      rb.sym-&gt;setValue(int(rest-&gt;sym()));</a>
<a name="ln1311">      rb.dotline-&gt;setValue(rest-&gt;getDotline());</a>
<a name="ln1312">      rb.mmWidth-&gt;setValue((rest-&gt;measure() &amp;&amp; rest-&gt;measure()-&gt;isMMRest()) ? rest-&gt;mmWidth() : 0.0);</a>
<a name="ln1313">      rb.gap-&gt;setChecked(rest-&gt;isGap());</a>
<a name="ln1314">      int dots = rest-&gt;dots();</a>
<a name="ln1315">      rb.dot1-&gt;setEnabled(dots &gt; 0);</a>
<a name="ln1316">      rb.dot2-&gt;setEnabled(dots &gt; 1);</a>
<a name="ln1317">      rb.dot3-&gt;setEnabled(dots &gt; 2);</a>
<a name="ln1318">      rb.dot4-&gt;setEnabled(dots &gt; 3);</a>
<a name="ln1319">      }</a>
<a name="ln1320"> </a>
<a name="ln1321">//---------------------------------------------------------</a>
<a name="ln1322">//   dot1Clicked</a>
<a name="ln1323">//---------------------------------------------------------</a>
<a name="ln1324"> </a>
<a name="ln1325">void RestView::dot1Clicked()</a>
<a name="ln1326">      {</a>
<a name="ln1327">      emit elementChanged(toRest(element())-&gt;dot(0));</a>
<a name="ln1328">      }</a>
<a name="ln1329"> </a>
<a name="ln1330">//---------------------------------------------------------</a>
<a name="ln1331">//   dot2Clicked</a>
<a name="ln1332">//---------------------------------------------------------</a>
<a name="ln1333"> </a>
<a name="ln1334">void RestView::dot2Clicked()</a>
<a name="ln1335">      {</a>
<a name="ln1336">      emit elementChanged(toRest(element())-&gt;dot(1));</a>
<a name="ln1337">      }</a>
<a name="ln1338"> </a>
<a name="ln1339">//---------------------------------------------------------</a>
<a name="ln1340">//   dot3Clicked</a>
<a name="ln1341">//---------------------------------------------------------</a>
<a name="ln1342"> </a>
<a name="ln1343">void RestView::dot3Clicked()</a>
<a name="ln1344">      {</a>
<a name="ln1345">      emit elementChanged(toRest(element())-&gt;dot(2));</a>
<a name="ln1346">      }</a>
<a name="ln1347"> </a>
<a name="ln1348">//---------------------------------------------------------</a>
<a name="ln1349">//   dot4Clicked</a>
<a name="ln1350">//---------------------------------------------------------</a>
<a name="ln1351"> </a>
<a name="ln1352">void RestView::dot4Clicked()</a>
<a name="ln1353">      {</a>
<a name="ln1354">      emit elementChanged(toRest(element())-&gt;dot(3));</a>
<a name="ln1355">      }</a>
<a name="ln1356"> </a>
<a name="ln1357">//---------------------------------------------------------</a>
<a name="ln1358">//   beamClicked</a>
<a name="ln1359">//---------------------------------------------------------</a>
<a name="ln1360"> </a>
<a name="ln1361">void RestView::beamClicked()</a>
<a name="ln1362">      {</a>
<a name="ln1363">      emit elementChanged(static_cast&lt;Rest*&gt;(element())-&gt;beam());</a>
<a name="ln1364">      }</a>
<a name="ln1365"> </a>
<a name="ln1366">//---------------------------------------------------------</a>
<a name="ln1367">//   tupletClicked</a>
<a name="ln1368">//---------------------------------------------------------</a>
<a name="ln1369"> </a>
<a name="ln1370">void RestView::tupletClicked()</a>
<a name="ln1371">      {</a>
<a name="ln1372">      emit elementChanged(static_cast&lt;Rest*&gt;(element())-&gt;tuplet());</a>
<a name="ln1373">      }</a>
<a name="ln1374"> </a>
<a name="ln1375">//---------------------------------------------------------</a>
<a name="ln1376">//   TimesigView</a>
<a name="ln1377">//---------------------------------------------------------</a>
<a name="ln1378"> </a>
<a name="ln1379">TimeSigView::TimeSigView()</a>
<a name="ln1380">   : ShowElementBase()</a>
<a name="ln1381">      {</a>
<a name="ln1382">      tb.setupUi(addWidget());</a>
<a name="ln1383">      }</a>
<a name="ln1384"> </a>
<a name="ln1385">//---------------------------------------------------------</a>
<a name="ln1386">//   setElement</a>
<a name="ln1387">//---------------------------------------------------------</a>
<a name="ln1388"> </a>
<a name="ln1389">void TimeSigView::setElement(Element* e)</a>
<a name="ln1390">      {</a>
<a name="ln1391">      TimeSig* tsig = static_cast&lt;TimeSig*&gt;(e);</a>
<a name="ln1392">      ShowElementBase::setElement(e);</a>
<a name="ln1393">      tb.numeratorString-&gt;setText(tsig-&gt;numeratorString());</a>
<a name="ln1394">      tb.denominatorString-&gt;setText(tsig-&gt;denominatorString());</a>
<a name="ln1395">      tb.numerator-&gt;setValue(tsig-&gt;sig().numerator());</a>
<a name="ln1396">      tb.denominator-&gt;setValue(tsig-&gt;sig().denominator());</a>
<a name="ln1397">      tb.numeratorStretch-&gt;setValue(tsig-&gt;stretch().numerator());</a>
<a name="ln1398">      tb.denominatorStretch-&gt;setValue(tsig-&gt;stretch().denominator());</a>
<a name="ln1399">      tb.showCourtesySig-&gt;setChecked(tsig-&gt;showCourtesySig());</a>
<a name="ln1400">      }</a>
<a name="ln1401"> </a>
<a name="ln1402">//---------------------------------------------------------</a>
<a name="ln1403">//   ElementView</a>
<a name="ln1404">//---------------------------------------------------------</a>
<a name="ln1405"> </a>
<a name="ln1406">ElementView::ElementView()</a>
<a name="ln1407">   : ShowElementBase()</a>
<a name="ln1408">      {</a>
<a name="ln1409">      layout-&gt;addStretch(10);</a>
<a name="ln1410">      }</a>
<a name="ln1411"> </a>
<a name="ln1412">//---------------------------------------------------------</a>
<a name="ln1413">//   TextView</a>
<a name="ln1414">//---------------------------------------------------------</a>
<a name="ln1415"> </a>
<a name="ln1416">TextView::TextView()</a>
<a name="ln1417">   : ShowElementBase()</a>
<a name="ln1418">      {</a>
<a name="ln1419">      tb.setupUi(addWidget());</a>
<a name="ln1420">      connect(tb.text, SIGNAL(textChanged()), SLOT(textChanged()));</a>
<a name="ln1421">      }</a>
<a name="ln1422"> </a>
<a name="ln1423">//---------------------------------------------------------</a>
<a name="ln1424">//   textChanged</a>
<a name="ln1425">//---------------------------------------------------------</a>
<a name="ln1426"> </a>
<a name="ln1427">void TextView::textChanged()</a>
<a name="ln1428">      {</a>
<a name="ln1429">      emit scoreChanged();</a>
<a name="ln1430">      }</a>
<a name="ln1431"> </a>
<a name="ln1432">//---------------------------------------------------------</a>
<a name="ln1433">//   setElement</a>
<a name="ln1434">//---------------------------------------------------------</a>
<a name="ln1435"> </a>
<a name="ln1436">void TextView::setElement(Element* e)</a>
<a name="ln1437">      {</a>
<a name="ln1438">      Text* te = static_cast&lt;Text*&gt;(e);</a>
<a name="ln1439"> </a>
<a name="ln1440">      tb.subStyle-&gt;setText(textStyleName(te-&gt;tid()));</a>
<a name="ln1441"> </a>
<a name="ln1442">      ShowElementBase::setElement(e);</a>
<a name="ln1443">      tb.text-&gt;setPlainText(te-&gt;xmlText());</a>
<a name="ln1444">      tb.layoutToParentWidth-&gt;setChecked(te-&gt;layoutToParentWidth());</a>
<a name="ln1445">      Align a = te-&gt;align();</a>
<a name="ln1446">      const char* h;</a>
<a name="ln1447">      if (a &amp; Align::HCENTER)</a>
<a name="ln1448">            h = &quot;center&quot;;</a>
<a name="ln1449">      else if (a &amp; Align::RIGHT)</a>
<a name="ln1450">            h = &quot;right&quot;;</a>
<a name="ln1451">      else</a>
<a name="ln1452">            h = &quot;left&quot;;</a>
<a name="ln1453">      tb.halign-&gt;setText(h);</a>
<a name="ln1454">      const char* v;</a>
<a name="ln1455">      if (a &amp; Align::BOTTOM)</a>
<a name="ln1456">            v = &quot;bottom&quot;;</a>
<a name="ln1457">      else if (a &amp; Align::VCENTER)</a>
<a name="ln1458">            v = &quot;center&quot;;</a>
<a name="ln1459">      else if (a &amp; Align::BASELINE)</a>
<a name="ln1460">            v = &quot;baseline&quot;;</a>
<a name="ln1461">      else</a>
<a name="ln1462">            v = &quot;top&quot;;</a>
<a name="ln1463">      tb.valign-&gt;setText(v);</a>
<a name="ln1464">      }</a>
<a name="ln1465"> </a>
<a name="ln1466">//---------------------------------------------------------</a>
<a name="ln1467">//   HarmonyView</a>
<a name="ln1468">//---------------------------------------------------------</a>
<a name="ln1469"> </a>
<a name="ln1470">HarmonyView::HarmonyView()</a>
<a name="ln1471">   : ShowElementBase()</a>
<a name="ln1472">      {</a>
<a name="ln1473">      tb.setupUi(addWidget());</a>
<a name="ln1474">      hb.setupUi(addWidget());</a>
<a name="ln1475"> </a>
<a name="ln1476">      connect(hb.leftParen, SIGNAL(clicked(bool)), SLOT(on_leftParen_clicked(bool)));</a>
<a name="ln1477">      connect(hb.rightParen, SIGNAL(clicked(bool)), SLOT(on_rightParen_clicked(bool)));</a>
<a name="ln1478">      }</a>
<a name="ln1479"> </a>
<a name="ln1480">//---------------------------------------------------------</a>
<a name="ln1481">//   setElement</a>
<a name="ln1482">//---------------------------------------------------------</a>
<a name="ln1483"> </a>
<a name="ln1484">void HarmonyView::setElement(Element* e)</a>
<a name="ln1485">      {</a>
<a name="ln1486">      Harmony* harmony = (Harmony*)e;</a>
<a name="ln1487"> </a>
<a name="ln1488">//      tb.textStyle-&gt;clear();</a>
<a name="ln1489">//      for (int i = 0; i &lt; int(TextStyleType::TEXT_STYLES); ++i)</a>
<a name="ln1490">//            tb.textStyle-&gt;addItem(e-&gt;score()-&gt;textStyle(TextStyleType(i)).name());</a>
<a name="ln1491"> </a>
<a name="ln1492">//      const TextStyle&amp; ts = harmony-&gt;textStyle();</a>
<a name="ln1493">      ShowElementBase::setElement(e);</a>
<a name="ln1494">      tb.text-&gt;setPlainText(harmony-&gt;xmlText());</a>
<a name="ln1495">//      tb.xoffset-&gt;setValue(ts.offset().x());</a>
<a name="ln1496">//      tb.yoffset-&gt;setValue(ts.offset().y());</a>
<a name="ln1497">//      tb.offsetType-&gt;setCurrentIndex(int(ts.offsetType()));</a>
<a name="ln1498">//TODO      tb.textStyle-&gt;setCurrentIndex(ts.textStyleType());</a>
<a name="ln1499">      tb.layoutToParentWidth-&gt;setChecked(harmony-&gt;layoutToParentWidth());</a>
<a name="ln1500"> </a>
<a name="ln1501">      hb.leftParen-&gt;setChecked(harmony-&gt;leftParen());</a>
<a name="ln1502">      hb.rightParen-&gt;setChecked(harmony-&gt;rightParen());</a>
<a name="ln1503">      hb.rootTpc-&gt;setValue(harmony-&gt;rootTpc());</a>
<a name="ln1504">      if (harmony-&gt;rootTpc() == Tpc::TPC_INVALID)</a>
<a name="ln1505">            hb.rootName-&gt;setText(&quot;&quot;);</a>
<a name="ln1506">      else</a>
<a name="ln1507">            hb.rootName-&gt;setText(harmony-&gt;rootName());</a>
<a name="ln1508">      hb.bassTpc-&gt;setValue(harmony-&gt;baseTpc());</a>
<a name="ln1509">      if (harmony-&gt;baseTpc() == Tpc::TPC_INVALID)</a>
<a name="ln1510">            hb.bassName-&gt;setText(&quot;&quot;);</a>
<a name="ln1511">      else</a>
<a name="ln1512">            hb.bassName-&gt;setText(harmony-&gt;baseName());</a>
<a name="ln1513">      hb.chordId-&gt;setValue(harmony-&gt;id());</a>
<a name="ln1514">      //hb.chordName-&gt;setText(harmony-&gt;parsedForm()-&gt;handle());</a>
<a name="ln1515">      hb.chordName-&gt;setText(harmony-&gt;hTextName());</a>
<a name="ln1516">      hb.userName-&gt;setText(harmony-&gt;hUserName());</a>
<a name="ln1517"> </a>
<a name="ln1518">      // need to set header row</a>
<a name="ln1519">      hb.degreeTab-&gt;setColumnWidth(0,hb.degreeTab-&gt;width()/3);</a>
<a name="ln1520">      hb.degreeTab-&gt;setColumnWidth(1,hb.degreeTab-&gt;width()/3);</a>
<a name="ln1521">      hb.degreeTab-&gt;setRowCount(harmony-&gt;numberOfDegrees());</a>
<a name="ln1522">      for (int i = 0, n = harmony-&gt;numberOfDegrees(); i &lt; n; ++i) {</a>
<a name="ln1523">            const HDegree&amp; d = harmony-&gt;degree(i);</a>
<a name="ln1524">            QString s;</a>
<a name="ln1525">            switch (d.type()) {</a>
<a name="ln1526">                  case HDegreeType::ADD:      s = &quot;add&quot;;      break;</a>
<a name="ln1527">                  case HDegreeType::ALTER:    s = &quot;alter&quot;;    break;</a>
<a name="ln1528">                  case HDegreeType::SUBTRACT: s = &quot;subtract&quot;; break;</a>
<a name="ln1529">                  default:                    s = &quot;&quot;;         break;</a>
<a name="ln1530">                  }</a>
<a name="ln1531">            hb.degreeTab-&gt;setItem(i, 0, new QTableWidgetItem(s));</a>
<a name="ln1532">            hb.degreeTab-&gt;setItem(i, 1, new QTableWidgetItem(QVariant(d.value()).toString()));</a>
<a name="ln1533">            hb.degreeTab-&gt;setItem(i, 2, new QTableWidgetItem(QVariant(d.alter()).toString()));</a>
<a name="ln1534">            }</a>
<a name="ln1535">      }</a>
<a name="ln1536"> </a>
<a name="ln1537">void HarmonyView::on_leftParen_clicked(bool checked)</a>
<a name="ln1538">      {</a>
<a name="ln1539">      hb.leftParen-&gt;setChecked(!checked); // simulate read-only checkbox</a>
<a name="ln1540">      }</a>
<a name="ln1541"> </a>
<a name="ln1542">void HarmonyView::on_rightParen_clicked(bool checked)</a>
<a name="ln1543">      {</a>
<a name="ln1544">      hb.rightParen-&gt;setChecked(!checked); // simulate read-only checkbox</a>
<a name="ln1545">      }</a>
<a name="ln1546"> </a>
<a name="ln1547">//---------------------------------------------------------</a>
<a name="ln1548">//   SpannerView</a>
<a name="ln1549">//---------------------------------------------------------</a>
<a name="ln1550"> </a>
<a name="ln1551">SpannerView::SpannerView()</a>
<a name="ln1552">   : ShowElementBase()</a>
<a name="ln1553">      {</a>
<a name="ln1554">      sp.setupUi(addWidget());</a>
<a name="ln1555">      connect(sp.segments, SIGNAL(itemClicked(QTreeWidgetItem*,int)), SLOT(gotoElement(QTreeWidgetItem*)));</a>
<a name="ln1556">      connect(sp.startElement, SIGNAL(clicked()), SLOT(startClicked()));</a>
<a name="ln1557">      connect(sp.endElement,   SIGNAL(clicked()), SLOT(endClicked()));</a>
<a name="ln1558">      }</a>
<a name="ln1559"> </a>
<a name="ln1560">//---------------------------------------------------------</a>
<a name="ln1561">//   setElement</a>
<a name="ln1562">//---------------------------------------------------------</a>
<a name="ln1563"> </a>
<a name="ln1564">void SpannerView::setElement(Element* e)</a>
<a name="ln1565">      {</a>
<a name="ln1566">      Spanner* spanner = static_cast&lt;Spanner*&gt;(e);</a>
<a name="ln1567">      ShowElementBase::setElement(e);</a>
<a name="ln1568">      sp.tickZ-&gt;setValue(spanner-&gt;tick().numerator());</a>
<a name="ln1569">      sp.tickN-&gt;setValue(spanner-&gt;tick().denominator());</a>
<a name="ln1570">      sp.ticks-&gt;setValue(spanner-&gt;ticks().ticks());</a>
<a name="ln1571">      sp.anchor-&gt;setCurrentIndex(int(spanner-&gt;anchor()));</a>
<a name="ln1572">      sp.track2-&gt;setValue(spanner-&gt;track2());</a>
<a name="ln1573"> </a>
<a name="ln1574">      sp.segments-&gt;clear();</a>
<a name="ln1575">      for (const Element* elm : spanner-&gt;spannerSegments()) {</a>
<a name="ln1576">            QTreeWidgetItem* item = new QTreeWidgetItem;</a>
<a name="ln1577">            item-&gt;setText(0, elm-&gt;name());</a>
<a name="ln1578">            void* p = (void*) elm;</a>
<a name="ln1579">            item-&gt;setData(0, Qt::UserRole, QVariant::fromValue&lt;void*&gt;(p));</a>
<a name="ln1580">            sp.segments-&gt;addTopLevelItem(item);</a>
<a name="ln1581">            }</a>
<a name="ln1582">      sp.startElement-&gt;setEnabled(spanner-&gt;startElement() != 0);</a>
<a name="ln1583">      sp.endElement-&gt;setEnabled(spanner-&gt;endElement() != 0);</a>
<a name="ln1584">      }</a>
<a name="ln1585"> </a>
<a name="ln1586">//---------------------------------------------------------</a>
<a name="ln1587">//   startClicked</a>
<a name="ln1588">//---------------------------------------------------------</a>
<a name="ln1589"> </a>
<a name="ln1590">void SpannerView::startClicked()</a>
<a name="ln1591">      {</a>
<a name="ln1592">      Spanner* spanner = static_cast&lt;Spanner*&gt;(element());</a>
<a name="ln1593">      emit elementChanged(spanner-&gt;startElement());</a>
<a name="ln1594">      }</a>
<a name="ln1595"> </a>
<a name="ln1596">//---------------------------------------------------------</a>
<a name="ln1597">//   startClicked</a>
<a name="ln1598">//---------------------------------------------------------</a>
<a name="ln1599"> </a>
<a name="ln1600">void SpannerView::endClicked()</a>
<a name="ln1601">      {</a>
<a name="ln1602">      Spanner* spanner = static_cast&lt;Spanner*&gt;(element());</a>
<a name="ln1603">      emit elementChanged(spanner-&gt;endElement());</a>
<a name="ln1604">      }</a>
<a name="ln1605"> </a>
<a name="ln1606">//---------------------------------------------------------</a>
<a name="ln1607">//   HairpinView</a>
<a name="ln1608">//---------------------------------------------------------</a>
<a name="ln1609"> </a>
<a name="ln1610">HairpinView::HairpinView()</a>
<a name="ln1611">   : SpannerView()</a>
<a name="ln1612">      {</a>
<a name="ln1613">      sl.setupUi(addWidget());</a>
<a name="ln1614">      hp.setupUi(addWidget());</a>
<a name="ln1615">      }</a>
<a name="ln1616"> </a>
<a name="ln1617">//---------------------------------------------------------</a>
<a name="ln1618">//   setElement</a>
<a name="ln1619">//---------------------------------------------------------</a>
<a name="ln1620"> </a>
<a name="ln1621">void HairpinView::setElement(Element* e)</a>
<a name="ln1622">      {</a>
<a name="ln1623">      SpannerView::setElement(e);</a>
<a name="ln1624">      Hairpin* hairpin = (Hairpin*)e;</a>
<a name="ln1625">      ShowElementBase::setElement(e);</a>
<a name="ln1626">      sl.diagonal-&gt;setChecked(hairpin-&gt;diagonal());</a>
<a name="ln1627">      hp.veloChange-&gt;setValue(hairpin-&gt;veloChange());</a>
<a name="ln1628">      }</a>
<a name="ln1629"> </a>
<a name="ln1630">//---------------------------------------------------------</a>
<a name="ln1631">//   BarLineView</a>
<a name="ln1632">//---------------------------------------------------------</a>
<a name="ln1633"> </a>
<a name="ln1634">BarLineView::BarLineView()</a>
<a name="ln1635">   : ShowElementBase()</a>
<a name="ln1636">      {</a>
<a name="ln1637">      bl.setupUi(addWidget());</a>
<a name="ln1638">      }</a>
<a name="ln1639"> </a>
<a name="ln1640">//---------------------------------------------------------</a>
<a name="ln1641">//   setElement</a>
<a name="ln1642">//---------------------------------------------------------</a>
<a name="ln1643"> </a>
<a name="ln1644">void BarLineView::setElement(Element* e)</a>
<a name="ln1645">      {</a>
<a name="ln1646">      BarLine* barline = (BarLine*)e;</a>
<a name="ln1647">      ShowElementBase::setElement(e);</a>
<a name="ln1648">      bl.subType-&gt;setValue(int(barline-&gt;barLineType()));</a>
<a name="ln1649">      bl.span-&gt;setValue(barline-&gt;spanStaff());</a>
<a name="ln1650">      bl.spanFrom-&gt;setValue(barline-&gt;spanFrom());</a>
<a name="ln1651">      bl.spanTo-&gt;setValue(barline-&gt;spanTo());</a>
<a name="ln1652">//      bl.customSubtype-&gt;setChecked(barline-&gt;customSubtype());</a>
<a name="ln1653">//      bl.customSpan-&gt;setChecked(barline-&gt;customSpan());</a>
<a name="ln1654">      }</a>
<a name="ln1655"> </a>
<a name="ln1656">//---------------------------------------------------------</a>
<a name="ln1657">//   DynamicView</a>
<a name="ln1658">//---------------------------------------------------------</a>
<a name="ln1659"> </a>
<a name="ln1660">DynamicView::DynamicView()</a>
<a name="ln1661">   : ShowElementBase()</a>
<a name="ln1662">      {</a>
<a name="ln1663">      tb.setupUi(addWidget());</a>
<a name="ln1664">      bl.setupUi(addWidget());</a>
<a name="ln1665">      }</a>
<a name="ln1666"> </a>
<a name="ln1667">//---------------------------------------------------------</a>
<a name="ln1668">//   setElement</a>
<a name="ln1669">//---------------------------------------------------------</a>
<a name="ln1670"> </a>
<a name="ln1671">void DynamicView::setElement(Element* e)</a>
<a name="ln1672">      {</a>
<a name="ln1673">      Dynamic* dynamic = toDynamic(e);</a>
<a name="ln1674"> </a>
<a name="ln1675">      tb.text-&gt;setPlainText(dynamic-&gt;xmlText());</a>
<a name="ln1676">//      tb.xoffset-&gt;setValue(dynamic-&gt;offset().x());</a>
<a name="ln1677">//      tb.yoffset-&gt;setValue(dynamic-&gt;offset().y());</a>
<a name="ln1678">//      tb.offsetType-&gt;setCurrentIndex(int(dynamic-&gt;offsetType()));</a>
<a name="ln1679">      tb.layoutToParentWidth-&gt;setChecked(dynamic-&gt;layoutToParentWidth());</a>
<a name="ln1680"> </a>
<a name="ln1681">      ShowElementBase::setElement(e);</a>
<a name="ln1682">      bl.subType-&gt;setValue(int(dynamic-&gt;dynamicType()));</a>
<a name="ln1683">      }</a>
<a name="ln1684"> </a>
<a name="ln1685">//---------------------------------------------------------</a>
<a name="ln1686">//   TupletView</a>
<a name="ln1687">//---------------------------------------------------------</a>
<a name="ln1688"> </a>
<a name="ln1689">TupletView::TupletView()</a>
<a name="ln1690">   : ShowElementBase()</a>
<a name="ln1691">      {</a>
<a name="ln1692">      tb.setupUi(addWidget());</a>
<a name="ln1693"> </a>
<a name="ln1694">      tb.direction-&gt;addItem(&quot;Auto&quot;, 0);</a>
<a name="ln1695">      tb.direction-&gt;addItem(&quot;Up&quot;,   1);</a>
<a name="ln1696">      tb.direction-&gt;addItem(&quot;Down&quot;, 2);</a>
<a name="ln1697"> </a>
<a name="ln1698"> </a>
<a name="ln1699">      connect(tb.number, SIGNAL(clicked()), SLOT(numberClicked()));</a>
<a name="ln1700">      connect(tb.tuplet, SIGNAL(clicked()), SLOT(tupletClicked()));</a>
<a name="ln1701">      connect(tb.elements, SIGNAL(itemClicked(QTreeWidgetItem*,int)), SLOT(elementClicked(QTreeWidgetItem*)));</a>
<a name="ln1702">      }</a>
<a name="ln1703"> </a>
<a name="ln1704">//---------------------------------------------------------</a>
<a name="ln1705">//   numberClicked</a>
<a name="ln1706">//---------------------------------------------------------</a>
<a name="ln1707"> </a>
<a name="ln1708">void TupletView::numberClicked()</a>
<a name="ln1709">      {</a>
<a name="ln1710">      emit elementChanged(((Tuplet*)element())-&gt;number());</a>
<a name="ln1711">      }</a>
<a name="ln1712"> </a>
<a name="ln1713">//---------------------------------------------------------</a>
<a name="ln1714">//   tupletClicked</a>
<a name="ln1715">//---------------------------------------------------------</a>
<a name="ln1716"> </a>
<a name="ln1717">void TupletView::tupletClicked()</a>
<a name="ln1718">      {</a>
<a name="ln1719">      emit elementChanged(((Tuplet*)element())-&gt;tuplet());</a>
<a name="ln1720">      }</a>
<a name="ln1721"> </a>
<a name="ln1722">//---------------------------------------------------------</a>
<a name="ln1723">//   elementClicked</a>
<a name="ln1724">//---------------------------------------------------------</a>
<a name="ln1725"> </a>
<a name="ln1726">void TupletView::elementClicked(QTreeWidgetItem* item)</a>
<a name="ln1727">      {</a>
<a name="ln1728">      Element* e = (Element*)item-&gt;data(0, Qt::UserRole).value&lt;void*&gt;();</a>
<a name="ln1729">      emit elementChanged(e);</a>
<a name="ln1730">      }</a>
<a name="ln1731"> </a>
<a name="ln1732">//---------------------------------------------------------</a>
<a name="ln1733">//   setElement</a>
<a name="ln1734">//---------------------------------------------------------</a>
<a name="ln1735"> </a>
<a name="ln1736">void TupletView::setElement(Element* e)</a>
<a name="ln1737">      {</a>
<a name="ln1738">      ShowElementBase::setElement(e);</a>
<a name="ln1739">      Tuplet* tuplet = static_cast&lt;Tuplet*&gt;(e);</a>
<a name="ln1740">      tb.baseLen-&gt;setText(tuplet-&gt;baseLen().name());</a>
<a name="ln1741">      tb.ratioZ-&gt;setValue(tuplet-&gt;ratio().numerator());</a>
<a name="ln1742">      tb.ratioN-&gt;setValue(tuplet-&gt;ratio().denominator());</a>
<a name="ln1743">      tb.number-&gt;setEnabled(tuplet-&gt;number());</a>
<a name="ln1744">      tb.tuplet-&gt;setEnabled(tuplet-&gt;tuplet());</a>
<a name="ln1745">      tb.duration-&gt;setText(tuplet-&gt;ticks().print());</a>
<a name="ln1746"> </a>
<a name="ln1747">      tb.elements-&gt;clear();</a>
<a name="ln1748">      for (DurationElement* elm : tuplet-&gt;elements()) {</a>
<a name="ln1749">            QTreeWidgetItem* item = new QTreeWidgetItem;</a>
<a name="ln1750">            item-&gt;setText(0, elm-&gt;name());</a>
<a name="ln1751">            item-&gt;setText(1, QString(&quot;%1&quot;).arg(elm-&gt;tick().ticks()));</a>
<a name="ln1752">            item-&gt;setText(2, QString(&quot;%1&quot;).arg(elm-&gt;actualTicks().ticks()));</a>
<a name="ln1753">            void* p = (void*) elm;</a>
<a name="ln1754">            item-&gt;setData(0, Qt::UserRole, QVariant::fromValue&lt;void*&gt;(p));</a>
<a name="ln1755">            tb.elements-&gt;addTopLevelItem(item);</a>
<a name="ln1756">            }</a>
<a name="ln1757">      tb.isUp-&gt;setChecked(tuplet-&gt;isUp());</a>
<a name="ln1758">      tb.direction-&gt;setCurrentIndex(int(tuplet-&gt;direction()));</a>
<a name="ln1759">      }</a>
<a name="ln1760"> </a>
<a name="ln1761">//---------------------------------------------------------</a>
<a name="ln1762">//   DoubleLabel</a>
<a name="ln1763">//---------------------------------------------------------</a>
<a name="ln1764"> </a>
<a name="ln1765">DoubleLabel::DoubleLabel(QWidget* parent)</a>
<a name="ln1766">   : QLabel(parent)</a>
<a name="ln1767">      {</a>
<a name="ln1768">//      setFrameStyle(QFrame::LineEditPanel | QFrame::Sunken);</a>
<a name="ln1769">  //    setPaletteBackgroundColor(palette().active().brightText());</a>
<a name="ln1770">      }</a>
<a name="ln1771"> </a>
<a name="ln1772">//---------------------------------------------------------</a>
<a name="ln1773">//   setValue</a>
<a name="ln1774">//---------------------------------------------------------</a>
<a name="ln1775"> </a>
<a name="ln1776">void DoubleLabel::setValue(double val)</a>
<a name="ln1777">      {</a>
<a name="ln1778">      QString s;</a>
<a name="ln1779">      setText(s.setNum(val, 'g', 3));</a>
<a name="ln1780">      }</a>
<a name="ln1781"> </a>
<a name="ln1782">//---------------------------------------------------------</a>
<a name="ln1783">//   sizeHint</a>
<a name="ln1784">//---------------------------------------------------------</a>
<a name="ln1785"> </a>
<a name="ln1786">QSize DoubleLabel::sizeHint() const</a>
<a name="ln1787">      {</a>
<a name="ln1788">      QFontMetrics fm = fontMetrics();</a>
<a name="ln1789">      int h           = fm.height() + 4;</a>
<a name="ln1790">      int n           = 3 + 3;</a>
<a name="ln1791">      int w = fm.width(QString(&quot;-0.&quot;)) + fm.width('0') * n + 6;</a>
<a name="ln1792">      return QSize(w, h);</a>
<a name="ln1793">      }</a>
<a name="ln1794"> </a>
<a name="ln1795">//---------------------------------------------------------</a>
<a name="ln1796">//   ShowElementBase</a>
<a name="ln1797">//---------------------------------------------------------</a>
<a name="ln1798"> </a>
<a name="ln1799">ShowElementBase::ShowElementBase()</a>
<a name="ln1800">   : QWidget()</a>
<a name="ln1801">      {</a>
<a name="ln1802">      el = 0;</a>
<a name="ln1803">      layout = new QVBoxLayout;</a>
<a name="ln1804">      setLayout(layout);</a>
<a name="ln1805">      layout-&gt;addStretch(2000);</a>
<a name="ln1806"> </a>
<a name="ln1807">      eb.setupUi(addWidget());</a>
<a name="ln1808"> </a>
<a name="ln1809">      connect(eb.parentButton,   SIGNAL(clicked()), SLOT(parentClicked()));</a>
<a name="ln1810">      connect(eb.offsetx,        SIGNAL(valueChanged(double)), SLOT(offsetxChanged(double)));</a>
<a name="ln1811">      connect(eb.offsety,        SIGNAL(valueChanged(double)), SLOT(offsetyChanged(double)));</a>
<a name="ln1812">      connect(eb.selected,       SIGNAL(clicked(bool)), SLOT(selectedClicked(bool)));</a>
<a name="ln1813">      connect(eb.visible,        SIGNAL(clicked(bool)), SLOT(visibleClicked(bool)));</a>
<a name="ln1814">      connect(eb.link1,          SIGNAL(clicked()), SLOT(linkClicked()));</a>
<a name="ln1815">      connect(eb.link2,          SIGNAL(clicked()), SLOT(link2Clicked()));</a>
<a name="ln1816">      connect(eb.link3,          SIGNAL(clicked()), SLOT(link3Clicked()));</a>
<a name="ln1817">      }</a>
<a name="ln1818"> </a>
<a name="ln1819">//---------------------------------------------------------</a>
<a name="ln1820">//   addWidget</a>
<a name="ln1821">//---------------------------------------------------------</a>
<a name="ln1822"> </a>
<a name="ln1823">QWidget* ShowElementBase::addWidget()</a>
<a name="ln1824">      {</a>
<a name="ln1825">      QWidget* w = new QWidget;</a>
<a name="ln1826">      layout-&gt;insertWidget(layout-&gt;count()-1, w);</a>
<a name="ln1827">      return w;</a>
<a name="ln1828">      }</a>
<a name="ln1829"> </a>
<a name="ln1830">//---------------------------------------------------------</a>
<a name="ln1831">//   gotoElement</a>
<a name="ln1832">//---------------------------------------------------------</a>
<a name="ln1833"> </a>
<a name="ln1834">void ShowElementBase::gotoElement(QListWidgetItem* item)</a>
<a name="ln1835">      {</a>
<a name="ln1836">      Element* e = (Element*)item-&gt;data(Qt::UserRole).value&lt;void*&gt;();</a>
<a name="ln1837">      emit elementChanged(e);</a>
<a name="ln1838">      }</a>
<a name="ln1839"> </a>
<a name="ln1840">//---------------------------------------------------------</a>
<a name="ln1841">//   gotoElement</a>
<a name="ln1842">//---------------------------------------------------------</a>
<a name="ln1843"> </a>
<a name="ln1844">void ShowElementBase::gotoElement(QTreeWidgetItem* item)</a>
<a name="ln1845">      {</a>
<a name="ln1846">      Element* e = (Element*)item-&gt;data(0, Qt::UserRole).value&lt;void*&gt;();</a>
<a name="ln1847">      emit elementChanged(e);</a>
<a name="ln1848">      }</a>
<a name="ln1849"> </a>
<a name="ln1850">//---------------------------------------------------------</a>
<a name="ln1851">//   ShowElementBase</a>
<a name="ln1852">//---------------------------------------------------------</a>
<a name="ln1853"> </a>
<a name="ln1854">void ShowElementBase::setElement(Element* e)</a>
<a name="ln1855">      {</a>
<a name="ln1856">      el = e;</a>
<a name="ln1857"> </a>
<a name="ln1858">      eb.address-&gt;setText(QString(&quot;%1&quot;).arg((quintptr)e, 0, 16));</a>
<a name="ln1859">      eb.score-&gt;setText(QString(&quot;%1&quot;).arg((quintptr)(e-&gt;score()), 0, 16));</a>
<a name="ln1860"> </a>
<a name="ln1861">      eb.selected-&gt;setChecked(e-&gt;selected());</a>
<a name="ln1862">      eb.selectable-&gt;setChecked(e-&gt;selectable());</a>
<a name="ln1863">      eb.droptarget-&gt;setChecked(e-&gt;dropTarget());</a>
<a name="ln1864">      eb.generated-&gt;setChecked(e-&gt;generated());</a>
<a name="ln1865">      eb.visible-&gt;setChecked(e-&gt;visible());</a>
<a name="ln1866">      eb.enabled-&gt;setChecked(e-&gt;enabled());</a>
<a name="ln1867">      eb.header-&gt;setChecked(e-&gt;header());</a>
<a name="ln1868">      eb.trailer-&gt;setChecked(e-&gt;trailer());</a>
<a name="ln1869">      eb.spatiumSize-&gt;setChecked(e-&gt;sizeIsSpatiumDependent());</a>
<a name="ln1870"> </a>
<a name="ln1871">      eb.track-&gt;setValue(e-&gt;track());</a>
<a name="ln1872">      eb.z-&gt;setValue(e-&gt;z());</a>
<a name="ln1873">      eb.posx-&gt;setValue(e-&gt;ipos().x());</a>
<a name="ln1874">      eb.posy-&gt;setValue(e-&gt;ipos().y());</a>
<a name="ln1875">      eb.cposx-&gt;setValue(e-&gt;pagePos().x());</a>
<a name="ln1876">      eb.cposy-&gt;setValue(e-&gt;pagePos().y());</a>
<a name="ln1877">      eb.offsetx-&gt;setValue(e-&gt;offset().x());</a>
<a name="ln1878">      eb.offsety-&gt;setValue(e-&gt;offset().y());</a>
<a name="ln1879">      eb.autoplace-&gt;setChecked(e-&gt;autoplace());</a>
<a name="ln1880">      eb.placement-&gt;setCurrentIndex(int(e-&gt;placement()));</a>
<a name="ln1881"> </a>
<a name="ln1882">      eb.bboxx-&gt;setValue(e-&gt;bbox().x());</a>
<a name="ln1883">      eb.bboxy-&gt;setValue(e-&gt;bbox().y());</a>
<a name="ln1884">      eb.bboxw-&gt;setValue(e-&gt;bbox().width());</a>
<a name="ln1885">      eb.bboxh-&gt;setValue(e-&gt;bbox().height());</a>
<a name="ln1886">      eb.color-&gt;setColor(e-&gt;color());</a>
<a name="ln1887">      eb.parentButton-&gt;setEnabled(e-&gt;parent());</a>
<a name="ln1888">      eb.link1-&gt;setEnabled(e-&gt;links());</a>
<a name="ln1889">      eb.link2-&gt;setEnabled(e-&gt;links() &amp;&amp; e-&gt;links()-&gt;size() &gt; 1);</a>
<a name="ln1890">      eb.link3-&gt;setEnabled(e-&gt;links() &amp;&amp; e-&gt;links()-&gt;size() &gt; 2);</a>
<a name="ln1891">      eb.mag-&gt;setValue(e-&gt;mag());</a>
<a name="ln1892">      eb.systemFlag-&gt;setChecked(e-&gt;systemFlag());</a>
<a name="ln1893">      }</a>
<a name="ln1894"> </a>
<a name="ln1895">//---------------------------------------------------------</a>
<a name="ln1896">//   selectedClicked</a>
<a name="ln1897">//---------------------------------------------------------</a>
<a name="ln1898"> </a>
<a name="ln1899">void ShowElementBase::selectedClicked(bool val)</a>
<a name="ln1900">      {</a>
<a name="ln1901">      QRectF r(el-&gt;abbox());</a>
<a name="ln1902">      if (val)</a>
<a name="ln1903">            el-&gt;score()-&gt;select(el, SelectType::ADD, 0);</a>
<a name="ln1904">      else</a>
<a name="ln1905">            el-&gt;score()-&gt;deselect(el);</a>
<a name="ln1906">      el-&gt;score()-&gt;addRefresh(r | el-&gt;abbox());</a>
<a name="ln1907">      }</a>
<a name="ln1908"> </a>
<a name="ln1909">//---------------------------------------------------------</a>
<a name="ln1910">//   visibleClicked</a>
<a name="ln1911">//---------------------------------------------------------</a>
<a name="ln1912"> </a>
<a name="ln1913">void ShowElementBase::visibleClicked(bool val)</a>
<a name="ln1914">      {</a>
<a name="ln1915">      QRectF r(el-&gt;abbox());</a>
<a name="ln1916">      el-&gt;setVisible(val);</a>
<a name="ln1917">      el-&gt;score()-&gt;addRefresh(r | el-&gt;abbox());</a>
<a name="ln1918">      }</a>
<a name="ln1919"> </a>
<a name="ln1920">//---------------------------------------------------------</a>
<a name="ln1921">//   parentClicked</a>
<a name="ln1922">//---------------------------------------------------------</a>
<a name="ln1923"> </a>
<a name="ln1924">void ShowElementBase::parentClicked()</a>
<a name="ln1925">      {</a>
<a name="ln1926">      emit elementChanged(el-&gt;parent());</a>
<a name="ln1927">      }</a>
<a name="ln1928"> </a>
<a name="ln1929">//---------------------------------------------------------</a>
<a name="ln1930">//   linkClicked</a>
<a name="ln1931">//---------------------------------------------------------</a>
<a name="ln1932"> </a>
<a name="ln1933">void ShowElementBase::linkClicked()</a>
<a name="ln1934">      {</a>
<a name="ln1935">      emit elementChanged(static_cast&lt;Element*&gt;(el-&gt;links()-&gt;at(0)));</a>
<a name="ln1936">      }</a>
<a name="ln1937"> </a>
<a name="ln1938">//---------------------------------------------------------</a>
<a name="ln1939">//   link2Clicked</a>
<a name="ln1940">//---------------------------------------------------------</a>
<a name="ln1941"> </a>
<a name="ln1942">void ShowElementBase::link2Clicked()</a>
<a name="ln1943">      {</a>
<a name="ln1944">      emit elementChanged(static_cast&lt;Element*&gt;(el-&gt;links()-&gt;at(1)));</a>
<a name="ln1945">      }</a>
<a name="ln1946"> </a>
<a name="ln1947">//---------------------------------------------------------</a>
<a name="ln1948">//   link3Clicked</a>
<a name="ln1949">//---------------------------------------------------------</a>
<a name="ln1950"> </a>
<a name="ln1951">void ShowElementBase::link3Clicked()</a>
<a name="ln1952">      {</a>
<a name="ln1953">      emit elementChanged(static_cast&lt;Element*&gt;(el-&gt;links()-&gt;at(2)));</a>
<a name="ln1954">      }</a>
<a name="ln1955"> </a>
<a name="ln1956">//---------------------------------------------------------</a>
<a name="ln1957">//   offsetxChanged</a>
<a name="ln1958">//---------------------------------------------------------</a>
<a name="ln1959"> </a>
<a name="ln1960">void ShowElementBase::offsetxChanged(double val)</a>
<a name="ln1961">      {</a>
<a name="ln1962">      QRectF r(el-&gt;abbox());</a>
<a name="ln1963">      el-&gt;rxoffset() = val;</a>
<a name="ln1964">//      Element* e = el;</a>
<a name="ln1965">//TODO      while ((e = e-&gt;parent()))</a>
<a name="ln1966">      el-&gt;score()-&gt;addRefresh(r | el-&gt;abbox());</a>
<a name="ln1967">      }</a>
<a name="ln1968"> </a>
<a name="ln1969">//---------------------------------------------------------</a>
<a name="ln1970">//   offsetyChanged</a>
<a name="ln1971">//---------------------------------------------------------</a>
<a name="ln1972"> </a>
<a name="ln1973">void ShowElementBase::offsetyChanged(double val)</a>
<a name="ln1974">      {</a>
<a name="ln1975">      QRectF r(el-&gt;abbox());</a>
<a name="ln1976">      el-&gt;ryoffset() = val;</a>
<a name="ln1977">      el-&gt;score()-&gt;addRefresh(r | el-&gt;abbox());</a>
<a name="ln1978">      }</a>
<a name="ln1979"> </a>
<a name="ln1980">//---------------------------------------------------------</a>
<a name="ln1981">//   SlurTieView</a>
<a name="ln1982">//---------------------------------------------------------</a>
<a name="ln1983"> </a>
<a name="ln1984">SlurTieView::SlurTieView()</a>
<a name="ln1985">   : SpannerView()</a>
<a name="ln1986">      {</a>
<a name="ln1987">      st.setupUi(addWidget());</a>
<a name="ln1988">      }</a>
<a name="ln1989"> </a>
<a name="ln1990">//---------------------------------------------------------</a>
<a name="ln1991">//   setElement</a>
<a name="ln1992">//---------------------------------------------------------</a>
<a name="ln1993"> </a>
<a name="ln1994">void SlurTieView::setElement(Element* e)</a>
<a name="ln1995">      {</a>
<a name="ln1996">      Slur* slur = (Slur*)e;</a>
<a name="ln1997">      SpannerView::setElement(e);</a>
<a name="ln1998"> </a>
<a name="ln1999">      st.upFlag-&gt;setChecked(slur-&gt;up());</a>
<a name="ln2000">      st.direction-&gt;setCurrentIndex(int(slur-&gt;slurDirection()));</a>
<a name="ln2001">      }</a>
<a name="ln2002"> </a>
<a name="ln2003">//---------------------------------------------------------</a>
<a name="ln2004">//   segmentClicked</a>
<a name="ln2005">//---------------------------------------------------------</a>
<a name="ln2006"> </a>
<a name="ln2007">void SlurTieView::segmentClicked(QTreeWidgetItem* item)</a>
<a name="ln2008">      {</a>
<a name="ln2009">      Element* e = (Element*)item-&gt;data(0, Qt::UserRole).value&lt;void*&gt;();</a>
<a name="ln2010">      emit elementChanged(e);</a>
<a name="ln2011">      }</a>
<a name="ln2012"> </a>
<a name="ln2013">//---------------------------------------------------------</a>
<a name="ln2014">//   TieView</a>
<a name="ln2015">//---------------------------------------------------------</a>
<a name="ln2016"> </a>
<a name="ln2017">TieView::TieView()</a>
<a name="ln2018">   : SlurTieView()</a>
<a name="ln2019">      {</a>
<a name="ln2020">      tb.setupUi(addWidget());</a>
<a name="ln2021">      connect(tb.startNote, SIGNAL(clicked()), SLOT(startClicked()));</a>
<a name="ln2022">      connect(tb.endNote, SIGNAL(clicked()), SLOT(endClicked()));</a>
<a name="ln2023">      }</a>
<a name="ln2024"> </a>
<a name="ln2025">//---------------------------------------------------------</a>
<a name="ln2026">//   setElement</a>
<a name="ln2027">//---------------------------------------------------------</a>
<a name="ln2028"> </a>
<a name="ln2029">void TieView::setElement(Element* e)</a>
<a name="ln2030">      {</a>
<a name="ln2031">      SlurTieView::setElement(e);</a>
<a name="ln2032">      }</a>
<a name="ln2033"> </a>
<a name="ln2034">//---------------------------------------------------------</a>
<a name="ln2035">//   startClicked</a>
<a name="ln2036">//---------------------------------------------------------</a>
<a name="ln2037"> </a>
<a name="ln2038">void TieView::startClicked()</a>
<a name="ln2039">      {</a>
<a name="ln2040">      emit elementChanged(static_cast&lt;Spanner*&gt;(element())-&gt;startElement());</a>
<a name="ln2041">      }</a>
<a name="ln2042"> </a>
<a name="ln2043">//---------------------------------------------------------</a>
<a name="ln2044">//   endClicked</a>
<a name="ln2045">//---------------------------------------------------------</a>
<a name="ln2046"> </a>
<a name="ln2047">void TieView::endClicked()</a>
<a name="ln2048">      {</a>
<a name="ln2049">      emit elementChanged(static_cast&lt;Spanner*&gt;(element())-&gt;endElement());</a>
<a name="ln2050">      }</a>
<a name="ln2051"> </a>
<a name="ln2052">//---------------------------------------------------------</a>
<a name="ln2053">//   segmentClicked</a>
<a name="ln2054">//---------------------------------------------------------</a>
<a name="ln2055"> </a>
<a name="ln2056">void VoltaView::segmentClicked(QTreeWidgetItem* item)</a>
<a name="ln2057">      {</a>
<a name="ln2058">      Element* e = (Element*)item-&gt;data(0, Qt::UserRole).value&lt;void*&gt;();</a>
<a name="ln2059">      emit elementChanged(e);</a>
<a name="ln2060">      }</a>
<a name="ln2061"> </a>
<a name="ln2062">//---------------------------------------------------------</a>
<a name="ln2063">//   beginTextClicked</a>
<a name="ln2064">//---------------------------------------------------------</a>
<a name="ln2065"> </a>
<a name="ln2066">void VoltaView::beginTextClicked()</a>
<a name="ln2067">      {</a>
<a name="ln2068">//TODO      emit elementChanged(static_cast&lt;Volta*&gt;(element())-&gt;beginTextElement());</a>
<a name="ln2069">      }</a>
<a name="ln2070"> </a>
<a name="ln2071">//---------------------------------------------------------</a>
<a name="ln2072">//   continueTextClicked</a>
<a name="ln2073">//---------------------------------------------------------</a>
<a name="ln2074"> </a>
<a name="ln2075">void VoltaView::continueTextClicked()</a>
<a name="ln2076">      {</a>
<a name="ln2077">//TODO      emit elementChanged(static_cast&lt;Volta*&gt;(element())-&gt;continueTextElement());</a>
<a name="ln2078">      }</a>
<a name="ln2079"> </a>
<a name="ln2080">//---------------------------------------------------------</a>
<a name="ln2081">//   endTextClicked</a>
<a name="ln2082">//---------------------------------------------------------</a>
<a name="ln2083"> </a>
<a name="ln2084">void VoltaView::endTextClicked()</a>
<a name="ln2085">      {</a>
<a name="ln2086">//TODO      emit elementChanged(static_cast&lt;Volta*&gt;(element())-&gt;endTextElement());</a>
<a name="ln2087">      }</a>
<a name="ln2088"> </a>
<a name="ln2089">//---------------------------------------------------------</a>
<a name="ln2090">//   VoltaView</a>
<a name="ln2091">//---------------------------------------------------------</a>
<a name="ln2092"> </a>
<a name="ln2093">VoltaView::VoltaView()</a>
<a name="ln2094">   : ShowElementBase()</a>
<a name="ln2095">      {</a>
<a name="ln2096">      sp.setupUi(addWidget());</a>
<a name="ln2097"> </a>
<a name="ln2098">      // SLineBase</a>
<a name="ln2099">      lb.setupUi(addWidget());</a>
<a name="ln2100"> </a>
<a name="ln2101">      // TextLineBase</a>
<a name="ln2102">      tlb.setupUi(addWidget());</a>
<a name="ln2103"> </a>
<a name="ln2104">      connect(tlb.beginText,    SIGNAL(clicked()), SLOT(beginTextClicked()));</a>
<a name="ln2105">      connect(tlb.continueText, SIGNAL(clicked()), SLOT(continueTextClicked()));</a>
<a name="ln2106">      connect(tlb.endText,      SIGNAL(clicked()), SLOT(endTextClicked()));</a>
<a name="ln2107">      connect(sp.segments,      SIGNAL(itemClicked(QTreeWidgetItem*,int)), SLOT(gotoElement(QTreeWidgetItem*)));</a>
<a name="ln2108">      connect(sp.startElement,  SIGNAL(clicked()), SLOT(startClicked()));</a>
<a name="ln2109">      connect(sp.endElement,    SIGNAL(clicked()), SLOT(endClicked()));</a>
<a name="ln2110">      }</a>
<a name="ln2111"> </a>
<a name="ln2112">//---------------------------------------------------------</a>
<a name="ln2113">//   setElement</a>
<a name="ln2114">//---------------------------------------------------------</a>
<a name="ln2115"> </a>
<a name="ln2116">void VoltaView::setElement(Element* e)</a>
<a name="ln2117">      {</a>
<a name="ln2118">      Volta* volta = (Volta*)e;</a>
<a name="ln2119">      ShowElementBase::setElement(e);</a>
<a name="ln2120"> </a>
<a name="ln2121">      tlb.lineWidth-&gt;setValue(volta-&gt;lineWidth());</a>
<a name="ln2122">//      lb.anchor-&gt;setCurrentIndex(int(volta-&gt;anchor()));</a>
<a name="ln2123">      lb.diagonal-&gt;setChecked(volta-&gt;diagonal());</a>
<a name="ln2124">//      lb.leftElement-&gt;setText(QString(&quot;%1&quot;).arg((unsigned long)volta-&gt;startElement(), 8, 16));</a>
<a name="ln2125">//      lb.rightElement-&gt;setText(QString(&quot;%1&quot;).arg((unsigned long)volta-&gt;endElement(), 8, 16));</a>
<a name="ln2126"> </a>
<a name="ln2127">      sp.segments-&gt;clear();</a>
<a name="ln2128">      const std::vector&lt;SpannerSegment*&gt;&amp; ele = volta-&gt;spannerSegments();</a>
<a name="ln2129">      for (const SpannerSegment* elm : ele) {</a>
<a name="ln2130">            QTreeWidgetItem* item = new QTreeWidgetItem;</a>
<a name="ln2131">            item-&gt;setText(0, QString(&quot;%1&quot;).arg((quintptr)elm, 8, 16));</a>
<a name="ln2132">            item-&gt;setData(0, Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)elm));</a>
<a name="ln2133">            sp.segments-&gt;addTopLevelItem(item);</a>
<a name="ln2134">            }</a>
<a name="ln2135"> </a>
<a name="ln2136">      sp.tickZ-&gt;setValue(volta-&gt;tick().numerator());</a>
<a name="ln2137">      sp.tickN-&gt;setValue(volta-&gt;tick().denominator());</a>
<a name="ln2138">      sp.ticks-&gt;setValue(volta-&gt;ticks().ticks());</a>
<a name="ln2139">      sp.track2-&gt;setValue(volta-&gt;track2());</a>
<a name="ln2140">      sp.startElement-&gt;setEnabled(volta-&gt;startElement() != 0);</a>
<a name="ln2141">      sp.endElement-&gt;setEnabled(volta-&gt;endElement() != 0);</a>
<a name="ln2142">      sp.anchor-&gt;setCurrentIndex(int(volta-&gt;anchor()));</a>
<a name="ln2143"> </a>
<a name="ln2144">//TODO      tlb.beginText-&gt;setEnabled(volta-&gt;beginTextElement());</a>
<a name="ln2145">//      tlb.continueText-&gt;setEnabled(volta-&gt;continueTextElement());</a>
<a name="ln2146">//      tlb.endText-&gt;setEnabled(volta-&gt;endTextElement());</a>
<a name="ln2147">      }</a>
<a name="ln2148"> </a>
<a name="ln2149">//---------------------------------------------------------</a>
<a name="ln2150">//   startClicked</a>
<a name="ln2151">//---------------------------------------------------------</a>
<a name="ln2152"> </a>
<a name="ln2153">void VoltaView::startClicked()</a>
<a name="ln2154">      {</a>
<a name="ln2155">      emit elementChanged(static_cast&lt;Spanner*&gt;(element())-&gt;startElement());</a>
<a name="ln2156">      }</a>
<a name="ln2157"> </a>
<a name="ln2158">//---------------------------------------------------------</a>
<a name="ln2159">//   endClicked</a>
<a name="ln2160">//---------------------------------------------------------</a>
<a name="ln2161"> </a>
<a name="ln2162">void VoltaView::endClicked()</a>
<a name="ln2163">      {</a>
<a name="ln2164">      emit elementChanged(static_cast&lt;Spanner*&gt;(element())-&gt;endElement());</a>
<a name="ln2165">      }</a>
<a name="ln2166"> </a>
<a name="ln2167">//---------------------------------------------------------</a>
<a name="ln2168">//   VoltaSegmentView</a>
<a name="ln2169">//---------------------------------------------------------</a>
<a name="ln2170"> </a>
<a name="ln2171">VoltaSegmentView::VoltaSegmentView()</a>
<a name="ln2172">   : ShowElementBase()</a>
<a name="ln2173">      {</a>
<a name="ln2174">      lb.setupUi(addWidget());</a>
<a name="ln2175">      connect(lb.lineButton, SIGNAL(clicked()), SLOT(lineClicked()));</a>
<a name="ln2176">      }</a>
<a name="ln2177"> </a>
<a name="ln2178">//---------------------------------------------------------</a>
<a name="ln2179">//   endClicked</a>
<a name="ln2180">//---------------------------------------------------------</a>
<a name="ln2181"> </a>
<a name="ln2182">void VoltaSegmentView::lineClicked()</a>
<a name="ln2183">      {</a>
<a name="ln2184">      emit elementChanged(static_cast&lt;VoltaSegment*&gt;(element())-&gt;volta());</a>
<a name="ln2185">      }</a>
<a name="ln2186"> </a>
<a name="ln2187">//---------------------------------------------------------</a>
<a name="ln2188">//   setElement</a>
<a name="ln2189">//---------------------------------------------------------</a>
<a name="ln2190"> </a>
<a name="ln2191">void VoltaSegmentView::setElement(Element* e)</a>
<a name="ln2192">      {</a>
<a name="ln2193">      VoltaSegment* vs = (VoltaSegment*)e;</a>
<a name="ln2194">      ShowElementBase::setElement(e);</a>
<a name="ln2195"> </a>
<a name="ln2196">      lb.segmentType-&gt;setCurrentIndex(int(vs-&gt;spannerSegmentType()));</a>
<a name="ln2197">      lb.pos2x-&gt;setValue(vs-&gt;pos2().x());</a>
<a name="ln2198">      lb.pos2y-&gt;setValue(vs-&gt;pos2().y());</a>
<a name="ln2199">      lb.offset2x-&gt;setValue(vs-&gt;userOff2().x());</a>
<a name="ln2200">      lb.offset2y-&gt;setValue(vs-&gt;userOff2().y());</a>
<a name="ln2201">      }</a>
<a name="ln2202"> </a>
<a name="ln2203">//---------------------------------------------------------</a>
<a name="ln2204">//   LineSegmentView</a>
<a name="ln2205">//---------------------------------------------------------</a>
<a name="ln2206"> </a>
<a name="ln2207">LineSegmentView::LineSegmentView()</a>
<a name="ln2208">   : ShowElementBase()</a>
<a name="ln2209">      {</a>
<a name="ln2210">      lb.setupUi(addWidget());</a>
<a name="ln2211">      connect(lb.lineButton, SIGNAL(clicked()), SLOT(lineClicked()));</a>
<a name="ln2212">      }</a>
<a name="ln2213"> </a>
<a name="ln2214">//---------------------------------------------------------</a>
<a name="ln2215">//   lineClicked</a>
<a name="ln2216">//---------------------------------------------------------</a>
<a name="ln2217"> </a>
<a name="ln2218">void LineSegmentView::lineClicked()</a>
<a name="ln2219">      {</a>
<a name="ln2220">      emit elementChanged(((LineSegment*)element())-&gt;spanner());</a>
<a name="ln2221">      }</a>
<a name="ln2222"> </a>
<a name="ln2223">//---------------------------------------------------------</a>
<a name="ln2224">//   setElement</a>
<a name="ln2225">//---------------------------------------------------------</a>
<a name="ln2226"> </a>
<a name="ln2227">void LineSegmentView::setElement(Element* e)</a>
<a name="ln2228">      {</a>
<a name="ln2229">      LineSegment* vs = (LineSegment*)e;</a>
<a name="ln2230">      ShowElementBase::setElement(e);</a>
<a name="ln2231"> </a>
<a name="ln2232">      lb.segmentType-&gt;setCurrentIndex(int(vs-&gt;spannerSegmentType()));</a>
<a name="ln2233">      lb.pos2x-&gt;setValue(vs-&gt;pos2().x());</a>
<a name="ln2234">      lb.pos2y-&gt;setValue(vs-&gt;pos2().y());</a>
<a name="ln2235">      lb.offset2x-&gt;setValue(vs-&gt;userOff2().x());</a>
<a name="ln2236">      lb.offset2y-&gt;setValue(vs-&gt;userOff2().y());</a>
<a name="ln2237">      }</a>
<a name="ln2238"> </a>
<a name="ln2239">//---------------------------------------------------------</a>
<a name="ln2240">//   LyricsView</a>
<a name="ln2241">//---------------------------------------------------------</a>
<a name="ln2242"> </a>
<a name="ln2243">LyricsView::LyricsView()</a>
<a name="ln2244">   : ShowElementBase()</a>
<a name="ln2245">      {</a>
<a name="ln2246">      lb.setupUi(addWidget());</a>
<a name="ln2247">      }</a>
<a name="ln2248"> </a>
<a name="ln2249">//---------------------------------------------------------</a>
<a name="ln2250">//   setElement</a>
<a name="ln2251">//---------------------------------------------------------</a>
<a name="ln2252"> </a>
<a name="ln2253">void LyricsView::setElement(Element* e)</a>
<a name="ln2254">      {</a>
<a name="ln2255">      Lyrics* l = (Lyrics*)e;</a>
<a name="ln2256">      ShowElementBase::setElement(e);</a>
<a name="ln2257"> </a>
<a name="ln2258">      lb.row-&gt;setValue(l-&gt;no());</a>
<a name="ln2259">      lb.endTick-&gt;setValue(l-&gt;endTick().ticks());</a>
<a name="ln2260">      lb.syllabic-&gt;setCurrentIndex(int(l-&gt;syllabic()));</a>
<a name="ln2261">      }</a>
<a name="ln2262"> </a>
<a name="ln2263">//---------------------------------------------------------</a>
<a name="ln2264">//   backClicked</a>
<a name="ln2265">//---------------------------------------------------------</a>
<a name="ln2266"> </a>
<a name="ln2267">void Debugger::backClicked()</a>
<a name="ln2268">      {</a>
<a name="ln2269">      if (backStack.isEmpty())</a>
<a name="ln2270">            return;</a>
<a name="ln2271">      forwardStack.push(curElement);</a>
<a name="ln2272">      forward-&gt;setEnabled(true);</a>
<a name="ln2273">      updateElement(backStack.pop());</a>
<a name="ln2274">      back-&gt;setEnabled(!backStack.isEmpty());</a>
<a name="ln2275">      }</a>
<a name="ln2276"> </a>
<a name="ln2277">//---------------------------------------------------------</a>
<a name="ln2278">//   forwardClicked</a>
<a name="ln2279">//---------------------------------------------------------</a>
<a name="ln2280"> </a>
<a name="ln2281">void Debugger::forwardClicked()</a>
<a name="ln2282">      {</a>
<a name="ln2283">      if (forwardStack.isEmpty())</a>
<a name="ln2284">            return;</a>
<a name="ln2285">      backStack.push(curElement);</a>
<a name="ln2286">      back-&gt;setEnabled(true);</a>
<a name="ln2287">      updateElement(forwardStack.pop());</a>
<a name="ln2288">      forward-&gt;setEnabled(!forwardStack.isEmpty());</a>
<a name="ln2289">      }</a>
<a name="ln2290"> </a>
<a name="ln2291">//---------------------------------------------------------</a>
<a name="ln2292">//   reloadClicked</a>
<a name="ln2293">//---------------------------------------------------------</a>
<a name="ln2294"> </a>
<a name="ln2295">void Debugger::reloadClicked()</a>
<a name="ln2296">      {</a>
<a name="ln2297">      Element* e = curElement;</a>
<a name="ln2298">      updateList(cs);</a>
<a name="ln2299">      if (e)</a>
<a name="ln2300">            updateElement(e);</a>
<a name="ln2301">      }</a>
<a name="ln2302"> </a>
<a name="ln2303">//---------------------------------------------------------</a>
<a name="ln2304">//   BeamView</a>
<a name="ln2305">//---------------------------------------------------------</a>
<a name="ln2306"> </a>
<a name="ln2307">BeamView::BeamView()</a>
<a name="ln2308">   : ShowElementBase()</a>
<a name="ln2309">      {</a>
<a name="ln2310">      bb.setupUi(addWidget());</a>
<a name="ln2311">      connect(bb.elements, SIGNAL(itemClicked(QTreeWidgetItem*,int)), SLOT(elementClicked(QTreeWidgetItem*)));</a>
<a name="ln2312">      }</a>
<a name="ln2313"> </a>
<a name="ln2314">//---------------------------------------------------------</a>
<a name="ln2315">//   setElement</a>
<a name="ln2316">//---------------------------------------------------------</a>
<a name="ln2317"> </a>
<a name="ln2318">void BeamView::setElement(Element* e)</a>
<a name="ln2319">      {</a>
<a name="ln2320">      Beam* b = (Beam*)e;</a>
<a name="ln2321">      ShowElementBase::setElement(e);</a>
<a name="ln2322"> </a>
<a name="ln2323">      bb.up-&gt;setValue(b-&gt;up());</a>
<a name="ln2324">      bb.elements-&gt;clear();</a>
<a name="ln2325">      foreach (ChordRest* cr, b-&gt;elements()) {</a>
<a name="ln2326">            QTreeWidgetItem* item = new QTreeWidgetItem;</a>
<a name="ln2327">            item-&gt;setText(0, QString(&quot;%1&quot;).arg((quintptr)cr, 8, 16));</a>
<a name="ln2328">            item-&gt;setData(0, Qt::UserRole, QVariant::fromValue&lt;void*&gt;((void*)cr));</a>
<a name="ln2329">            item-&gt;setText(1, cr-&gt;name());</a>
<a name="ln2330">            item-&gt;setText(2, QString(&quot;%1&quot;).arg(cr-&gt;segment()-&gt;tick().print()));</a>
<a name="ln2331">            bb.elements-&gt;addTopLevelItem(item);</a>
<a name="ln2332">            }</a>
<a name="ln2333">      bb.grow1-&gt;setValue(b-&gt;growLeft());</a>
<a name="ln2334">      bb.grow2-&gt;setValue(b-&gt;growRight());</a>
<a name="ln2335">      bb.cross-&gt;setChecked(b-&gt;cross());</a>
<a name="ln2336">      bb.isGrace-&gt;setChecked(b-&gt;isGrace());</a>
<a name="ln2337">      }</a>
<a name="ln2338"> </a>
<a name="ln2339">//---------------------------------------------------------</a>
<a name="ln2340">//   elementClicked</a>
<a name="ln2341">//---------------------------------------------------------</a>
<a name="ln2342"> </a>
<a name="ln2343">void BeamView::elementClicked(QTreeWidgetItem* item)</a>
<a name="ln2344">      {</a>
<a name="ln2345">      Element* e = (Element*)item-&gt;data(0, Qt::UserRole).value&lt;void*&gt;();</a>
<a name="ln2346">      emit elementChanged(e);</a>
<a name="ln2347">      }</a>
<a name="ln2348"> </a>
<a name="ln2349">//---------------------------------------------------------</a>
<a name="ln2350">//   TremoloView</a>
<a name="ln2351">//---------------------------------------------------------</a>
<a name="ln2352"> </a>
<a name="ln2353">TremoloView::TremoloView()</a>
<a name="ln2354">   : ShowElementBase()</a>
<a name="ln2355">      {</a>
<a name="ln2356">      tb.setupUi(addWidget());</a>
<a name="ln2357">      connect(tb.firstChord, SIGNAL(clicked()), SLOT(chord1Clicked()));</a>
<a name="ln2358">      connect(tb.secondChord, SIGNAL(clicked()), SLOT(chord2Clicked()));</a>
<a name="ln2359">      }</a>
<a name="ln2360"> </a>
<a name="ln2361">//---------------------------------------------------------</a>
<a name="ln2362">//   setElement</a>
<a name="ln2363">//---------------------------------------------------------</a>
<a name="ln2364"> </a>
<a name="ln2365">void TremoloView::setElement(Element* e)</a>
<a name="ln2366">      {</a>
<a name="ln2367">      Tremolo* b = static_cast&lt;Tremolo*&gt;(e);</a>
<a name="ln2368">      ShowElementBase::setElement(e);</a>
<a name="ln2369"> </a>
<a name="ln2370">      tb.firstChord-&gt;setEnabled(b-&gt;chord1());</a>
<a name="ln2371">      tb.secondChord-&gt;setEnabled(b-&gt;chord2());</a>
<a name="ln2372">      }</a>
<a name="ln2373"> </a>
<a name="ln2374">//---------------------------------------------------------</a>
<a name="ln2375">//   chord1Clicked</a>
<a name="ln2376">//---------------------------------------------------------</a>
<a name="ln2377"> </a>
<a name="ln2378">void TremoloView::chord1Clicked()</a>
<a name="ln2379">      {</a>
<a name="ln2380">      emit elementChanged(static_cast&lt;Tremolo*&gt;(element())-&gt;chord1());</a>
<a name="ln2381">      }</a>
<a name="ln2382"> </a>
<a name="ln2383">//---------------------------------------------------------</a>
<a name="ln2384">//   chord2Clicked</a>
<a name="ln2385">//---------------------------------------------------------</a>
<a name="ln2386"> </a>
<a name="ln2387">void TremoloView::chord2Clicked()</a>
<a name="ln2388">      {</a>
<a name="ln2389">      emit elementChanged(static_cast&lt;Tremolo*&gt;(element())-&gt;chord2());</a>
<a name="ln2390">      }</a>
<a name="ln2391"> </a>
<a name="ln2392">//---------------------------------------------------------</a>
<a name="ln2393">//   OttavaView</a>
<a name="ln2394">//---------------------------------------------------------</a>
<a name="ln2395"> </a>
<a name="ln2396">OttavaView::OttavaView()</a>
<a name="ln2397">   : TextLineView()</a>
<a name="ln2398">      {</a>
<a name="ln2399">//      ob.setupUi(addWidget());</a>
<a name="ln2400">      }</a>
<a name="ln2401"> </a>
<a name="ln2402">//---------------------------------------------------------</a>
<a name="ln2403">//   setElement</a>
<a name="ln2404">//---------------------------------------------------------</a>
<a name="ln2405"> </a>
<a name="ln2406">void OttavaView::setElement(Element* e)</a>
<a name="ln2407">      {</a>
<a name="ln2408">//      Ottava* o = static_cast&lt;Ottava*&gt;(e);</a>
<a name="ln2409">      TextLineView::setElement(e);</a>
<a name="ln2410">      }</a>
<a name="ln2411"> </a>
<a name="ln2412">//---------------------------------------------------------</a>
<a name="ln2413">//   TieSegmentView</a>
<a name="ln2414">//---------------------------------------------------------</a>
<a name="ln2415"> </a>
<a name="ln2416">TieSegmentView::TieSegmentView()</a>
<a name="ln2417">   : ShowElementBase()</a>
<a name="ln2418">      {</a>
<a name="ln2419">      ss.setupUi(addWidget());</a>
<a name="ln2420">      connect(ss.slurTie, SIGNAL(clicked()), SLOT(slurTieClicked()));</a>
<a name="ln2421">      }</a>
<a name="ln2422"> </a>
<a name="ln2423">//---------------------------------------------------------</a>
<a name="ln2424">//   stemClicked</a>
<a name="ln2425">//---------------------------------------------------------</a>
<a name="ln2426"> </a>
<a name="ln2427">void TieSegmentView::slurTieClicked()</a>
<a name="ln2428">      {</a>
<a name="ln2429">      emit elementChanged(toTieSegment(element())-&gt;slurTie());</a>
<a name="ln2430">      }</a>
<a name="ln2431"> </a>
<a name="ln2432">//---------------------------------------------------------</a>
<a name="ln2433">//   TieSegmentView</a>
<a name="ln2434">//---------------------------------------------------------</a>
<a name="ln2435"> </a>
<a name="ln2436">void TieSegmentView::setElement(Element* e)</a>
<a name="ln2437">      {</a>
<a name="ln2438">      TieSegment* s = toTieSegment(e);</a>
<a name="ln2439">      ShowElementBase::setElement(e);</a>
<a name="ln2440">      ss.up1px-&gt;setValue(s-&gt;ups(Grip::START).p.x());</a>
<a name="ln2441">      ss.up1py-&gt;setValue(s-&gt;ups(Grip::START).p.y());</a>
<a name="ln2442">      ss.up1ox-&gt;setValue(s-&gt;ups(Grip::START).off.x());</a>
<a name="ln2443">      ss.up1oy-&gt;setValue(s-&gt;ups(Grip::START).off.y());</a>
<a name="ln2444"> </a>
<a name="ln2445">      ss.up2px-&gt;setValue(s-&gt;ups(Grip::BEZIER1).p.x());</a>
<a name="ln2446">      ss.up2py-&gt;setValue(s-&gt;ups(Grip::BEZIER1).p.y());</a>
<a name="ln2447">      ss.up2ox-&gt;setValue(s-&gt;ups(Grip::BEZIER1).off.x());</a>
<a name="ln2448">      ss.up2oy-&gt;setValue(s-&gt;ups(Grip::BEZIER1).off.y());</a>
<a name="ln2449"> </a>
<a name="ln2450">      ss.up3px-&gt;setValue(s-&gt;ups(Grip::BEZIER2).p.x());</a>
<a name="ln2451">      ss.up3py-&gt;setValue(s-&gt;ups(Grip::BEZIER2).p.y());</a>
<a name="ln2452">      ss.up3ox-&gt;setValue(s-&gt;ups(Grip::BEZIER2).off.x());</a>
<a name="ln2453">      ss.up3oy-&gt;setValue(s-&gt;ups(Grip::BEZIER2).off.y());</a>
<a name="ln2454"> </a>
<a name="ln2455">      ss.up4px-&gt;setValue(s-&gt;ups(Grip::END).p.x());</a>
<a name="ln2456">      ss.up4py-&gt;setValue(s-&gt;ups(Grip::END).p.y());</a>
<a name="ln2457">      ss.up4ox-&gt;setValue(s-&gt;ups(Grip::END).off.x());</a>
<a name="ln2458">      ss.up4oy-&gt;setValue(s-&gt;ups(Grip::END).off.y());</a>
<a name="ln2459">      }</a>
<a name="ln2460"> </a>
<a name="ln2461">//---------------------------------------------------------</a>
<a name="ln2462">//   SlurSegmentView</a>
<a name="ln2463">//---------------------------------------------------------</a>
<a name="ln2464"> </a>
<a name="ln2465">SlurSegmentView::SlurSegmentView()</a>
<a name="ln2466">   : ShowElementBase()</a>
<a name="ln2467">      {</a>
<a name="ln2468">      ss.setupUi(addWidget());</a>
<a name="ln2469">      connect(ss.slurTie, SIGNAL(clicked()), SLOT(slurTieClicked()));</a>
<a name="ln2470">      }</a>
<a name="ln2471"> </a>
<a name="ln2472">//---------------------------------------------------------</a>
<a name="ln2473">//   stemClicked</a>
<a name="ln2474">//---------------------------------------------------------</a>
<a name="ln2475"> </a>
<a name="ln2476">void SlurSegmentView::slurTieClicked()</a>
<a name="ln2477">      {</a>
<a name="ln2478">      emit elementChanged(static_cast&lt;SlurSegment*&gt;(element())-&gt;slurTie());</a>
<a name="ln2479">      }</a>
<a name="ln2480"> </a>
<a name="ln2481">//---------------------------------------------------------</a>
<a name="ln2482">//   SlurSegmentView</a>
<a name="ln2483">//---------------------------------------------------------</a>
<a name="ln2484"> </a>
<a name="ln2485">void SlurSegmentView::setElement(Element* e)</a>
<a name="ln2486">      {</a>
<a name="ln2487">      SlurSegment* s = static_cast&lt;SlurSegment*&gt;(e);</a>
<a name="ln2488">      ShowElementBase::setElement(e);</a>
<a name="ln2489">      ss.up1px-&gt;setValue(s-&gt;ups(Grip::START).p.x());</a>
<a name="ln2490">      ss.up1py-&gt;setValue(s-&gt;ups(Grip::START).p.y());</a>
<a name="ln2491">      ss.up1ox-&gt;setValue(s-&gt;ups(Grip::START).off.x());</a>
<a name="ln2492">      ss.up1oy-&gt;setValue(s-&gt;ups(Grip::START).off.y());</a>
<a name="ln2493"> </a>
<a name="ln2494">      ss.up2px-&gt;setValue(s-&gt;ups(Grip::BEZIER1).p.x());</a>
<a name="ln2495">      ss.up2py-&gt;setValue(s-&gt;ups(Grip::BEZIER1).p.y());</a>
<a name="ln2496">      ss.up2ox-&gt;setValue(s-&gt;ups(Grip::BEZIER1).off.x());</a>
<a name="ln2497">      ss.up2oy-&gt;setValue(s-&gt;ups(Grip::BEZIER1).off.y());</a>
<a name="ln2498"> </a>
<a name="ln2499">      ss.up3px-&gt;setValue(s-&gt;ups(Grip::BEZIER2).p.x());</a>
<a name="ln2500">      ss.up3py-&gt;setValue(s-&gt;ups(Grip::BEZIER2).p.y());</a>
<a name="ln2501">      ss.up3ox-&gt;setValue(s-&gt;ups(Grip::BEZIER2).off.x());</a>
<a name="ln2502">      ss.up3oy-&gt;setValue(s-&gt;ups(Grip::BEZIER2).off.y());</a>
<a name="ln2503"> </a>
<a name="ln2504">      ss.up4px-&gt;setValue(s-&gt;ups(Grip::END).p.x());</a>
<a name="ln2505">      ss.up4py-&gt;setValue(s-&gt;ups(Grip::END).p.y());</a>
<a name="ln2506">      ss.up4ox-&gt;setValue(s-&gt;ups(Grip::END).off.x());</a>
<a name="ln2507">      ss.up4oy-&gt;setValue(s-&gt;ups(Grip::END).off.y());</a>
<a name="ln2508"> </a>
<a name="ln2509">      }</a>
<a name="ln2510"> </a>
<a name="ln2511">//---------------------------------------------------------</a>
<a name="ln2512">//   AccidentalView</a>
<a name="ln2513">//---------------------------------------------------------</a>
<a name="ln2514"> </a>
<a name="ln2515">AccidentalView::AccidentalView()</a>
<a name="ln2516">   : ShowElementBase()</a>
<a name="ln2517">      {</a>
<a name="ln2518">      acc.setupUi(addWidget());</a>
<a name="ln2519">      }</a>
<a name="ln2520"> </a>
<a name="ln2521">//---------------------------------------------------------</a>
<a name="ln2522">//   AccidentalView</a>
<a name="ln2523">//---------------------------------------------------------</a>
<a name="ln2524"> </a>
<a name="ln2525">void AccidentalView::setElement(Element* e)</a>
<a name="ln2526">      {</a>
<a name="ln2527">      Accidental* s = static_cast&lt;Accidental*&gt;(e);</a>
<a name="ln2528">      ShowElementBase::setElement(e);</a>
<a name="ln2529"> </a>
<a name="ln2530">//TODO      acc.hasBracket-&gt;setChecked(s-&gt;hasBracket());</a>
<a name="ln2531">      acc.accAuto-&gt;setChecked(s-&gt;role() == AccidentalRole::AUTO);</a>
<a name="ln2532">      acc.accUser-&gt;setChecked(s-&gt;role() == AccidentalRole::USER);</a>
<a name="ln2533">      acc.small-&gt;setChecked(s-&gt;small());</a>
<a name="ln2534">      }</a>
<a name="ln2535"> </a>
<a name="ln2536">//---------------------------------------------------------</a>
<a name="ln2537">//   ClefView</a>
<a name="ln2538">//---------------------------------------------------------</a>
<a name="ln2539"> </a>
<a name="ln2540">ClefView::ClefView()</a>
<a name="ln2541">   : ShowElementBase()</a>
<a name="ln2542">      {</a>
<a name="ln2543">      clef.setupUi(addWidget());</a>
<a name="ln2544">      }</a>
<a name="ln2545"> </a>
<a name="ln2546">//---------------------------------------------------------</a>
<a name="ln2547">//   setElement</a>
<a name="ln2548">//---------------------------------------------------------</a>
<a name="ln2549"> </a>
<a name="ln2550">void ClefView::setElement(Element* e)</a>
<a name="ln2551">      {</a>
<a name="ln2552">      Clef* c = static_cast&lt;Clef*&gt;(e);</a>
<a name="ln2553">      ShowElementBase::setElement(e);</a>
<a name="ln2554"> </a>
<a name="ln2555">      clef.clefType-&gt;setValue(int(c-&gt;clefType()));</a>
<a name="ln2556">      clef.showCourtesy-&gt;setChecked(c-&gt;showCourtesy());</a>
<a name="ln2557">      clef.small-&gt;setChecked(c-&gt;small());</a>
<a name="ln2558"> </a>
<a name="ln2559">      clef.concertClef-&gt;setValue(int(c-&gt;concertClef()));</a>
<a name="ln2560">      clef.transposingClef-&gt;setValue(int(c-&gt;transposingClef()));</a>
<a name="ln2561">      }</a>
<a name="ln2562"> </a>
<a name="ln2563">//---------------------------------------------------------</a>
<a name="ln2564">//   ArticulationView</a>
<a name="ln2565">//---------------------------------------------------------</a>
<a name="ln2566"> </a>
<a name="ln2567">ArticulationView::ArticulationView()</a>
<a name="ln2568">   : ShowElementBase()</a>
<a name="ln2569">      {</a>
<a name="ln2570">      articulation.setupUi(addWidget());</a>
<a name="ln2571">      }</a>
<a name="ln2572"> </a>
<a name="ln2573">//---------------------------------------------------------</a>
<a name="ln2574">//   setElement</a>
<a name="ln2575">//---------------------------------------------------------</a>
<a name="ln2576"> </a>
<a name="ln2577">void ArticulationView::setElement(Element* e)</a>
<a name="ln2578">      {</a>
<a name="ln2579">      Articulation* a = static_cast&lt;Articulation*&gt;(e);</a>
<a name="ln2580">      ShowElementBase::setElement(e);</a>
<a name="ln2581"> </a>
<a name="ln2582">      articulation.direction-&gt;setCurrentIndex(int(a-&gt;direction()));</a>
<a name="ln2583">      articulation.up-&gt;setChecked(a-&gt;up());</a>
<a name="ln2584">      articulation.anchor-&gt;setCurrentIndex(int(a-&gt;anchor()));</a>
<a name="ln2585">      articulation.channelName-&gt;setText(a-&gt;channelName());</a>
<a name="ln2586">      articulation.symName-&gt;setText(Sym::id2name(a-&gt;symId()));</a>
<a name="ln2587">      }</a>
<a name="ln2588"> </a>
<a name="ln2589">//---------------------------------------------------------</a>
<a name="ln2590">//   KeySigView</a>
<a name="ln2591">//---------------------------------------------------------</a>
<a name="ln2592"> </a>
<a name="ln2593">KeySigView::KeySigView()</a>
<a name="ln2594">   : ShowElementBase()</a>
<a name="ln2595">      {</a>
<a name="ln2596">      keysig.setupUi(addWidget());</a>
<a name="ln2597">      }</a>
<a name="ln2598"> </a>
<a name="ln2599">//---------------------------------------------------------</a>
<a name="ln2600">//   setElement</a>
<a name="ln2601">//---------------------------------------------------------</a>
<a name="ln2602"> </a>
<a name="ln2603">void KeySigView::setElement(Element* e)</a>
<a name="ln2604">      {</a>
<a name="ln2605">      KeySig* ks = static_cast&lt;KeySig*&gt;(e);</a>
<a name="ln2606">      ShowElementBase::setElement(e);</a>
<a name="ln2607"> </a>
<a name="ln2608">      KeySigEvent ev = ks-&gt;keySigEvent();</a>
<a name="ln2609">      keysig.showCourtesySig-&gt;setChecked(ks-&gt;showCourtesy());</a>
<a name="ln2610">      keysig.accidentalType-&gt;setValue(int(ev.key()));</a>
<a name="ln2611">      keysig.custom-&gt;setChecked(ev.custom());</a>
<a name="ln2612">      keysig.atonal-&gt;setChecked(ev.isAtonal());</a>
<a name="ln2613">      keysig.invalid-&gt;setChecked(!ev.isValid());</a>
<a name="ln2614">      }</a>
<a name="ln2615"> </a>
<a name="ln2616">//---------------------------------------------------------</a>
<a name="ln2617">//   StemView</a>
<a name="ln2618">//---------------------------------------------------------</a>
<a name="ln2619"> </a>
<a name="ln2620">StemView::StemView()</a>
<a name="ln2621">   : ShowElementBase()</a>
<a name="ln2622">      {</a>
<a name="ln2623">      stem.setupUi(addWidget());</a>
<a name="ln2624">      }</a>
<a name="ln2625"> </a>
<a name="ln2626">//---------------------------------------------------------</a>
<a name="ln2627">//   setElement</a>
<a name="ln2628">//---------------------------------------------------------</a>
<a name="ln2629"> </a>
<a name="ln2630">void StemView::setElement(Element* e)</a>
<a name="ln2631">      {</a>
<a name="ln2632">      Stem* s = static_cast&lt;Stem*&gt;(e);</a>
<a name="ln2633">      ShowElementBase::setElement(e);</a>
<a name="ln2634"> </a>
<a name="ln2635">      stem.len-&gt;setValue(s-&gt;len());</a>
<a name="ln2636">      stem.userLen-&gt;setValue(s-&gt;userLen());</a>
<a name="ln2637">      }</a>
<a name="ln2638"> </a>
<a name="ln2639">//---------------------------------------------------------</a>
<a name="ln2640">//   BoxView</a>
<a name="ln2641">//---------------------------------------------------------</a>
<a name="ln2642"> </a>
<a name="ln2643">BoxView::BoxView()</a>
<a name="ln2644">   : ShowElementBase()</a>
<a name="ln2645">      {</a>
<a name="ln2646">      box.setupUi(addWidget());</a>
<a name="ln2647">      }</a>
<a name="ln2648"> </a>
<a name="ln2649">//---------------------------------------------------------</a>
<a name="ln2650">//   setElement</a>
<a name="ln2651">//---------------------------------------------------------</a>
<a name="ln2652"> </a>
<a name="ln2653">void BoxView::setElement(Element* e)</a>
<a name="ln2654">      {</a>
<a name="ln2655">      Box* b = static_cast&lt;Box*&gt;(e);</a>
<a name="ln2656">      ShowElementBase::setElement(e);</a>
<a name="ln2657"> </a>
<a name="ln2658">      box.width-&gt;setValue(b-&gt;boxWidth().val());</a>
<a name="ln2659">      box.height-&gt;setValue(b-&gt;boxHeight().val());</a>
<a name="ln2660">      box.topGap-&gt;setValue(b-&gt;topGap());</a>
<a name="ln2661">      box.bottomGap-&gt;setValue(b-&gt;bottomGap());</a>
<a name="ln2662">      box.topMargin-&gt;setValue(b-&gt;topMargin());</a>
<a name="ln2663">      box.bottomMargin-&gt;setValue(b-&gt;bottomMargin());</a>
<a name="ln2664">      box.leftMargin-&gt;setValue(b-&gt;leftMargin());</a>
<a name="ln2665">      box.rightMargin-&gt;setValue(b-&gt;rightMargin());</a>
<a name="ln2666">      }</a>
<a name="ln2667"> </a>
<a name="ln2668">//---------------------------------------------------------</a>
<a name="ln2669">//   TextLineView</a>
<a name="ln2670">//---------------------------------------------------------</a>
<a name="ln2671"> </a>
<a name="ln2672">TextLineView::TextLineView()</a>
<a name="ln2673">   : SpannerView()</a>
<a name="ln2674">      {</a>
<a name="ln2675">      // SLineBase</a>
<a name="ln2676">      lb.setupUi(addWidget());</a>
<a name="ln2677"> </a>
<a name="ln2678">      // TextLineBase</a>
<a name="ln2679">      tlb.setupUi(addWidget());</a>
<a name="ln2680"> </a>
<a name="ln2681">      connect(tlb.beginText,    SIGNAL(clicked()), SLOT(beginTextClicked()));</a>
<a name="ln2682">      connect(tlb.continueText, SIGNAL(clicked()), SLOT(continueTextClicked()));</a>
<a name="ln2683">      }</a>
<a name="ln2684"> </a>
<a name="ln2685">//---------------------------------------------------------</a>
<a name="ln2686">//   setElement</a>
<a name="ln2687">//---------------------------------------------------------</a>
<a name="ln2688"> </a>
<a name="ln2689">void TextLineView::setElement(Element* e)</a>
<a name="ln2690">      {</a>
<a name="ln2691">      Volta* volta = (Volta*)e;</a>
<a name="ln2692">      SpannerView::setElement(e);</a>
<a name="ln2693"> </a>
<a name="ln2694">      tlb.lineWidth-&gt;setValue(volta-&gt;lineWidth());</a>
<a name="ln2695">      lb.diagonal-&gt;setChecked(volta-&gt;diagonal());</a>
<a name="ln2696"> </a>
<a name="ln2697">//      tlb.beginText-&gt;setEnabled(volta-&gt;beginTextElement());</a>
<a name="ln2698">//      tlb.continueText-&gt;setEnabled(volta-&gt;continueTextElement());</a>
<a name="ln2699">//      tlb.endText-&gt;setEnabled(volta-&gt;endTextElement());</a>
<a name="ln2700">      }</a>
<a name="ln2701"> </a>
<a name="ln2702">//---------------------------------------------------------</a>
<a name="ln2703">//   beginTextClicked</a>
<a name="ln2704">//---------------------------------------------------------</a>
<a name="ln2705"> </a>
<a name="ln2706">void TextLineView::beginTextClicked()</a>
<a name="ln2707">      {</a>
<a name="ln2708">//      Volta* volta = (Volta*)element();</a>
<a name="ln2709">//      emit elementChanged(volta-&gt;beginTextElement());</a>
<a name="ln2710">      }</a>
<a name="ln2711"> </a>
<a name="ln2712">//---------------------------------------------------------</a>
<a name="ln2713">//   continueTextClicked</a>
<a name="ln2714">//---------------------------------------------------------</a>
<a name="ln2715"> </a>
<a name="ln2716">void TextLineView::continueTextClicked()</a>
<a name="ln2717">      {</a>
<a name="ln2718">//      Volta* volta = (Volta*)element();</a>
<a name="ln2719">//      emit elementChanged(volta-&gt;continueTextElement());</a>
<a name="ln2720">      }</a>
<a name="ln2721"> </a>
<a name="ln2722">//---------------------------------------------------------</a>
<a name="ln2723">//   endTextClicked</a>
<a name="ln2724">//---------------------------------------------------------</a>
<a name="ln2725"> </a>
<a name="ln2726">void TextLineView::endTextClicked()</a>
<a name="ln2727">      {</a>
<a name="ln2728">//      Volta* volta = (Volta*)element();</a>
<a name="ln2729">//      emit elementChanged(volta-&gt;endTextElement());</a>
<a name="ln2730">      }</a>
<a name="ln2731"> </a>
<a name="ln2732">//---------------------------------------------------------</a>
<a name="ln2733">//   TextLineSegmentView</a>
<a name="ln2734">//---------------------------------------------------------</a>
<a name="ln2735"> </a>
<a name="ln2736">TextLineSegmentView::TextLineSegmentView()</a>
<a name="ln2737">   : ShowElementBase()</a>
<a name="ln2738">      {</a>
<a name="ln2739">      lb.setupUi(addWidget());</a>
<a name="ln2740">      }</a>
<a name="ln2741"> </a>
<a name="ln2742">//---------------------------------------------------------</a>
<a name="ln2743">//   setElement</a>
<a name="ln2744">//---------------------------------------------------------</a>
<a name="ln2745"> </a>
<a name="ln2746">void TextLineSegmentView::setElement(Element* e)</a>
<a name="ln2747">      {</a>
<a name="ln2748">      VoltaSegment* vs = (VoltaSegment*)e;</a>
<a name="ln2749">      ShowElementBase::setElement(e);</a>
<a name="ln2750"> </a>
<a name="ln2751">      lb.segmentType-&gt;setCurrentIndex(int(vs-&gt;spannerSegmentType()));</a>
<a name="ln2752">      lb.pos2x-&gt;setValue(vs-&gt;pos2().x());</a>
<a name="ln2753">      lb.pos2y-&gt;setValue(vs-&gt;pos2().y());</a>
<a name="ln2754">      lb.offset2x-&gt;setValue(vs-&gt;userOff2().x());</a>
<a name="ln2755">      lb.offset2y-&gt;setValue(vs-&gt;userOff2().y());</a>
<a name="ln2756">      connect(lb.lineButton, SIGNAL(clicked()), SLOT(lineClicked()));</a>
<a name="ln2757">      }</a>
<a name="ln2758"> </a>
<a name="ln2759">//---------------------------------------------------------</a>
<a name="ln2760">//   lineClicked</a>
<a name="ln2761">//---------------------------------------------------------</a>
<a name="ln2762"> </a>
<a name="ln2763">void TextLineSegmentView::lineClicked()</a>
<a name="ln2764">      {</a>
<a name="ln2765">      Spanner* sp = static_cast&lt;SpannerSegment*&gt;(element())-&gt;spanner();</a>
<a name="ln2766">      emit elementChanged(sp);</a>
<a name="ln2767">      }</a>
<a name="ln2768"> </a>
<a name="ln2769">//---------------------------------------------------------</a>
<a name="ln2770">//   SystemView</a>
<a name="ln2771">//---------------------------------------------------------</a>
<a name="ln2772"> </a>
<a name="ln2773">SystemView::SystemView()</a>
<a name="ln2774">   : ShowElementBase()</a>
<a name="ln2775">      {</a>
<a name="ln2776">      mb.setupUi(addWidget());</a>
<a name="ln2777">      connect(mb.spanner, SIGNAL(itemClicked(QTreeWidgetItem*,int)), SLOT(elementClicked(QTreeWidgetItem*)));</a>
<a name="ln2778">      connect(mb.measureList, SIGNAL(itemClicked(QListWidgetItem*)), SLOT(measureClicked(QListWidgetItem*)));</a>
<a name="ln2779">      }</a>
<a name="ln2780"> </a>
<a name="ln2781">//---------------------------------------------------------</a>
<a name="ln2782">//   setElement</a>
<a name="ln2783">//---------------------------------------------------------</a>
<a name="ln2784"> </a>
<a name="ln2785">void SystemView::setElement(Element* e)</a>
<a name="ln2786">      {</a>
<a name="ln2787">      System* vs = (System*)e;</a>
<a name="ln2788">      ShowElementBase::setElement(e);</a>
<a name="ln2789">      mb.spanner-&gt;clear();</a>
<a name="ln2790">      for (const Element* elm : vs-&gt;spannerSegments()) {</a>
<a name="ln2791">            QTreeWidgetItem* item = new QTreeWidgetItem;</a>
<a name="ln2792">            item-&gt;setText(0, elm-&gt;name());</a>
<a name="ln2793">            void* p = (void*) elm;</a>
<a name="ln2794">            item-&gt;setData(0, Qt::UserRole, QVariant::fromValue&lt;void*&gt;(p));</a>
<a name="ln2795">            mb.spanner-&gt;addTopLevelItem(item);</a>
<a name="ln2796">            }</a>
<a name="ln2797">      mb.measureList-&gt;clear();</a>
<a name="ln2798">      for (MeasureBase* m : vs-&gt;measures()) {</a>
<a name="ln2799">            ElementListWidgetItem* item = new ElementListWidgetItem(m);</a>
<a name="ln2800">            mb.measureList-&gt;addItem(item);</a>
<a name="ln2801">            }</a>
<a name="ln2802">      }</a>
<a name="ln2803"> </a>
<a name="ln2804">//---------------------------------------------------------</a>
<a name="ln2805">//   elementClicked</a>
<a name="ln2806">//---------------------------------------------------------</a>
<a name="ln2807"> </a>
<a name="ln2808">void SystemView::elementClicked(QTreeWidgetItem* item)</a>
<a name="ln2809">      {</a>
<a name="ln2810">      Element* e = (Element*)item-&gt;data(0, Qt::UserRole).value&lt;void*&gt;();</a>
<a name="ln2811">      emit elementChanged(e);</a>
<a name="ln2812">      }</a>
<a name="ln2813"> </a>
<a name="ln2814">//---------------------------------------------------------</a>
<a name="ln2815">//   measureClicked</a>
<a name="ln2816">//---------------------------------------------------------</a>
<a name="ln2817"> </a>
<a name="ln2818">void SystemView::measureClicked(QListWidgetItem* i)</a>
<a name="ln2819">      {</a>
<a name="ln2820">      ElementListWidgetItem* item = (ElementListWidgetItem*)i;</a>
<a name="ln2821">      emit elementChanged(item-&gt;element());</a>
<a name="ln2822">      }</a>
<a name="ln2823"> </a>
<a name="ln2824">//---------------------------------------------------------</a>
<a name="ln2825">//   BracketView</a>
<a name="ln2826">//---------------------------------------------------------</a>
<a name="ln2827"> </a>
<a name="ln2828">BracketView::BracketView()</a>
<a name="ln2829">   : ShowElementBase()</a>
<a name="ln2830">      {</a>
<a name="ln2831">      br.setupUi(addWidget());</a>
<a name="ln2832">      }</a>
<a name="ln2833"> </a>
<a name="ln2834">void BracketView::setElement(Element* e)</a>
<a name="ln2835">      {</a>
<a name="ln2836">      ShowElementBase::setElement(e);</a>
<a name="ln2837">      Bracket* b = toBracket(element());</a>
<a name="ln2838"> </a>
<a name="ln2839">      br.braceSymbol-&gt;setValue(int(b-&gt;braceSymbol()));</a>
<a name="ln2840">      br.type-&gt;setValue(int(b-&gt;bracketType()));</a>
<a name="ln2841">      br.firstStaff-&gt;setValue(b-&gt;firstStaff());</a>
<a name="ln2842">      br.lastStaff-&gt;setValue(b-&gt;lastStaff());</a>
<a name="ln2843">      br.column-&gt;setValue(b-&gt;column());</a>
<a name="ln2844">      br.span-&gt;setValue(b-&gt;span());</a>
<a name="ln2845">      br.magx-&gt;setValue(int(b-&gt;magx()));</a>
<a name="ln2846">      }</a>
<a name="ln2847"> </a>
<a name="ln2848">}</a>
<a name="ln2849"> </a>

</code></pre>
<div class="balloon" rel="619"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v618/" target="_blank">V618</a> It's dangerous to call the 'debug' function in such a manner, as the line being passed could contain format specification. The example of the safe code: printf("%s", str);</p></div>
<div class="balloon" rel="8"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
