
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>bagpembell.cpp</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">//=============================================================================</a>
<a name="ln2">//  MuseScore</a>
<a name="ln3">//  Music Composition &amp; Notation</a>
<a name="ln4">//</a>
<a name="ln5">//  Copyright (C) 2013 Werner Schweer</a>
<a name="ln6">//</a>
<a name="ln7">//  This program is free software; you can redistribute it and/or modify</a>
<a name="ln8">//  it under the terms of the GNU General Public License version 2</a>
<a name="ln9">//  as published by the Free Software Foundation and appearing in</a>
<a name="ln10">//  the file LICENCE.GPL</a>
<a name="ln11">//=============================================================================</a>
<a name="ln12"> </a>
<a name="ln13">#include &quot;score.h&quot;</a>
<a name="ln14">#include &quot;xml.h&quot;</a>
<a name="ln15">#include &quot;bagpembell.h&quot;</a>
<a name="ln16">#include &quot;sym.h&quot;</a>
<a name="ln17"> </a>
<a name="ln18">namespace Ms {</a>
<a name="ln19"> </a>
<a name="ln20">// Embellishment names and note sequences</a>
<a name="ln21"> </a>
<a name="ln22">BagpipeEmbellishmentInfo BagpipeEmbellishment::BagpipeEmbellishmentList[] = {</a>
<a name="ln23"> </a>
<a name="ln24">      // Single Grace notes</a>
<a name="ln25">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace low G&quot;), &quot;LG&quot; },</a>
<a name="ln26">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace low A&quot;), &quot;LA&quot; },</a>
<a name="ln27">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace B&quot;), &quot;B&quot; },</a>
<a name="ln28">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace C&quot;), &quot;C&quot; },</a>
<a name="ln29">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace D&quot;), &quot;D&quot; },</a>
<a name="ln30">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace E&quot;), &quot;E&quot; },</a>
<a name="ln31">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace F&quot;), &quot;F&quot; },</a>
<a name="ln32">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace high G&quot;), &quot;HG&quot; },</a>
<a name="ln33">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Single grace high A&quot;), &quot;HA&quot; },</a>
<a name="ln34"> </a>
<a name="ln35">      // Double Grace notes</a>
<a name="ln36">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;D LG&quot; },</a>
<a name="ln37">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;D LA&quot; },</a>
<a name="ln38">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;D B&quot; },</a>
<a name="ln39">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;D C&quot; },</a>
<a name="ln40">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;E LG&quot; },</a>
<a name="ln41">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;E LA&quot; },</a>
<a name="ln42">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;E B&quot; },</a>
<a name="ln43">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;E C&quot; },</a>
<a name="ln44">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;E D&quot; },</a>
<a name="ln45"> </a>
<a name="ln46">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;F LG&quot; },</a>
<a name="ln47">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;F LA&quot; },</a>
<a name="ln48">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;F B&quot; },</a>
<a name="ln49">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;F C&quot; },</a>
<a name="ln50">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;F D&quot; },</a>
<a name="ln51">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;F E&quot; },</a>
<a name="ln52"> </a>
<a name="ln53">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HG LG&quot; },</a>
<a name="ln54">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HG LA&quot; },</a>
<a name="ln55">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HG B&quot; },</a>
<a name="ln56">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HG C&quot; },</a>
<a name="ln57">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HG D&quot; },</a>
<a name="ln58">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HG E&quot; },</a>
<a name="ln59">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HG F&quot; },</a>
<a name="ln60"> </a>
<a name="ln61">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HA LG&quot; },</a>
<a name="ln62">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HA LA&quot; },</a>
<a name="ln63">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HA B&quot; },</a>
<a name="ln64">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HA C&quot; },</a>
<a name="ln65">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HA D&quot; },</a>
<a name="ln66">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HA E&quot; },</a>
<a name="ln67">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HA F&quot; },</a>
<a name="ln68">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double grace&quot;), &quot;HA HG&quot; },</a>
<a name="ln69"> </a>
<a name="ln70">      // Half Doublings</a>
<a name="ln71">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on low G&quot;), &quot;LG D&quot; },</a>
<a name="ln72">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on low A&quot;), &quot;LA D&quot; },</a>
<a name="ln73">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on B&quot;), &quot;B D&quot; },</a>
<a name="ln74">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on C&quot;), &quot;C D&quot; },</a>
<a name="ln75">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on D&quot;), &quot;D E&quot; },</a>
<a name="ln76">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on E&quot;), &quot;E F&quot; },</a>
<a name="ln77">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on F&quot;), &quot;F HG&quot; },</a>
<a name="ln78">      // ? { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on high G&quot;), &quot;HG F&quot; },</a>
<a name="ln79">      // ? { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half doubling on high A&quot;), &quot;HA HG&quot; },</a>
<a name="ln80"> </a>
<a name="ln81">      // Regular Doublings</a>
<a name="ln82">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on high G&quot;), &quot;HG F&quot; },</a>
<a name="ln83">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on high A&quot;), &quot;HA HG&quot; },</a>
<a name="ln84"> </a>
<a name="ln85">      // Half Strikes</a>
<a name="ln86">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half strike on low A&quot;), &quot;LA LG&quot; },</a>
<a name="ln87">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half strike on B&quot;), &quot;B LG&quot; },</a>
<a name="ln88">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half strike on C&quot;), &quot;C LG&quot; },</a>
<a name="ln89">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half strike on D&quot;), &quot;D LG&quot; },</a>
<a name="ln90">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half strike on D&quot;), &quot;D C&quot; },</a>
<a name="ln91">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half strike on E&quot;), &quot;E LA&quot; },</a>
<a name="ln92">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half strike on F&quot;), &quot;F E&quot; },</a>
<a name="ln93">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half strike on high G&quot;), &quot;HG F&quot; },</a>
<a name="ln94"> </a>
<a name="ln95">      // Regular Grip</a>
<a name="ln96">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Grip&quot;), &quot;D LG&quot; },</a>
<a name="ln97"> </a>
<a name="ln98">      // D Throw</a>
<a name="ln99">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half D throw&quot;), &quot;D C&quot; },</a>
<a name="ln100"> </a>
<a name="ln101">      // Regular Doublings (continued)</a>
<a name="ln102">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on low G&quot;),  &quot;HG LG D&quot; },</a>
<a name="ln103">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on low A&quot;),  &quot;HG LA D&quot; },</a>
<a name="ln104">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on B&quot;),      &quot;HG B D&quot; },</a>
<a name="ln105">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on C&quot;),      &quot;HG C D&quot; },</a>
<a name="ln106">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on D&quot;),      &quot;HG D E&quot; },</a>
<a name="ln107">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on E&quot;),      &quot;HG E F&quot; },</a>
<a name="ln108">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Doubling on F&quot;),      &quot;HG F HG&quot; },</a>
<a name="ln109"> </a>
<a name="ln110">      // Thumb Doublings</a>
<a name="ln111">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb doubling on low G&quot;), &quot;HA LG D&quot; },</a>
<a name="ln112">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb doubling on low A&quot;), &quot;HA LA D&quot; },</a>
<a name="ln113">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb doubling on B&quot;), &quot;HA B D&quot; },</a>
<a name="ln114">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb doubling on C&quot;), &quot;HA C D&quot; },</a>
<a name="ln115">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb doubling on D&quot;), &quot;HA D E&quot; },</a>
<a name="ln116">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb doubling on E&quot;), &quot;HA E F&quot; },</a>
<a name="ln117">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb doubling on F&quot;), &quot;HA F HG&quot; },</a>
<a name="ln118">      // ? { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb doubling on high G&quot;), &quot;HA HG F&quot; },</a>
<a name="ln119"> </a>
<a name="ln120">      // G Grace note Strikes</a>
<a name="ln121">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note on low A&quot;), &quot;HG LA LG&quot; },</a>
<a name="ln122">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note on B&quot;), &quot;HG B LG&quot; },</a>
<a name="ln123">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note on C&quot;), &quot;HG C LG&quot; },</a>
<a name="ln124">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note on D&quot;), &quot;HG D LG&quot; },</a>
<a name="ln125">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note on D&quot;), &quot;HG D C&quot; },</a>
<a name="ln126">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note on E&quot;), &quot;HG E LA&quot; },</a>
<a name="ln127">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note on F&quot;), &quot;HG F E&quot; },</a>
<a name="ln128"> </a>
<a name="ln129">      // Regular Double Strikes</a>
<a name="ln130">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on low A&quot;), &quot;LG LA LG&quot; },</a>
<a name="ln131">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on B&quot;), &quot;LG B LG&quot; },</a>
<a name="ln132">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on C&quot;), &quot;LG C LG&quot; },</a>
<a name="ln133">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on D&quot;), &quot;LG D LG&quot; },</a>
<a name="ln134">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on D&quot;), &quot;C D C&quot; },</a>
<a name="ln135">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on E&quot;), &quot;LA E LA&quot; },</a>
<a name="ln136">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on F&quot;), &quot;E F E&quot; },</a>
<a name="ln137">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on high G&quot;), &quot;F HG F&quot; },</a>
<a name="ln138">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Double strike on high A&quot;), &quot;HG HA HG&quot; },</a>
<a name="ln139"> </a>
<a name="ln140">      // Thumb Strikes</a>
<a name="ln141">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb strike on low A&quot;), &quot;HA LA LG&quot; },</a>
<a name="ln142">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb strike on B&quot;), &quot;HA B LG&quot; },</a>
<a name="ln143">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb strike on C&quot;), &quot;HA C LG&quot; },</a>
<a name="ln144">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb strike on D&quot;), &quot;HA D LG&quot; },</a>
<a name="ln145">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb strike on D&quot;), &quot;HA D C&quot; },</a>
<a name="ln146">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb strike on E&quot;), &quot;HA E LA&quot; },</a>
<a name="ln147">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb strike on F&quot;), &quot;HA F E&quot; },</a>
<a name="ln148">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb strike on high G&quot;), &quot;HA HG F&quot; },</a>
<a name="ln149"> </a>
<a name="ln150">      // Regular Grips (continued)</a>
<a name="ln151">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Grip&quot;), &quot;LG D LG&quot; },</a>
<a name="ln152">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Grip&quot;), &quot;LG B LG&quot; },</a>
<a name="ln153"> </a>
<a name="ln154">      // Taorluath and Birl</a>
<a name="ln155">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Birl&quot;), &quot;LG LA LG&quot; },</a>
<a name="ln156">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;D throw&quot;), &quot;LG D C&quot; },</a>
<a name="ln157">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half heavy D throw&quot;), &quot;D LG C&quot; },</a>
<a name="ln158">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Taorluath&quot;), &quot;D LG E&quot; },</a>
<a name="ln159"> </a>
<a name="ln160">      // Birl, Bubbly, D Throws (continued) and Taorluaths (continued)</a>
<a name="ln161">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Birl&quot;), &quot;LA LG LA LG&quot; },</a>
<a name="ln162">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Bubbly&quot;), &quot;D LG C LG&quot; },</a>
<a name="ln163">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Heavy D throw&quot;), &quot;LG D LG C&quot; },</a>
<a name="ln164">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Taorluath&quot;), &quot;LG D LG E&quot; },</a>
<a name="ln165">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Taorluath&quot;), &quot;LG B LG E&quot; },</a>
<a name="ln166"> </a>
<a name="ln167">      // Half Double Strikes</a>
<a name="ln168">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on low A&quot;), &quot;LA LG LA LG&quot; },</a>
<a name="ln169">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on B&quot;), &quot;B LG B LG&quot; },</a>
<a name="ln170">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on C&quot;), &quot;C LG C LG&quot; },</a>
<a name="ln171">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on D&quot;), &quot;D LG D LG&quot; },</a>
<a name="ln172">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on D&quot;), &quot;D C D C&quot; },</a>
<a name="ln173">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on E&quot;), &quot;E LA E LA&quot; },</a>
<a name="ln174">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on F&quot;), &quot;F E F E&quot; },</a>
<a name="ln175">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on high G&quot;), &quot;HG F HG F&quot; },</a>
<a name="ln176">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half double strike on high A&quot;), &quot;HA HG HA HG&quot; },</a>
<a name="ln177"> </a>
<a name="ln178">      // Half Grips</a>
<a name="ln179">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on low A&quot;), &quot;LA LG D LG&quot; },</a>
<a name="ln180">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on B&quot;), &quot;B LG D LG&quot; },</a>
<a name="ln181">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on C&quot;), &quot;C LG D LG&quot; },</a>
<a name="ln182">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on D&quot;), &quot;D LG D LG&quot; },</a>
<a name="ln183">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on D&quot;), &quot;D LG B LG&quot; },</a>
<a name="ln184">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on E&quot;), &quot;E LG D LG&quot; },</a>
<a name="ln185">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on F&quot;), &quot;F LG F LG&quot; },</a>
<a name="ln186">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on high G&quot;), &quot;HG LG D LG&quot; },</a>
<a name="ln187">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half grip on high A&quot;), &quot;HA LG D LG&quot; },</a>
<a name="ln188"> </a>
<a name="ln189">      // Half Peles</a>
<a name="ln190">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half pele on low A&quot;), &quot;LA E LA LG&quot; },</a>
<a name="ln191">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half pele on B&quot;), &quot;B E B LG&quot; },</a>
<a name="ln192">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half pele on C&quot;), &quot;C E C LG&quot; },</a>
<a name="ln193">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half pele on D&quot;), &quot;D E D LG&quot; },</a>
<a name="ln194">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half pele on D&quot;), &quot;D E D C&quot; },</a>
<a name="ln195">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half pele on E&quot;), &quot;E F E LA&quot; },</a>
<a name="ln196">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half pele on F&quot;), &quot;F HG F E&quot; },</a>
<a name="ln197">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half pele on high G&quot;), &quot;HG HA HG F&quot; },</a>
<a name="ln198"> </a>
<a name="ln199">      // G Grace note Grips</a>
<a name="ln200">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note grip on low A&quot;), &quot;HG LA LG D LG&quot; },</a>
<a name="ln201">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note grip on B&quot;), &quot;HG B LG D LG&quot; },</a>
<a name="ln202">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note grip on C&quot;), &quot;HG C LG D LG&quot; },</a>
<a name="ln203">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note grip on D&quot;), &quot;HG D LG D LG&quot; },</a>
<a name="ln204">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note grip on D&quot;), &quot;HG D LG B LG&quot; },</a>
<a name="ln205">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note grip on E&quot;), &quot;HG E LG D LG&quot; },</a>
<a name="ln206">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note grip on F&quot;), &quot;HG F LG F LG&quot; },</a>
<a name="ln207"> </a>
<a name="ln208">      // Thumb Grips</a>
<a name="ln209">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grip on low A&quot;), &quot;HA LA LG D LG&quot; },</a>
<a name="ln210">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grip on B&quot;), &quot;HA B LG D LG&quot; },</a>
<a name="ln211">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grip on C&quot;), &quot;HA C LG D LG&quot; },</a>
<a name="ln212">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grip on D&quot;), &quot;HA D LG D LG&quot; },</a>
<a name="ln213">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grip on D&quot;), &quot;HA D LG B LG&quot; },</a>
<a name="ln214">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grip on E&quot;), &quot;HA E LG D LG&quot; },</a>
<a name="ln215">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grip on F&quot;), &quot;HA F LG F LG&quot; },</a>
<a name="ln216">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grip on high G&quot;), &quot;HA HG LG F LG&quot; },</a>
<a name="ln217"> </a>
<a name="ln218">      // Bubbly</a>
<a name="ln219">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Bubbly&quot;), &quot;LG D LG C LG&quot; },</a>
<a name="ln220"> </a>
<a name="ln221">      //  Birls</a>
<a name="ln222">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Birl&quot;), &quot;HG LA LG LA LG&quot; },</a>
<a name="ln223">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Birl&quot;), &quot;HA LA LG LA LG&quot; },</a>
<a name="ln224"> </a>
<a name="ln225">      // Regular Peles</a>
<a name="ln226">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Pele on low A&quot;), &quot;HG LA E LA LG&quot; },</a>
<a name="ln227">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Pele on B&quot;), &quot;HG B E B LG&quot; },</a>
<a name="ln228">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Pele on C&quot;), &quot;HG C E C LG&quot; },</a>
<a name="ln229">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Pele on D&quot;), &quot;HG D E D LG&quot; },</a>
<a name="ln230">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Pele on D&quot;), &quot;HG D E D C&quot; },</a>
<a name="ln231">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Pele on E&quot;), &quot;HG E F E LA&quot; },</a>
<a name="ln232">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Pele on F&quot;), &quot;HG F HG F E&quot; },</a>
<a name="ln233"> </a>
<a name="ln234">      // Thumb Grace Note Peles</a>
<a name="ln235">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grace note pele on low A&quot;), &quot;HA LA E LA LG&quot; },</a>
<a name="ln236">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grace note pele on B&quot;), &quot;HA B E B LG&quot; },</a>
<a name="ln237">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grace note pele on C&quot;), &quot;HA C E C LG&quot; },</a>
<a name="ln238">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grace note pele on D&quot;), &quot;HA D E D LG&quot; },</a>
<a name="ln239">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grace note pele on D&quot;), &quot;HA D E D C&quot; },</a>
<a name="ln240">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grace note pele on E&quot;), &quot;HA E F E LA&quot; },</a>
<a name="ln241">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grace note pele on F&quot;), &quot;HA F HG F E&quot; },</a>
<a name="ln242">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb grace note pele on high G&quot;), &quot;HA HG HA HG F&quot; },</a>
<a name="ln243"> </a>
<a name="ln244">      // G Grace note Double Strikes</a>
<a name="ln245">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note double strike on low A&quot;), &quot;HG LA LG LA LG&quot; },</a>
<a name="ln246">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note double strike on B&quot;), &quot;HG B LG B LG&quot; },</a>
<a name="ln247">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note double strike on C&quot;), &quot;HG C LG C LG&quot; },</a>
<a name="ln248">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note double strike on D&quot;), &quot;HG D LG D LG&quot; },</a>
<a name="ln249">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note double strike on D&quot;), &quot;HG D C D C&quot; },</a>
<a name="ln250">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note double strike on E&quot;), &quot;HG E LA E LA&quot; },</a>
<a name="ln251">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note double strike on F&quot;), &quot;HG F E F E&quot; },</a>
<a name="ln252"> </a>
<a name="ln253">      // Thumb Double Strikes</a>
<a name="ln254">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb double strike on low A&quot;), &quot;HA LA LG LA LG&quot; },</a>
<a name="ln255">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb double strike on B&quot;), &quot;HA B LG B LG&quot; },</a>
<a name="ln256">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb double strike on C&quot;), &quot;HA C LG C LG&quot; },</a>
<a name="ln257">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb double strike on D&quot;), &quot;HA D LG D LG&quot; },</a>
<a name="ln258">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb double strike on D&quot;), &quot;HA D C D C&quot; },</a>
<a name="ln259">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb double strike on E&quot;), &quot;HA E LA E LA&quot; },</a>
<a name="ln260">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb double strike on F&quot;), &quot;HA F E F E&quot; },</a>
<a name="ln261">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb double strike on high G&quot;), &quot;HA HG F HG F&quot; },</a>
<a name="ln262"> </a>
<a name="ln263">      // Regular Triple Strikes</a>
<a name="ln264">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on low A&quot;), &quot;LG LA LG LA LG&quot; },</a>
<a name="ln265">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on B&quot;), &quot;LG B LG B LG&quot; },</a>
<a name="ln266">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on C&quot;), &quot;LG C LG C LG&quot; },</a>
<a name="ln267">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on D&quot;), &quot;LG D LG D LG&quot; },</a>
<a name="ln268">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on D&quot;), &quot;C D C D C&quot; },</a>
<a name="ln269">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on E&quot;), &quot;LA E LA E LA&quot; },</a>
<a name="ln270">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on F&quot;), &quot;E F E F E&quot; },</a>
<a name="ln271">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on high G&quot;), &quot;F HG F HG F&quot; },</a>
<a name="ln272">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Triple strike on high A&quot;), &quot;HG HA HG HA HG&quot; },</a>
<a name="ln273"> </a>
<a name="ln274">      // Half Triple Strikes</a>
<a name="ln275">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on low A&quot;), &quot;LA LG LA LG LA LG&quot; },</a>
<a name="ln276">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on B&quot;), &quot;B LG B LG B LG&quot; },</a>
<a name="ln277">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on C&quot;), &quot;C LG C LG C LG&quot; },</a>
<a name="ln278">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on D&quot;), &quot;D LG D LG D LG&quot; },</a>
<a name="ln279">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on D&quot;), &quot;D C D C D C&quot; },</a>
<a name="ln280">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on E&quot;), &quot;E LA E LA E LA&quot; },</a>
<a name="ln281">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on F&quot;), &quot;F E F E F E&quot; },</a>
<a name="ln282">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on high G&quot;), &quot;HG F HG F HG F&quot; },</a>
<a name="ln283">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Half triple strike on high A&quot;), &quot;HA HG HA HG HA HG&quot; },</a>
<a name="ln284"> </a>
<a name="ln285">      // G Grace note Triple Strikes</a>
<a name="ln286">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note triple strike on low A&quot;), &quot;HG LA LG LA LG LA LG&quot; },</a>
<a name="ln287">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note triple strike on B&quot;), &quot;HG B LG B LG B LG&quot; },</a>
<a name="ln288">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note triple strike on C&quot;), &quot;HG C LG C LG C LG&quot; },</a>
<a name="ln289">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note triple strike on D&quot;), &quot;HG D LG D LG D LG&quot; },</a>
<a name="ln290">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note triple strike on D&quot;), &quot;HG D C D C D C&quot; },</a>
<a name="ln291">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note triple strike on E&quot;), &quot;HG E LA E LA E LA&quot; },</a>
<a name="ln292">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;G grace note triple strike on F&quot;), &quot;HG F E F E F E&quot; },</a>
<a name="ln293"> </a>
<a name="ln294">      // Thumb Triple Strikes</a>
<a name="ln295">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb triple strike on low A&quot;),  &quot;HA LA LG LA LG LA LG&quot; },</a>
<a name="ln296">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb triple strike on B&quot;),      &quot;HA B LG B LG B LG&quot; },</a>
<a name="ln297">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb triple strike on C&quot;),      &quot;HA C LG C LG C LG&quot; },</a>
<a name="ln298">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb triple strike on D&quot;),      &quot;HA D LG D LG D LG&quot; },</a>
<a name="ln299">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb triple strike on D&quot;),      &quot;HA D C D C D C&quot; },</a>
<a name="ln300">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb triple strike on E&quot;),      &quot;HA E LA E LA E LA&quot; },</a>
<a name="ln301">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb triple strike on F&quot;),      &quot;HA F E F E F E&quot; },</a>
<a name="ln302">      { QT_TRANSLATE_NOOP(&quot;bagpipe&quot;, &quot;Thumb triple strike on high G&quot;), &quot;HA HG F HG F HG F&quot; },</a>
<a name="ln303"> </a>
<a name="ln304">      };</a>
<a name="ln305"> </a>
<a name="ln306">// Staff line and pitch for every bagpipe note</a>
<a name="ln307">BagpipeNoteInfo BagpipeEmbellishment::BagpipeNoteInfoList[] = {</a>
<a name="ln308">      { &quot;LG&quot;,  6,  65},</a>
<a name="ln309">      { &quot;LA&quot;,  5,  67},</a>
<a name="ln310">      { &quot;B&quot;,   4,  69},</a>
<a name="ln311">      { &quot;C&quot;,   3,  71}, // actually C#</a>
<a name="ln312">      { &quot;D&quot;,   2,  72},</a>
<a name="ln313">      { &quot;E&quot;,   1,  74},</a>
<a name="ln314">      { &quot;F&quot;,   0,  76}, // actually F#</a>
<a name="ln315">      { &quot;HG&quot;, -1,  77},</a>
<a name="ln316">      { &quot;HA&quot;, -2,  79}</a>
<a name="ln317">};</a>
<a name="ln318"> </a>
<a name="ln319">//---------------------------------------------------------</a>
<a name="ln320">//   nEmbellishments</a>
<a name="ln321">//     return the number of embellishment in BagpipeEmbellishmentList</a>
<a name="ln322">//---------------------------------------------------------</a>
<a name="ln323"> </a>
<a name="ln324">int BagpipeEmbellishment::nEmbellishments()</a>
<a name="ln325">      {</a>
<a name="ln326">      return sizeof(BagpipeEmbellishmentList) / sizeof(*BagpipeEmbellishmentList);</a>
<a name="ln327">      }</a>
<a name="ln328"> </a>
<a name="ln329">//---------------------------------------------------------</a>
<a name="ln330">//   getNoteList</a>
<a name="ln331">//     return notes as list of indices in BagpipeNoteInfoList</a>
<a name="ln332">//---------------------------------------------------------</a>
<a name="ln333"> </a>
<a name="ln334">noteList BagpipeEmbellishment::getNoteList() const</a>
<a name="ln335">      {</a>
<a name="ln336">      noteList nl;</a>
<a name="ln337">      if (_embelType &gt;= 0 &amp;&amp; _embelType &lt; nEmbellishments()) {</a>
<a name="ln338">            QStringList notes = BagpipeEmbellishmentList[_embelType].notes.split(' ');</a>
<a name="ln339">            int noteInfoSize = sizeof(BagpipeNoteInfoList) / sizeof(*BagpipeNoteInfoList);</a>
<a name="ln340">            foreach (const QString note, notes) {</a>
<a name="ln341">                  // search for note in BagpipeNoteInfoList</a>
<a name="ln342">                  for (int i = 0; i &lt; noteInfoSize; ++i) {</a>
<a name="ln343">                        if (BagpipeNoteInfoList[i].name == note) {</a>
<a name="ln344">                              // found it, append to list</a>
<a name="ln345">                              nl &lt;&lt; i;</a>
<a name="ln346">                              break;</a>
<a name="ln347">                              }</a>
<a name="ln348">                        }</a>
<a name="ln349">                  }</a>
<a name="ln350">            }</a>
<a name="ln351">      return nl;</a>
<a name="ln352">      }</a>
<a name="ln353"> </a>
<a name="ln354">//---------------------------------------------------------</a>
<a name="ln355">//   write</a>
<a name="ln356">//---------------------------------------------------------</a>
<a name="ln357"> </a>
<a name="ln358">void BagpipeEmbellishment::write(XmlWriter&amp; xml) const</a>
<a name="ln359">      {</a>
<a name="ln360">      xml.stag(this);</a>
<a name="ln361">      xml.tag(&quot;subtype&quot;, _embelType);</a>
<a name="ln362">      xml.etag();</a>
<a name="ln363">      }</a>
<a name="ln364"> </a>
<a name="ln365">//---------------------------------------------------------</a>
<a name="ln366">//   read</a>
<a name="ln367">//---------------------------------------------------------</a>
<a name="ln368"> </a>
<a name="ln369">void BagpipeEmbellishment::read(XmlReader&amp; e)</a>
<a name="ln370">      {</a>
<a name="ln371">      while (e.readNextStartElement()) {</a>
<a name="ln372">            const QStringRef&amp; tag(e.name());</a>
<a name="ln373">            if (tag == &quot;subtype&quot;)</a>
<a name="ln374">                  _embelType = e.readInt();</a>
<a name="ln375">            else</a>
<a name="ln376">                  e.unknown();</a>
<a name="ln377">            }</a>
<a name="ln378">      }</a>
<a name="ln379"> </a>
<a name="ln380">//---------------------------------------------------------</a>
<a name="ln381">//   BEDrawingDataX</a>
<a name="ln382">//      BagpipeEmbellishment drawing data in the x direction</a>
<a name="ln383">//      shared between ::draw() and ::layout()</a>
<a name="ln384">//---------------------------------------------------------</a>
<a name="ln385"> </a>
<a name="ln386">struct BEDrawingDataX {</a>
<a name="ln387">      const SymId headsym;    // grace note head symbol</a>
<a name="ln388">      const SymId flagsym;    // grace note flag symbol</a>
<a name="ln389">      const qreal mags;       // grace head magnification</a>
<a name="ln390">      qreal headw;            // grace head width</a>
<a name="ln391">      qreal headp;            // horizontal head pitch</a>
<a name="ln392">      const qreal spatium;    // spatium</a>
<a name="ln393">      const qreal lw;         // line width for stem</a>
<a name="ln394">      qreal xl;               // calc x for stem of leftmost note</a>
<a name="ln395">      const qreal xcorr;      // correction to align flag with top of stem</a>
<a name="ln396"> </a>
<a name="ln397">      BEDrawingDataX(SymId hs, SymId fs, const qreal m, const qreal s, const int nn)</a>
<a name="ln398">         :  headsym(hs),</a>
<a name="ln399">            flagsym(fs),</a>
<a name="ln400">            mags(   0.75 * m),</a>
<a name="ln401">            spatium(s),</a>
<a name="ln402">            lw(     0.1 * s),</a>
<a name="ln403">            xcorr(  0.1 * s)</a>
<a name="ln404">            {</a>
<a name="ln405">            qreal w = gscore-&gt;scoreFont()-&gt;width(hs, mags);</a>
<a name="ln406">            headw = 1.2 * w; // using 1.0 the stem xpos is off</a>
<a name="ln407">            headp = 1.6 * w;</a>
<a name="ln408">            xl    = (1 - 1.6 * (nn - 1)) * w / 2;</a>
<a name="ln409">            }</a>
<a name="ln410">};</a>
<a name="ln411"> </a>
<a name="ln412">//---------------------------------------------------------</a>
<a name="ln413">//   BEDrawingDataY</a>
<a name="ln414">//      BagpipeEmbellishment drawing data in the y direction</a>
<a name="ln415">//      shared between ::draw() and ::layout()</a>
<a name="ln416">//---------------------------------------------------------</a>
<a name="ln417"> </a>
<a name="ln418">struct BEDrawingDataY {</a>
<a name="ln419">      const qreal y1b;        // top of all stems for beamed notes</a>
<a name="ln420">      const qreal y1f;        // top of stem for note with flag</a>
<a name="ln421">      const qreal y2;         // bottom of stem</a>
<a name="ln422">      const qreal ycorr;      // correction to align flag with top of stem</a>
<a name="ln423">      const qreal bw;         // line width for beam</a>
<a name="ln424"> </a>
<a name="ln425">      BEDrawingDataY(const int l, const qreal s)</a>
<a name="ln426">         :  y1b( -8 * s / 2),</a>
<a name="ln427">            y1f( (l - 6) * s / 2),</a>
<a name="ln428">            y2(   l * s / 2),</a>
<a name="ln429">            ycorr(0.8 * s),</a>
<a name="ln430">            bw(   0.3 * s) {}</a>
<a name="ln431">};</a>
<a name="ln432"> </a>
<a name="ln433">//---------------------------------------------------------</a>
<a name="ln434">//   debug support (disabled)</a>
<a name="ln435">//---------------------------------------------------------</a>
<a name="ln436"> </a>
<a name="ln437">/*</a>
<a name="ln438">static void printBBox(const char* name, const QRectF b)</a>
<a name="ln439">      {</a>
<a name="ln440">      qDebug(&quot;bbox%s left %f bot %f right %f top %f&quot;,</a>
<a name="ln441">             name,</a>
<a name="ln442">             b.left(),</a>
<a name="ln443">             b.bottom(),</a>
<a name="ln444">             b.right(),</a>
<a name="ln445">             b.top());</a>
<a name="ln446">      }</a>
<a name="ln447"> </a>
<a name="ln448">static void symMetrics(const char* name, const Sym&amp; headsym)</a>
<a name="ln449">      {</a>
<a name="ln450">      qDebug(&quot;%s&quot;, name);</a>
<a name="ln451">      qDebug(&quot;bbox left %f bot %f right %f top %f&quot;,</a>
<a name="ln452">             headsym.getBbox().left(),</a>
<a name="ln453">             headsym.getBbox().bottom(),</a>
<a name="ln454">             headsym.getBbox().right(),</a>
<a name="ln455">             headsym.getBbox().top());</a>
<a name="ln456">      qDebug(&quot;attach x %f y %f&quot;,</a>
<a name="ln457">             headsym.getAttach().x(),</a>
<a name="ln458">             headsym.getAttach().y());</a>
<a name="ln459">      }</a>
<a name="ln460">*/</a>
<a name="ln461"> </a>
<a name="ln462">//---------------------------------------------------------</a>
<a name="ln463">//   mag</a>
<a name="ln464">//      return fixed magnification</a>
<a name="ln465">//---------------------------------------------------------</a>
<a name="ln466"> </a>
<a name="ln467">qreal BagpipeEmbellishment::mag() const</a>
<a name="ln468">      {</a>
<a name="ln469">            return 0.7;</a>
<a name="ln470">      }</a>
<a name="ln471"> </a>
<a name="ln472">//---------------------------------------------------------</a>
<a name="ln473">//   layout</a>
<a name="ln474">//      calculate and set bounding box</a>
<a name="ln475">//---------------------------------------------------------</a>
<a name="ln476"> </a>
<a name="ln477">void BagpipeEmbellishment::layout()</a>
<a name="ln478">      {</a>
<a name="ln479">      /*</a>
<a name="ln480">      if (_embelType == 0 || _embelType == 8 || _embelType == 9) {</a>
<a name="ln481">            qDebug(&quot;BagpipeEmbellishment::layout st %d&quot;, _embelType);</a>
<a name="ln482">            }</a>
<a name="ln483">       */</a>
<a name="ln484">      SymId headsym = SymId::noteheadBlack;</a>
<a name="ln485">      SymId flagsym = SymId::flag32ndUp;</a>
<a name="ln486"> </a>
<a name="ln487">      noteList nl = getNoteList();</a>
<a name="ln488">      BEDrawingDataX dx(headsym, flagsym, magS(), score()-&gt;spatium(), nl.size());</a>
<a name="ln489"> </a>
<a name="ln490">      setbbox(QRectF());</a>
<a name="ln491">      /*</a>
<a name="ln492">      if (_embelType == 0 || _embelType == 8 || _embelType == 9) {</a>
<a name="ln493">            symMetrics(&quot;headsym&quot;, headsym);</a>
<a name="ln494">            symMetrics(&quot;flagsym&quot;, flagsym);</a>
<a name="ln495">            qDebug(&quot;mags %f headw %f headp %f spatium %f xl %f&quot;,</a>
<a name="ln496">                   dx.mags, dx.headw, dx.headp, dx.spatium, dx.xl);</a>
<a name="ln497">            }</a>
<a name="ln498">       */</a>
<a name="ln499"> </a>
<a name="ln500">      bool drawFlag = nl.size() == 1;</a>
<a name="ln501"> </a>
<a name="ln502">      // draw the notes including stem, (optional) flag and (optional) ledger line</a>
<a name="ln503">      qreal x = dx.xl;</a>
<a name="ln504">      foreach (int note, nl) {</a>
<a name="ln505">            int line = BagpipeNoteInfoList[note].line;</a>
<a name="ln506">            BEDrawingDataY dy(line, score()-&gt;spatium());</a>
<a name="ln507"> </a>
<a name="ln508">            // head</a>
<a name="ln509">            addbbox(score()-&gt;scoreFont()-&gt;bbox(headsym, dx.mags).translated(QPointF(x - dx.lw * .5 - dx.headw, dy.y2)));</a>
<a name="ln510">            /*</a>
<a name="ln511">            if (_embelType == 0 || _embelType == 8 || _embelType == 9) {</a>
<a name="ln512">                  printBBox(&quot; notehead&quot;, bbox());</a>
<a name="ln513">                  }</a>
<a name="ln514">             */</a>
<a name="ln515"> </a>
<a name="ln516">            // stem</a>
<a name="ln517">            // highest top of stems actually used is y1b</a>
<a name="ln518">            addbbox(QRectF(x - dx.lw * .5 - dx.headw, dy.y1b, dx.lw, dy.y2 - dy.y1b));</a>
<a name="ln519">            /*</a>
<a name="ln520">            if (_embelType == 0 || _embelType == 8 || _embelType == 9) {</a>
<a name="ln521">                  printBBox(&quot; notehead + stem&quot;, bbox());</a>
<a name="ln522">                  }</a>
<a name="ln523">             */</a>
<a name="ln524"> </a>
<a name="ln525">            // flag</a>
<a name="ln526">            if (drawFlag) {</a>
<a name="ln527">                  addbbox(score()-&gt;scoreFont()-&gt;bbox(flagsym, dx.mags).translated(QPointF(x - dx.lw * .5 + dx.xcorr, dy.y1f + dy.ycorr)));</a>
<a name="ln528">                  // printBBox(&quot; notehead + stem + flag&quot;, bbox());</a>
<a name="ln529">                  }</a>
<a name="ln530"> </a>
<a name="ln531">            // draw the ledger line for high A</a>
<a name="ln532">            if (line == -2) {</a>
<a name="ln533">                  addbbox(QRectF(x - dx.headw * 1.5 - dx.lw * .5, dy.y2 - dx.lw * 2, dx.headw * 2, dx.lw));</a>
<a name="ln534">                  /*</a>
<a name="ln535">                  if (_embelType == 8) {</a>
<a name="ln536">                        printBBox(&quot; notehead + stem + ledger line&quot;, bbox());</a>
<a name="ln537">                        }</a>
<a name="ln538">                   */</a>
<a name="ln539">                  }</a>
<a name="ln540"> </a>
<a name="ln541">            // move x to next note x position</a>
<a name="ln542">            x += dx.headp;</a>
<a name="ln543">            }</a>
<a name="ln544">      }</a>
<a name="ln545"> </a>
<a name="ln546">//---------------------------------------------------------</a>
<a name="ln547">//   drawBeams</a>
<a name="ln548">//      draw the beams</a>
<a name="ln549">//      x1,y is one side of the top beam</a>
<a name="ln550">//      x2,y is the other side of the top beam</a>
<a name="ln551">//---------------------------------------------------------</a>
<a name="ln552"> </a>
<a name="ln553">static void drawBeams(QPainter* painter, const qreal spatium,</a>
<a name="ln554">                      const qreal x1, const qreal x2, qreal y)</a>
<a name="ln555">      {</a>
<a name="ln556">      // draw the beams</a>
<a name="ln557">      painter-&gt;drawLine(QLineF(x1, y, x2, y));</a>
<a name="ln558">      y += spatium / 1.5;</a>
<a name="ln559">      painter-&gt;drawLine(QLineF(x1, y, x2, y));</a>
<a name="ln560">      y += spatium / 1.5;</a>
<a name="ln561">      painter-&gt;drawLine(QLineF(x1, y, x2, y));</a>
<a name="ln562">      }</a>
<a name="ln563"> </a>
<a name="ln564">//---------------------------------------------------------</a>
<a name="ln565">//   drawGraceNote</a>
<a name="ln566">//      draw a single grace note in a palette cell</a>
<a name="ln567">//      x,y1 is the top of the stem</a>
<a name="ln568">//      x,y2 is the bottom of the stem</a>
<a name="ln569">//---------------------------------------------------------</a>
<a name="ln570"> </a>
<a name="ln571">void BagpipeEmbellishment::drawGraceNote(QPainter* painter,</a>
<a name="ln572">   const BEDrawingDataX&amp; dx,</a>
<a name="ln573">   const BEDrawingDataY&amp; dy,</a>
<a name="ln574">   SymId flagsym, const qreal x, const bool drawFlag) const</a>
<a name="ln575">      {</a>
<a name="ln576">      // draw head</a>
<a name="ln577">      drawSymbol(dx.headsym, painter, QPointF(x - dx.headw, dy.y2));</a>
<a name="ln578">      // draw stem</a>
<a name="ln579">      qreal y1 =  drawFlag ? dy.y1f : dy.y1b;          // top of stems actually used</a>
<a name="ln580">      painter-&gt;drawLine(QLineF(x - dx.lw * .5, y1, x - dx.lw * .5, dy.y2));</a>
<a name="ln581">      if (drawFlag) {</a>
<a name="ln582">            // draw flag</a>
<a name="ln583">            drawSymbol(flagsym, painter, QPointF(x - dx.lw * .5 + dx.xcorr, y1 + dy.ycorr));</a>
<a name="ln584">            }</a>
<a name="ln585">      }</a>
<a name="ln586"> </a>
<a name="ln587">//---------------------------------------------------------</a>
<a name="ln588">//   draw</a>
<a name="ln589">//      draw the embellishment centered in a palette cell</a>
<a name="ln590">//      x = 0 is horizontal cell center</a>
<a name="ln591">//      y = 0 is the top staff line</a>
<a name="ln592">//---------------------------------------------------------</a>
<a name="ln593"> </a>
<a name="ln594">void BagpipeEmbellishment::draw(QPainter* painter) const</a>
<a name="ln595">      {</a>
<a name="ln596">      SymId headsym = SymId::noteheadBlack;</a>
<a name="ln597">      SymId flagsym = SymId::flag32ndUp;</a>
<a name="ln598"> </a>
<a name="ln599">      noteList nl = getNoteList();</a>
<a name="ln600">      BEDrawingDataX dx(headsym, flagsym, magS(), score()-&gt;spatium(), nl.size());</a>
<a name="ln601"> </a>
<a name="ln602">      QPen pen(curColor(), dx.lw, Qt::SolidLine, Qt::FlatCap);</a>
<a name="ln603">      painter-&gt;setPen(pen);</a>
<a name="ln604"> </a>
<a name="ln605">      bool drawBeam = nl.size() &gt; 1;</a>
<a name="ln606">      bool drawFlag = nl.size() == 1;</a>
<a name="ln607"> </a>
<a name="ln608">      // draw the notes including stem, (optional) flag and (optional) ledger line</a>
<a name="ln609">      qreal x = dx.xl;</a>
<a name="ln610">      foreach (int note, nl) {</a>
<a name="ln611">            int line = BagpipeNoteInfoList[note].line;</a>
<a name="ln612">            BEDrawingDataY dy(line, score()-&gt;spatium());</a>
<a name="ln613">            drawGraceNote(painter, dx, dy, flagsym, x, drawFlag);</a>
<a name="ln614"> </a>
<a name="ln615">            // draw the ledger line for high A</a>
<a name="ln616">            if (line == -2)</a>
<a name="ln617">                  painter-&gt;drawLine(QLineF(x - dx.headw * 1.5 - dx.lw * .5,</a>
<a name="ln618">                                           dy.y2, x + dx.headw * .5 - dx.lw * .5, dy.y2));</a>
<a name="ln619"> </a>
<a name="ln620">            // move x to next note x position</a>
<a name="ln621">            x += dx.headp;</a>
<a name="ln622">            }</a>
<a name="ln623"> </a>
<a name="ln624">      if (drawBeam) {</a>
<a name="ln625">            // beam drawing setup</a>
<a name="ln626">            BEDrawingDataY dy(0, score()-&gt;spatium());</a>
<a name="ln627">            QPen beamPen(curColor(), dy.bw, Qt::SolidLine, Qt::FlatCap);</a>
<a name="ln628">            painter-&gt;setPen(beamPen);</a>
<a name="ln629">            // draw the beams</a>
<a name="ln630">            drawBeams(painter, dx.spatium, dx.xl - dx.lw * .5, x - dx.headp - dx.lw * .5, dy.y1b);</a>
<a name="ln631">            }</a>
<a name="ln632">      }</a>
<a name="ln633">}</a>

</code></pre>
<div class="balloon" rel="8"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v1042/" target="_blank">V1042</a> This file is marked with copyleft license, which requires you to open the derived source code.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
